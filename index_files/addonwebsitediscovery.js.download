var requirejs,require,define;(function(Z){function H(e){return"[object Function]"===L.call(e)}function I(e){return"[object Array]"===L.call(e)}function y(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function M(e,t){if(e){var n;for(n=e.length-1;-1<n&&(!e[n]||!t(e[n],n,e));n-=1);}}function t(e,t){return ga.call(e,t)}function l(e,n){return t(e,n)&&e[n]}function F(e,n){for(var r in e)if(t(e,r)&&n(e[r],r))break}function Q(e,n,r,i){return n&&F(n,function(n,s){if(r||!t(e,s))i&&"string"!=typeof n?(e[s]||(e[s]={}),Q(e[s],n,r,i)):e[s]=n}),e}function u(e,t){return function(){return t.apply(e,arguments)}}function aa(e){throw e}function ba(e){if(!e)return e;var t=Z;return y(e.split("."),function(e){t=t[e]}),t}function A(e,t,n,r){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=r,n&&(t.originalError=n),t}function ha(e){function n(e,t,n){var r,i,s,o,u,a,f,c=t&&t.split("/");r=c;var h=N.map,p=h&&h["*"];if(e&&"."===e.charAt(0))if(t){r=l(N.pkgs,t)?c=[t]:c.slice(0,c.length-1),t=e=r.concat(e.split("/"));for(r=0;t[r];r+=1)if(i=t[r],"."===i)t.splice(r,1),r-=1;else if(".."===i){if(1===r&&(".."===t[2]||".."===t[0]))break;0<r&&(t.splice(r-1,2),r-=2)}r=l(N.pkgs,t=e[0]),e=e.join("/"),r&&e===t+"/"+r.main&&(e=t)}else 0===e.indexOf("./")&&(e=e.substring(2));if(n&&h&&(c||p)){t=e.split("/");for(r=t.length;0<r;r-=1){s=t.slice(0,r).join("/");if(c)for(i=c.length;0<i;i-=1)if(n=l(h,c.slice(0,i).join("/")))if(n=l(n,s)){o=n,u=r;break}if(o)break;!a&&p&&l(p,s)&&(a=l(p,s),f=r)}!o&&a&&(o=a,u=f),o&&(t.splice(0,u,o),e=t.join("/"))}return e}function r(e){z&&y(document.getElementsByTagName("script"),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===S.contextName)return t.parentNode.removeChild(t),!0})}function i(e){var t=l(N.paths,e);if(t&&I(t)&&1<t.length)return t.shift(),S.require.undef(e),S.require([e]),!0}function s(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function o(e,t,r,i){var o,u,a=null,f=t?t.name:null,c=e,h=!0,p="";return e||(h=!1,e="_@r"+(B+=1)),e=s(e),a=e[0],e=e[1],a&&(a=n(a,f,i),u=l(_,a)),e&&(a?p=u&&u.normalize?u.normalize(e,function(e){return n(e,f,i)}):n(e,f,i):(p=n(e,f,i),e=s(p),a=e[0],p=e[1],r=!0,o=S.nameToUrl(p))),r=a&&!u&&!r?"_unnormalized"+(q+=1):"",{prefix:a,name:p,parentMap:t,unnormalized:!!r,url:o,originalName:c,isDefine:h,id:(a?a+"!"+p:p)+r}}function a(e){var t=e.id,n=l(C,t);return n||(n=C[t]=new S.Module(e)),n}function f(e,n,r){var i=e.id,s=l(C,i);t(_,i)&&(!s||s.defineEmitComplete)?"defined"===n&&r(_[i]):(s=a(e),s.error&&"error"===n)?r(s.error):s.on(n,r)}function c(e,t){var n=e.requireModules,r=!1;t?t(e):(y(n,function(t){if(t=l(C,t))t.error=e,t.events.error&&(r=!0,t.emit("error",e))}),!r)&&j.onError(e)}function h(){R.length&&(ia.apply(M,[M.length-1,0].concat(R)),R=[])}function p(e){delete C[e],delete k[e]}function d(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,y(e.depMaps,function(r,i){var s=r.id,o=l(C,s);o&&!e.depMatched[i]&&!n[s]&&(l(t,s)?(e.defineDep(i,_[s]),e.check()):d(o,t,n))}),n[r]=!0)}function v(){var e,t,n,s,o=(n=1e3*N.waitSeconds)&&S.startTime+n<(new Date).getTime(),u=[],a=[],f=!1,l=!0;if(!w){w=!0,F(k,function(n){e=n.map,t=e.id;if(n.enabled&&(e.isDefine||a.push(n),!n.error))if(!n.inited&&o)i(t)?f=s=!0:(u.push(t),r(t));else if(!n.inited&&n.fetched&&e.isDefine&&(f=!0,!e.prefix))return l=!1});if(o&&u.length)return n=A("timeout","Load timeout for modules: "+u,null,u),n.contextName=S.contextName,c(n);l&&y(a,function(e){d(e,{},{})}),(!o||s)&&f&&(z||da)&&!T&&(T=setTimeout(function(){T=0,v()},50)),w=!1}}function m(e){t(_,e[0])||a(o(e[0],null,!0)).init(e[1],e[2])}function g(e){var e=e.currentTarget||e.srcElement,t=S.onScriptLoad;return e.detachEvent&&!W?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=S.onScriptError,(!e.detachEvent||W)&&e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function b(){var e;for(h();M.length;){e=M.shift();if(null===e[0])return c(A("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));m(e)}}var w,E,S,x,T,N={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},C={},k={},L={},M=[],_={},D={},B=1,q=1;return x={require:function(e){return e.require?e.require:e.require=S.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?e.exports:e.exports=_[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t=l(N.pkgs,e.map.id);return(t?l(N.config,e.map.id+"/"+t.main):l(N.config,e.map.id))||{}},exports:_[e.map.id]}}},E=function(e){this.events=l(L,e.id)||{},this.map=e,this.shim=l(N.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},E.prototype={init:function(e,t,n,r){r=r||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=u(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,S.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();S.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;D[e]||(D[e]=!0,S.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id;t=this.depExports;var r=this.exports,i=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(H(i)){if(this.events.error&&this.map.isDefine||j.onError!==aa)try{r=S.execCb(n,i,t,r)}catch(s){e=s}else r=S.execCb(n,i,t,r);this.map.isDefine&&((t=this.module)&&void 0!==t.exports&&t.exports!==this.exports?r=t.exports:void 0===r&&this.usingExports&&(r=this.exports));if(e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",c(this.error=e)}else r=i;this.exports=r,this.map.isDefine&&!this.ignore&&(_[n]=r,j.onResourceLoad)&&j.onResourceLoad(S,this.map,this.depMaps),p(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,r=e.id,i=o(e.prefix);this.depMaps.push(i),f(i,"defined",u(this,function(i){var s,h;h=this.map.name;var d=this.map.parentMap?this.map.parentMap.name:null,v=S.makeRequire(e.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(i.normalize&&(h=i.normalize(h,function(e){return n(e,d,!0)})||""),i=o(e.prefix+"!"+h,this.map.parentMap),f(i,"defined",u(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),h=l(C,i.id))this.depMaps.push(i),this.events.error&&h.on("error",u(this,function(e){this.emit("error",e)})),h.enable()}else s=u(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),s.error=u(this,function(e){this.inited=!0,this.error=e,e.requireModules=[r],F(C,function(e){0===e.map.id.indexOf(r+"_unnormalized")&&p(e.map.id)}),c(e)}),s.fromText=u(this,function(n,i){var u=e.name,f=o(u),l=O;i&&(n=i),l&&(O=!1),a(f),t(N.config,r)&&(N.config[u]=N.config[r]);try{j.exec(n)}catch(h){return c(A("fromtexteval","fromText eval for "+r+" failed: "+h,h,[r]))}l&&(O=!0),this.depMaps.push(f),S.completeLoad(u),v([u],s)}),i.load(e.name,v,s,N)})),S.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){k[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,u(this,function(e,n){var r,i;if("string"==typeof e){e=o(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[n]=e;if(r=l(x,e.id)){this.depExports[n]=r(this);return}this.depCount+=1,f(e,"defined",u(this,function(e){this.defineDep(n,e),this.check()})),this.errback&&f(e,"error",u(this,this.errback))}r=e.id,i=C[r],!t(x,r)&&i&&!i.enabled&&S.enable(e,this)})),F(this.pluginMaps,u(this,function(e){var t=l(C,e.id);t&&!t.enabled&&S.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){y(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},S={config:N,contextName:e,registry:C,defined:_,urlFetched:D,defQueue:M,Module:E,makeModuleMap:o,nextTick:j.nextTick,onError:c,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=N.pkgs,n=N.shim,r={paths:!0,config:!0,map:!0};F(e,function(e,t){r[t]?"map"===t?(N.map||(N.map={}),Q(N[t],e,!0,!0)):Q(N[t],e,!0):N[t]=e}),e.shim&&(F(e.shim,function(e,t){I(e)&&(e={deps:e}),(e.exports||e.init)&&!e.exportsFn&&(e.exportsFn=S.makeShimExports(e)),n[t]=e}),N.shim=n),e.packages&&(y(e.packages,function(e){e="string"==typeof e?{name:e}:e,t[e.name]={name:e.name,location:e.location||e.name,main:(e.main||"main").replace(ja,"").replace(ea,"")}}),N.pkgs=t),F(C,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=o(t))}),(e.deps||e.callback)&&S.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(Z,arguments)),t||e.exports&&ba(e.exports)}},makeRequire:function(i,s){function u(n,r,f){var l,h;return s.enableBuildCallback&&r&&H(r)&&(r.__requireJsBuild=!0),"string"==typeof n?H(r)?c(A("requireargs","Invalid require call"),f):i&&t(x,n)?x[n](C[i.id]):j.get?j.get(S,n,i,u):(l=o(n,i,!1,!0),l=l.id,t(_,l)?_[l]:c(A("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(i?"":". Use require([])")))):(b(),S.nextTick(function(){b(),h=a(o(null,i)),h.skipMap=s.skipMap,h.init(n,r,f,{enabled:!0}),v()}),u)}return s=s||{},Q(u,{isBrowser:z,toUrl:function(e){var t,r=e.lastIndexOf("."),s=e.split("/")[0];return-1!==r&&("."!==s&&".."!==s||1<r)&&(t=e.substring(r,e.length),e=e.substring(0,r)),S.nameToUrl(n(e,i&&i.id,!0),t,!0)},defined:function(e){return t(_,o(e,i,!1,!0).id)},specified:function(e){return e=o(e,i,!1,!0).id,t(_,e)||t(C,e)}}),i||(u.undef=function(e){h();var t=o(e,i,!0),n=l(C,e);r(e),delete _[e],delete D[t.url],delete L[e],n&&(n.events.defined&&(L[e]=n.events),p(e))}),u},enable:function(e){l(C,e.id)&&a(e).enable()},completeLoad:function(e){var n,r,s=l(N.shim,e)||{},o=s.exports;for(h();M.length;){r=M.shift();if(null===r[0]){r[0]=e;if(n)break;n=!0}else r[0]===e&&(n=!0);m(r)}r=l(C,e);if(!n&&!t(_,e)&&r&&!r.inited){if(N.enforceDefine&&(!o||!ba(o)))return i(e)?void 0:c(A("nodefine","No define call for "+e,null,[e]));m([e,s.deps||[],s.exportsFn])}v()},nameToUrl:function(e,t,n){var r,i,s,o,u,a;if(j.jsExtRegExp.test(e))o=e+(t||"");else{r=N.paths,i=N.pkgs,o=e.split("/");for(u=o.length;0<u;u-=1){if(a=o.slice(0,u).join("/"),s=l(i,a),a=l(r,a)){I(a)&&(a=a[0]),o.splice(0,u,a);break}if(s){e=e===s.name?s.location+"/"+s.main:s.location,o.splice(0,u,e);break}}o=o.join("/"),o+=t||(/^data\:|\?/.test(o)||n?"":".js"),o=("/"===o.charAt(0)||o.match(/^[\w\+\.\-]+:/)?"":N.baseUrl)+o}return N.urlArgs?o+((-1===o.indexOf("?")?"?":"&")+N.urlArgs):o},load:function(e,t){j.load(S,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if("load"===e.type||ka.test((e.currentTarget||e.srcElement).readyState))P=null,e=g(e),S.completeLoad(e.id)},onScriptError:function(e){var t=g(e);if(!i(t.id))return c(A("scripterror","Script error for: "+t.id,e,[t.id]))}},S.require=S.makeRequire(),S}var j,w,x,C,J,D,P,K,q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,z="undefined"!=typeof window&&"undefined"!=typeof navigator&&!!window.document,da=!z&&"undefined"!=typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,W="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),E={},s={},R=[],O=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(H(requirejs))return;s=requirejs,requirejs=void 0}"undefined"!=typeof require&&!H(require)&&(s=require,require=void 0),j=requirejs=function(e,t,n,r){var i,s="_";return!I(e)&&"string"!=typeof e&&(i=e,I(t)?(e=t,t=n,n=r):e=[]),i&&i.context&&(s=i.context),(r=l(E,s))||(r=E[s]=j.s.newContext(s)),i&&r.configure(i),r.require(e,t,n)},j.config=function(e){return j(e)},j.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=j),j.version="2.1.9",j.jsExtRegExp=/^\/|:|\?|\.js$/,j.isBrowser=z,w=j.s={contexts:E,newContext:ha},j({}),y(["toUrl","undef","defined","specified"],function(e){j[e]=function(){var t=E._;return t.require[e].apply(t,arguments)}}),z&&(x=w.head=document.getElementsByTagName("head")[0],C=document.getElementsByTagName("base")[0])&&(x=w.head=C.parentNode),j.onError=aa,j.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},j.load=function(e,t,n){var r=e&&e.config||{};if(z)return r=j.createNode(r,t,n),r.setAttribute("data-requirecontext",e.contextName),r.setAttribute("data-requiremodule",t),r.attachEvent&&!(r.attachEvent.toString&&0>r.attachEvent.toString().indexOf("[native code"))&&!W?(O=!0,r.attachEvent("onreadystatechange",e.onScriptLoad)):(r.addEventListener("load",e.onScriptLoad,!1),r.addEventListener("error",e.onScriptError,!1)),r.src=n,K=r,C?x.insertBefore(r,C):x.appendChild(r),K=null,r;if(da)try{importScripts(n),e.completeLoad(t)}catch(i){e.onError(A("importscripts","importScripts failed for "+t+" at "+n,i,[t]))}},z&&!s.skipDataMain&&M(document.getElementsByTagName("script"),function(e){x||(x=e.parentNode);if(J=e.getAttribute("data-main"))return q=J,s.baseUrl||(D=q.split("/"),q=D.pop(),fa=D.length?D.join("/")+"/":"./",s.baseUrl=fa),q=q.replace(ea,""),j.jsExtRegExp.test(q)&&(q=J),s.deps=s.deps?s.deps.concat(q):[q],!0}),define=function(e,t,n){var r,i;"string"!=typeof e&&(n=t,t=e,e=null),I(t)||(n=t,t=null),!t&&H(n)&&(t=[],n.length&&(n.toString().replace(la,"").replace(ma,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),O&&((r=K)||(P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(e){if("interactive"===e.readyState)return P=e}),r=P),r&&(e||(e=r.getAttribute("data-requiremodule")),i=E[r.getAttribute("data-requirecontext")])),(i?i.defQueue:R).push([e,t,n])},define.amd={jQuery:!0},j.exec=function(b){return eval(b)},j(s)}})(this),define("require.min",function(){}),require.config({wrapShim:!0,baseUrl:"/scripts",paths:{text:"libs/requirejs-text/requirejs-text-2.0.3",libs:"libs",modules:"app/modules",browserType:"app/helpers/browserType",radio:"app/helpers/radio",notifier:"app/helpers/notifier",trace:"app/helpers/trace",generated:"app/dynamic/generated",validate:"jquery.validate.min",jquery:"libs/jquery/shim",initialData:"app/helpers/initialData",initializers:"app/helpers/initializers",accountInfo:"app/helpers/accountInfo",subscription:"app/helpers/subscription",rollouts:"app/helpers/rollouts",userParams:"app/helpers/userParams",onboarding:"app/helpers/onboarding",formatters:"app/helpers/formatters",loader:"app/helpers/loader",underscore:"libs/underscore/underscore-1.8.3.forked",backbone:"libs/backbone/backbone-1.2.3","backbone.babysitter":"libs/backbone/backbone.babysitter","backbone.radio":"libs/backbone/backbone.radio","backbone.deepmodel":"libs/backbone/backbone.deepmodel",marionette:"libs/backbone/backbone.marionette-2.4.7",stickit:"libs/backbone/backbone.stickit",selectize:"libs/selectize/selectize",selectizeStickit:"libs/selectize/selectize-stickit",cookies:"libs/cookies/cookies",highcharts:"libs/highcharts/highcharts.src",validation:"libs/backbone/backbone.validation",pageableCollection:"libs/backbone/backbone.paginator",pageableESCollection:"libs/backbone/backbone.es.paginator",modernizr:"libs/modernizr/modernizr-2.6.2",recaptcha:"libs/recaptcha/recaptcha-invisible-async",ladda:"libs/ladda/ladda",spin:"libs/ladda/spin",sifter:"libs/sifter/sifter",microplugin:"libs/microplugin/microplugin",shepherd:"libs/shepherd/shepherd",tether:"libs/tether/tether","jquery-ui":"libs/plugins/jquery-ui-1.10.4.custom",dynatable:"libs/plugins/jquery.dynatable",backgrid:"libs/backgrid/backgrid",d3:"libs/d3/d3.min",trianglify:"libs/d3/trianglify",webfontloader:"libs/webfontloader/webfontloader",modalVideo:"libs/modal/jquery-modal-video",tippy:"libs/tippy/tippy",datepicker:"libs/datepicker/daterangepicker",moment:"libs/datepicker/moment.min"},shim:{datepicker:{deps:["jquery","moment"]},underscore:{exports:"_"},"backbone.babysitter":{deps:["backbone"],exports:"Backbone.ChildViewContainer"},"backbone.deepmodel":{deps:["backbone"],exports:"Backbone.DeepModel"},"backbone.radio":{deps:["underscore","backbone"],exports:"Backbone.Radio"},dynatable:{deps:["jquery"]},modalVideo:{deps:["jquery"],exports:"ModalVideo"},tippy:{exports:"tippy"},backgrid:{deps:["backbone"],exports:"Backgrid"},stickit:{deps:["backbone"],exports:"Backbone.Stickit"},d3:{deps:[],exports:"d3"},trianglify:{deps:["d3"],exports:"Trianglify"},modernizr:{exports:"Modernizr"},highcharts:{deps:["jquery"],exports:"Highcharts"},"jquery-ui":{deps:["jquery"],exports:"jQuery.ui"},"libs/typeahead/typeahead.jquery":{deps:["jquery"]},"libs/typeahead/bloodhound":{deps:["jquery"],exports:"Bloodhound"},"libs/plugins/jquery.layout":{deps:["jquery","jquery-ui"]},"libs/jScrollPane/jquery.mousewheel":{deps:["jquery"]},"libs/jScrollPane/mwheelIntent":{deps:["jquery"]},"libs/jScrollPane/jquery.jscrollpane":{deps:["jquery","libs/jScrollPane/jquery.mousewheel","libs/jScrollPane/mwheelIntent"]},"libs/plugins/jquery.waterfall":{deps:["jquery"]},"app/plugins/jquery.share":{deps:["jquery"]},"libs/plugins/jquery.lazyload":{deps:["jquery"]},"libs/plugins/jquery.timeago":{deps:["jquery"]},"libs/bootstrap/alert":{deps:["jquery"]},"libs/bootstrap/scrollspy":{deps:["jquery"]},"libs/plugins/jquery.nouislider.min":{deps:["jquery"]},"libs/bootstrap/affix":{deps:["jquery"]},"libs/bootstrap/popover":{deps:["jquery","libs/bootstrap/tooltip"]},"libs/better-autocomplete/jquery.better-autocomplete":{deps:["jquery"]},"libs/backbone/backbone.notifier":{deps:["jquery","underscore","backbone"],exports:"Backbone.Notifier"},"libs/backbone/backbone.virtual-collection":{deps:["jquery","underscore","backbone"],exports:"Backbone.VirtualCollection"},"libs/html2canvas/html2canvas":{deps:["jquery"],exports:"html2canvas"},"libs/color-thief/color-thief.min":{deps:[],exports:"ColorThief"}},logLevel:4,preserveLicenseComments:!1}),define("common",function(){}),define("initialData",[],function(){return window.initialData||{}}),define("jquery",[],function(){return window.jQuery}),function(){function x(e){function t(t,n,r,i,s,o){for(;s>=0&&s<o;s+=e){var u=i?i[s]:s;r=n(r,t[u],u,t)}return r}return function(n,r,i,s){r=v(r,s,4);var o=!S(n)&&d.keys(n),u=(o||n).length,a=e>0?0:u-1;return arguments.length<3&&(i=n[o?o[a]:a],a+=e),t(n,r,i,o,a,u)}}function C(e){return function(t,n,r){n=m(n,r);var i=E(t),s=e>0?0:i-1;for(;s>=0&&s<i;s+=e)if(n(t[s],s,t))return s;return-1}}function k(e,t,n){return function(r,i,s){var u=0,a=E(r);if(typeof s=="number")e>0?u=s>=0?s:Math.max(s+a,u):a=s>=0?Math.min(s+1,a):s+a+1;else if(n&&s&&a)return s=n(r,i),r[s]===i?s:-1;if(i!==i)return s=t(o.call(r,u,a),d.isNaN),s>=0?s+u:-1;for(s=e>0?u:a-1;s>=0&&s<a;s+=e)if(r[s]===i)return s;return-1}}function M(e,t){var n=O.length,i=e.constructor,s=d.isFunction(i)&&i.prototype||r,o="constructor";d.has(e,o)&&!d.contains(t,o)&&t.push(o);while(n--)o=O[n],o in e&&e[o]!==s[o]&&!d.contains(t,o)&&t.push(o)}var e=this,t=e._,n=Array.prototype,r=Object.prototype,i=Function.prototype,s=n.push,o=n.slice,u=r.toString,a=r.hasOwnProperty,f=Array.isArray,l=Object.keys,c=i.bind,h=Object.create,p=function(){},d=function(e){if(e instanceof d)return e;if(!(this instanceof d))return new d(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=d),exports._=d):e._=d,d.VERSION="1.8.3";var v=function(e,t,n){if(t===void 0)return e;switch(n==null?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return function(){return e.apply(t,arguments)}},m=function(e,t,n){return e==null?d.identity:d.isFunction(e)?v(e,t,n):d.isObject(e)?d.matcher(e):d.property(e)};d.iteratee=function(e,t){return m(e,t,Infinity)};var g=function(e,t){return function(n){var r=arguments.length;if(r<2||n==null)return n;for(var i=1;i<r;i++){var s=arguments[i],o=e(s),u=o.length;for(var a=0;a<u;a++){var f=o[a];if(!t||n[f]===void 0)n[f]=s[f]}}return n}},y=function(e){if(!d.isObject(e))return{};if(h)return h(e);p.prototype=e;var t=new p;return p.prototype=null,t},b=function(e){return function(t){return t==null?void 0:t[e]}},w=Math.pow(2,53)-1,E=b("length"),S=function(e){var t=E(e);return typeof t=="number"&&t>=0&&t<=w};d.each=d.forEach=function(e,t,n){t=v(t,n);var r,i;if(S(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var s=d.keys(e);for(r=0,i=s.length;r<i;r++)t(e[s[r]],s[r],e)}return e},d.map=d.collect=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length,s=Array(i);for(var o=0;o<i;o++){var u=r?r[o]:o;s[o]=t(e[u],u,e)}return s},d.reduce=d.foldl=d.inject=x(1),d.reduceRight=d.foldr=x(-1),d.find=d.detect=function(e,t,n){var r;S(e)?r=d.findIndex(e,t,n):r=d.findKey(e,t,n);if(r!==void 0&&r!==-1)return e[r]},d.filter=d.select=function(e,t,n){var r=[];return t=m(t,n),d.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},d.reject=function(e,t,n){return d.filter(e,d.negate(m(t)),n)},d.every=d.all=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length;for(var s=0;s<i;s++){var o=r?r[s]:s;if(!t(e[o],o,e))return!1}return!0},d.some=d.any=function(e,t,n){t=m(t,n);var r=!S(e)&&d.keys(e),i=(r||e).length;for(var s=0;s<i;s++){var o=r?r[s]:s;if(t(e[o],o,e))return!0}return!1},d.contains=d.includes=d.include=function(e,t,n,r){S(e)||(e=d.values(e));if(typeof n!="number"||r)n=0;return d.indexOf(e,t,n)>=0},d.invoke=function(e,t){var n=o.call(arguments,2),r=d.isFunction(t);return d.map(e,function(e){var i=r?t:e[t];return i==null?i:i.apply(e,n)})},d.pluck=function(e,t){return d.map(e,d.property(t))},d.where=function(e,t){return d.filter(e,d.matcher(t))},d.findWhere=function(e,t){return d.find(e,d.matcher(t))},d.max=function(e,t,n){var r=-Infinity,i=-Infinity,s,o;if(t==null&&e!=null){e=S(e)?e:d.values(e);for(var u=0,a=e.length;u<a;u++)s=e[u],s>r&&(r=s)}else t=m(t,n),d.each(e,function(e,n,s){o=t(e,n,s);if(o>i||o===-Infinity&&r===-Infinity)r=e,i=o});return r},d.min=function(e,t,n){var r=Infinity,i=Infinity,s,o;if(t==null&&e!=null){e=S(e)?e:d.values(e);for(var u=0,a=e.length;u<a;u++)s=e[u],s<r&&(r=s)}else t=m(t,n),d.each(e,function(e,n,s){o=t(e,n,s);if(o<i||o===Infinity&&r===Infinity)r=e,i=o});return r},d.shuffle=function(e){var t=S(e)?e:d.values(e),n=t.length,r=Array(n);for(var i=0,s;i<n;i++)s=d.random(0,i),s!==i&&(r[i]=r[s]),r[s]=t[i];return r},d.sample=function(e,t,n){return t==null||n?(S(e)||(e=d.values(e)),e[d.random(e.length-1)]):d.shuffle(e).slice(0,Math.max(0,t))},d.sortBy=function(e,t,n){return t=m(t,n),d.pluck(d.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,n,r){var i={};return n=m(n,r),d.each(t,function(r,s){var o=n(r,s,t);e(i,r,o)}),i}};d.groupBy=T(function(e,t,n){d.has(e,n)?e[n].push(t):e[n]=[t]}),d.indexBy=T(function(e,t,n){e[n]=t}),d.countBy=T(function(e,t,n){d.has(e,n)?e[n]++:e[n]=1}),d.toArray=function(e){return e?d.isArray(e)?o.call(e):S(e)?d.map(e,d.identity):d.values(e):[]},d.size=function(e){return e==null?0:S(e)?e.length:d.keys(e).length},d.partition=function(e,t,n){t=m(t,n);var r=[],i=[];return d.each(e,function(e,n,s){(t(e,n,s)?r:i).push(e)}),[r,i]},d.first=d.head=d.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:d.initial(e,e.length-t)},d.initial=function(e,t,n){return o.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))},d.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:d.rest(e,Math.max(0,e.length-t))},d.rest=d.tail=d.drop=function(e,t,n){return o.call(e,t==null||n?1:t)},d.compact=function(e){return d.filter(e,d.identity)};var N=function(e,t,n,r){var i=[],s=0;for(var o=r||0,u=E(e);o<u;o++){var a=e[o];if(S(a)&&(d.isArray(a)||d.isArguments(a))){t||(a=N(a,t,n));var f=0,l=a.length;i.length+=l;while(f<l)i[s++]=a[f++]}else n||(i[s++]=a)}return i};d.flatten=function(e,t){return N(e,t,!1)},d.without=function(e){return d.difference(e,o.call(arguments,1))},d.uniq=d.unique=function(e,t,n,r){d.isBoolean(t)||(r=n,n=t,t=!1),n!=null&&(n=m(n,r));var i=[],s=[];for(var o=0,u=E(e);o<u;o++){var a=e[o],f=n?n(a,o,e):a;t?((!o||s!==f)&&i.push(a),s=f):n?d.contains(s,f)||(s.push(f),i.push(a)):d.contains(i,a)||i.push(a)}return i},d.union=function(){return d.uniq(N(arguments,!0,!0))},d.intersection=function(e){var t=[],n=arguments.length;for(var r=0,i=E(e);r<i;r++){var s=e[r];if(d.contains(t,s))continue;for(var o=1;o<n;o++)if(!d.contains(arguments[o],s))break;o===n&&t.push(s)}return t},d.difference=function(e){var t=N(arguments,!0,!0,1);return d.filter(e,function(e){return!d.contains(t,e)})},d.zip=function(){return d.unzip(arguments)},d.unzip=function(e){var t=e&&d.max(e,E).length||0,n=Array(t);for(var r=0;r<t;r++)n[r]=d.pluck(e,r);return n},d.object=function(e,t){var n={};for(var r=0,i=E(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},d.findIndex=C(1),d.findLastIndex=C(-1),d.sortedIndex=function(e,t,n,r){n=m(n,r,1);var i=n(t),s=0,o=E(e);while(s<o){var u=Math.floor((s+o)/2);n(e[u])<i?s=u+1:o=u}return s},d.indexOf=k(1,d.findIndex,d.sortedIndex),d.lastIndexOf=k(-1,d.findLastIndex),d.range=function(e,t,n){t==null&&(t=e||0,e=0),n=n||1;var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r);for(var s=0;s<r;s++,e+=n)i[s]=e;return i};var L=function(e,t,n,r,i){if(r instanceof t){var s=y(e.prototype),o=e.apply(s,i);return d.isObject(o)?o:s}return e.apply(n,i)};d.bind=function(e,t){if(c&&e.bind===c)return c.apply(e,o.call(arguments,1));if(!d.isFunction(e))throw new TypeError("Bind must be called on a function");var n=o.call(arguments,2),r=function(){return L(e,r,t,this,n.concat(o.call(arguments)))};return r},d.partial=function(e){var t=o.call(arguments,1),n=function(){var r=0,i=t.length,s=Array(i);for(var o=0;o<i;o++)s[o]=t[o]===d?arguments[r++]:t[o];while(r<arguments.length)s.push(arguments[r++]);return L(e,n,this,this,s)};return n},d.bindAll=function(e){var t,n=arguments.length,r;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)r=arguments[t],e[r]=d.bind(e[r],e);return e},d.memoize=function(e,t){var n=function(r){var i=n.cache,s=""+(t?t.apply(this,arguments):r);return d.has(i,s)||(i[s]=e.apply(this,arguments)),i[s]};return n.cache={},n},d.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},d.defer=d.partial(d.delay,d,1),d.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:d.now(),o=null,s=e.apply(r,i),o||(r=i=null)};return function(){var f=d.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0||l>t?(o&&(clearTimeout(o),o=null),u=f,s=e.apply(r,i),o||(r=i=null)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},d.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=d.now()-o;f<t&&f>=0?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),r||(s=i=null)))};return function(){s=this,i=arguments,o=d.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},d.wrap=function(e,t){return d.partial(t,e)},d.negate=function(e){return function(){return!e.apply(this,arguments)}},d.compose=function(){var e=arguments,t=e.length-1;return function(){var n=t,r=e[t].apply(this,arguments);while(n--)r=e[n].call(this,r);return r}},d.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},d.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},d.once=d.partial(d.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),O=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];d.keys=function(e){if(!d.isObject(e))return[];if(l)return l(e);var t=[];for(var n in e)d.has(e,n)&&t.push(n);return A&&M(e,t),t},d.allKeys=function(e){if(!d.isObject(e))return[];var t=[];for(var n in e)t.push(n);return A&&M(e,t),t},d.values=function(e){var t=d.keys(e),n=t.length,r=Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},d.mapObject=function(e,t,n){t=m(t,n);var r=d.keys(e),i=r.length,s={},o;for(var u=0;u<i;u++)o=r[u],s[o]=t(e[o],o,e);return s},d.pairs=function(e){var t=d.keys(e),n=t.length,r=Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},d.invert=function(e){var t={},n=d.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},d.functions=d.methods=function(e){var t=[];for(var n in e)d.isFunction(e[n])&&t.push(n);return t.sort()},d.extend=g(d.allKeys),d.extendOwn=d.assign=g(d.keys),d.findKey=function(e,t,n){t=m(t,n);var r=d.keys(e),i;for(var s=0,o=r.length;s<o;s++){i=r[s];if(t(e[i],i,e))return i}},d.pick=function(e,t,n){var r={},i=e,s,o;if(i==null)return r;d.isFunction(t)?(o=d.allKeys(i),s=v(t,n)):(o=N(arguments,!1,!1,1),s=function(e,t,n){return t in n},i=Object(i));for(var u=0,a=o.length;u<a;u++){var f=o[u],l=i[f];s(l,f,i)&&(r[f]=l)}return r},d.omit=function(e,t,n){if(d.isFunction(t))t=d.negate(t);else{var r=d.map(N(arguments,!1,!1,1),String);t=function(e,t){return!d.contains(r,t)}}return d.pick(e,t,n)},d.defaults=g(d.allKeys,!0),d.create=function(e,t){var n=y(e);return t&&d.extendOwn(n,t),n},d.clone=function(e){return d.isObject(e)?d.isArray(e)?e.slice():d.extend({},e):e},d.tap=function(e,t){return t(e),e},d.isMatch=function(e,t){var n=d.keys(t),r=n.length;if(e==null)return!r;var i=Object(e);for(var s=0;s<r;s++){var o=n[s];if(t[o]!==i[o]||!(o in i))return!1}return!0};var _=function(e,t,n,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return e===t;e instanceof d&&(e=e._wrapped),t instanceof d&&(t=t._wrapped);var i=u.call(e);if(i!==u.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":if(+e!==+e)return+t!==+t;return+e===0?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var s=i==="[object Array]";if(!s){if(typeof e!="object"||typeof t!="object")return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(d.isFunction(o)&&o instanceof o&&d.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];var f=n.length;while(f--)if(n[f]===e)return r[f]===t;n.push(e),r.push(t);if(s){f=e.length;if(f!==t.length)return!1;while(f--)if(!_(e[f],t[f],n,r))return!1}else{var l=d.keys(e),c;f=l.length;if(d.keys(t).length!==f)return!1;while(f--){c=l[f];if(!d.has(t,c)||!_(e[c],t[c],n,r))return!1}}return n.pop(),r.pop(),!0};d.isEqual=function(e,t){return _(e,t)},d.isEmpty=function(e){return e==null?!0:S(e)&&(d.isArray(e)||d.isString(e)||d.isArguments(e))?e.length===0:d.keys(e).length===0},d.isElement=function(e){return!!e&&e.nodeType===1},d.isArray=f||function(e){return u.call(e)==="[object Array]"},d.isObject=function(e){var t=typeof e;return t==="function"||t==="object"&&!!e},d.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){d["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}}),d.isArguments(arguments)||(d.isArguments=function(e){return d.has(e,"callee")}),typeof /./!="function"&&typeof Int8Array!="object"&&(d.isFunction=function(e){return typeof e=="function"||!1}),d.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},d.isNaN=function(e){return d.isNumber(e)&&e!==+e},d.isBoolean=function(e){return e===!0||e===!1||u.call(e)==="[object Boolean]"},d.isNull=function(e){return e===null},d.isUndefined=function(e){return e===void 0},d.has=function(e,t){return e!=null&&a.call(e,t)},d.noConflict=function(){return e._=t,this},d.identity=function(e){return e},d.constant=function(e){return function(){return e}},d.noop=function(){},d.property=b,d.propertyOf=function(e){return e==null?function(){}:function(t){return e[t]}},d.matcher=d.matches=function(e){return e=d.extendOwn({},e),function(t){return d.isMatch(t,e)}},d.times=function(e,t,n){var r=Array(Math.max(0,e));t=v(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},d.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},d.now=Date.now||function(){return(new Date).getTime()};var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=d.invert(D),H=function(e){var t=function(t){return e[t]},n="(?:"+d.keys(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=e==null?"":""+e,r.test(e)?e.replace(i,t):e}};d.escape=H(D),d.unescape=H(P),d.result=function(e,t,n){var r=e==null?void 0:e[t];return r===void 0&&(r=n),d.isFunction(r)?r.call(e):r};var B=0;d.uniqueId=function(e){var t=++B+"";return e?e+t:t},d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\u2028|\u2029/g,q=function(e){return"\\"+F[e]};d.template=function(e,t,n){!t&&n&&(t=n),t=d.defaults({},t,d.templateSettings);var r=RegExp([(t.escape||j).source,(t.interpolate||j).source,(t.evaluate||j).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){return s+=e.slice(i,u).replace(I,q),i=u+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,formatters=App.helpers.Formatters,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(t.variable||"obj","_",s)}catch(u){throw u.source=s,u}var a=function(e){return o.call(this,e,d)},f=t.variable||"obj";return a.source="function("+f+"){\n"+s+"}",a},d.chain=function(e){var t=d(e);return t._chain=!0,t};var R=function(e,t){return e._chain?d(t).chain():t};d.mixin=function(e){d.each(d.functions(e),function(t){var n=d[t]=e[t];d.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),R(this,n.apply(d,e))}})},d.mixin(d),d.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];d.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0],R(this,n)}}),d.each(["concat","join","slice"],function(e){var t=n[e];d.prototype[e]=function(){return R(this,t.apply(this._wrapped,arguments))}}),d.prototype.value=function(){return this._wrapped},d.prototype.valueOf=d.prototype.toJSON=d.prototype.value,d.prototype.toString=function(){return""+this._wrapped},typeof define=="function"&&define.amd&&define("underscore",[],function(){return d})}.call(this),function(e){var t=typeof self=="object"&&self.self==self&&self||typeof global=="object"&&global.global==global&&global;if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){t.Backbone=e(t,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore"),r;try{r=require("jquery")}catch(i){}e(t,exports,n,r)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,n,r){var i=e.Backbone,s=Array.prototype.slice;t.VERSION="1.2.3",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=function(e,t,r){switch(e){case 1:return function(){return n[t](this[r])};case 2:return function(e){return n[t](this[r],e)};case 3:return function(e,i){return n[t](this[r],a(e,this),i)};case 4:return function(e,i,s){return n[t](this[r],a(e,this),i,s)};default:return function(){var e=s.call(arguments);return e.unshift(this[r]),n[t].apply(n,e)}}},u=function(e,t,r){n.each(t,function(t,i){n[i]&&(e.prototype[i]=o(t,i,r))})},a=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?f(e):n.isString(e)?function(t){return t.get(e)}:e},f=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},l=t.Events={},c=/\s+/,h=function(e,t,r,i,s){var o=0,u;if(r&&typeof r=="object"){i!==void 0&&"context"in s&&s.context===void 0&&(s.context=i);for(u=n.keys(r);o<u.length;o++)t=h(e,t,u[o],r[u[o]],s)}else if(r&&c.test(r))for(u=r.split(c);o<u.length;o++)t=e(t,u[o],i,s);else t=e(t,r,i,s);return t};l.on=function(e,t,n){return p(this,e,t,n)};var p=function(e,t,n,r,i){e._events=h(d,e._events||{},t,n,{context:r,ctx:e,listening:i});if(i){var s=e._listeners||(e._listeners={});s[i.id]=i}return e};l.listenTo=function(e,t,r){if(!e)return this;var i=e._listenId||(e._listenId=n.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),o=s[i];if(!o){var u=this._listenId||(this._listenId=n.uniqueId("l"));o=s[i]={obj:e,objId:i,id:u,listeningTo:s,count:0}}return p(e,t,r,this,o),this};var d=function(e,t,n,r){if(n){var i=e[t]||(e[t]=[]),s=r.context,o=r.ctx,u=r.listening;u&&u.count++,i.push({callback:n,context:s,ctx:s||o,listening:u})}return e};l.off=function(e,t,n){return this._events?(this._events=h(v,this._events,e,t,{context:n,listeners:this._listeners}),this):this},l.stopListening=function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=e?[e._listenId]:n.keys(i);for(var o=0;o<s.length;o++){var u=i[s[o]];if(!u)break;u.obj.off(t,r,this)}return n.isEmpty(i)&&(this._listeningTo=void 0),this};var v=function(e,t,r,i){if(!e)return;var s=0,o,u=i.context,a=i.listeners;if(!t&&!r&&!u){var f=n.keys(a);for(;s<f.length;s++)o=a[f[s]],delete a[o.id],delete o.listeningTo[o.objId];return}var l=t?[t]:n.keys(e);for(;s<l.length;s++){t=l[s];var c=e[t];if(!c)break;var h=[];for(var p=0;p<c.length;p++){var d=c[p];r&&r!==d.callback&&r!==d.callback._callback||u&&u!==d.context?h.push(d):(o=d.listening,o&&--o.count===0&&(delete a[o.id],delete o.listeningTo[o.objId]))}h.length?e[t]=h:delete e[t]}if(n.size(e))return e};l.once=function(e,t,r){var i=h(m,{},e,t,n.bind(this.off,this));return this.on(i,void 0,r)},l.listenToOnce=function(e,t,r){var i=h(m,{},t,r,n.bind(this.stopListening,this,e));return this.listenTo(e,i)};var m=function(e,t,r,i){if(r){var s=e[t]=n.once(function(){i(t,s),r.apply(this,arguments)});s._callback=r}return e};l.trigger=function(e){if(!this._events)return this;var t=Math.max(0,arguments.length-1),n=Array(t);for(var r=0;r<t;r++)n[r]=arguments[r+1];return h(g,this._events,e,void 0,n),this};var g=function(e,t,n,r){if(e){var i=e[t],s=e.all;i&&s&&(s=s.slice()),i&&y(i,r),s&&y(s,[t].concat(r))}return e},y=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}};l.bind=l.on,l.unbind=l.off,n.extend(t,l);var b=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,l,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(e==null)return this;var i;typeof e=="object"?(i=e,r=t):(i={})[e]=t,r||(r={});if(!this._validate(i,r))return!1;var s=r.unset,o=r.silent,u=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=n.clone(this.attributes),this.changed={});var f=this.attributes,l=this.changed,c=this._previousAttributes;for(var h in i)t=i[h],n.isEqual(f[h],t)||u.push(h),n.isEqual(c[h],t)?delete l[h]:l[h]=t,s?delete f[h]:f[h]=t;this.id=this.get(this.idAttribute);if(!o){u.length&&(this._pending=r);for(var p=0;p<u.length;p++)this.trigger("change:"+u[p],this,f[u[p]],r)}if(a)return this;if(!o)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,r={};for(var i in e){var s=e[i];if(n.isEqual(t[i],s))continue;r[i]=s}return n.size(r)?r:!1},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,r=e.success;return e.success=function(n){var i=e.parse?t.parse(n,e):n;if(!t.set(i,e))return!1;r&&r.call(e.context,t,n,e),t.trigger("sync",t,n,e)},R(this,e),this.sync("read",this,e)},save:function(e,t,r){var i;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0,parse:!0},r);var s=r.wait;if(i&&!s){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var o=this,u=r.success,a=this.attributes;r.success=function(e){o.attributes=a;var t=r.parse?o.parse(e,r):e;s&&(t=n.extend({},i,t));if(t&&!o.set(t,r))return!1;u&&u.call(r.context,o,e,r),o.trigger("sync",o,e,r)},R(this,r),i&&s&&(this.attributes=n.extend({},a,i));var f=this.isNew()?"create":r.patch?"patch":"update";f==="patch"&&!r.attrs&&(r.attrs=i);var l=this.sync(f,this,r);return this.attributes=a,l},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=e.wait,s=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){i&&s(),r&&r.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var o=!1;return this.isNew()?n.defer(e.success):(R(this,e),o=this.sync("delete",this,e)),i||s(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||q();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var w={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};u(b,w,"attributes");var E=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},S={add:!0,remove:!0,merge:!0},x={add:!0,remove:!1},T=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var r=Array(e.length-n),i=t.length;for(var s=0;s<r.length;s++)r[s]=e[s+n];for(s=0;s<i;s++)e[s+n]=t[s];for(s=0;s<r.length;s++)e[s+i+n]=r[s]};n.extend(E.prototype,l,{model:b,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,x))},remove:function(e,t){t=n.extend({},t);var r=!n.isArray(e);e=r?[e]:n.clone(e);var i=this._removeModels(e,t);return!t.silent&&i&&this.trigger("update",this,t),r?i[0]:i},set:function(e,t){if(e==null)return;t=n.defaults({},t,S),t.parse&&!this._isModel(e)&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?[e]:e.slice();var i=t.at;i!=null&&(i=+i),i<0&&(i+=this.length+1);var s=[],o=[],u=[],a={},f=t.add,l=t.merge,c=t.remove,h=!1,p=this.comparator&&i==null&&t.sort!==!1,d=n.isString(this.comparator)?this.comparator:null,v;for(var m=0;m<e.length;m++){v=e[m];var g=this.get(v);if(g){if(l&&v!==g){var y=this._isModel(v)?v.attributes:v;t.parse&&(y=g.parse(y,t)),g.set(y,t),p&&!h&&(h=g.hasChanged(d))}a[g.cid]||(a[g.cid]=!0,s.push(g)),e[m]=g}else f&&(v=e[m]=this._prepareModel(v,t),v&&(o.push(v),this._addReference(v,t),a[v.cid]=!0,s.push(v)))}if(c){for(m=0;m<this.length;m++)v=this.models[m],a[v.cid]||u.push(v);u.length&&this._removeModels(u,t)}var b=!1,w=!p&&f&&c;s.length&&w?(b=this.length!=s.length||n.some(this.models,function(e,t){return e!==s[t]}),this.models.length=0,T(this.models,s,0),this.length=this.models.length):o.length&&(p&&(h=!0),T(this.models,o,i==null?this.length:i),this.length=this.models.length),h&&this.sort({silent:!0});if(!t.silent){for(m=0;m<o.length;m++)i!=null&&(t.index=i+m),v=o[m],v.trigger("add",v,this,t);(h||b)&&this.trigger("sort",this,t),(o.length||u.length)&&this.trigger("update",this,t)}return r?e[0]:e},reset:function(e,t){t=t?n.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return s.apply(this.models,arguments)},get:function(e){if(e==null)return void 0;var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),r===1||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=n.extend({parse:!0},e);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t.call(e.context,r,n,e),r.trigger("sync",r,n,e)},R(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};var r=t.wait;e=this._prepareModel(e,t);if(!e)return!1;r||this.add(e,t);var i=this,s=t.success;return t.success=function(e,t,n){r&&i.add(e,n),s&&s.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(e,t){var n=[];for(var r=0;r<e.length;r++){var i=this.get(e[r]);if(!i)continue;var s=this.indexOf(i);this.models.splice(s,1),this.length--,t.silent||(t.index=s,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}return n.length?n:!1},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);n!=null&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);n!=null&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r);if(e==="change"){var i=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);i!==s&&(i!=null&&delete this._byId[i],s!=null&&(this._byId[s]=t))}this.trigger.apply(this,arguments)}});var N={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};u(E,N,"models");var C=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,L)),this._ensureElement(),this.initialize.apply(this,arguments)},k=/^(\S+)\s*(.*)$/,L=["model","collection","el","id","attributes","className","tagName","events"];n.extend(C.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){e||(e=n.result(this,"events"));if(!e)return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[r]);if(!r)continue;var i=t.match(k);this.delegate(i[1],i[2],n.bind(r,this))}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}else this.setElement(n.result(this,"el"))},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,r,i){var s=A[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||q()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1);var a=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,a&&a.call(i.context,e,t,n)};var f=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,f,i),f};var A={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var O=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},M=/\((.*?)\)/g,_=/(\(\?)?:\w+/g,D=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(O.prototype,l,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o,r)!==!1&&(s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(M,"(?:$1)?").replace(_,function(e,t){return t?e:"([^/?]+)"}).replace(D,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var H=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},B=/^[#\/]|\s+$/g,j=/^\/+|\/+$/g,F=/#.*$/;H.started=!1,n.extend(H.prototype,l,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return e.charAt(0)==="/"?e.slice(1):e},getFragment:function(e){return e==null&&(this._usePushState||!this._wantsHashChange?e=this.getPath():e=this.getHash()),e.replace(B,"")},start:function(e){if(H.started)throw new Error("Backbone.history has already been started");H.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!this.history&&!!this.history.pushState,this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(j,"/");if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var s=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));if(!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),H.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})):!1},navigate:function(e,t){if(!H.started)return!1;if(!t||t===!0)t={trigger:!!t};e=this.getFragment(e||"");var n=this.root;if(e===""||e.charAt(0)==="?")n=n.slice(0,-1)||"/";var r=n+e;e=this.decodeFragment(e.replace(F,""));if(this.fragment===e)return;this.fragment=e;if(this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);this._updateHash(this.location,e,t.replace);if(this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var i=this.iframe.contentWindow;t.replace||(i.document.open(),i.document.close()),this._updateHash(i.location,e,t.replace)}}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new H;var I=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};b.extend=E.extend=O.extend=C.extend=H.extend=I;var q=function(){throw new Error('A "url" property or function must be specified')},R=function(e,t){var n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t}),define("generated/countries",[],function(){var e={0:{name:"Unknown",numeric:"0",alpha2:"",token:"unknown"},999:{name:"Worldwide",numeric:"999",alpha2:"WW",token:"worldwide"},4:{name:"Afghanistan",numeric:"4",alpha2:"AF",token:"afghanistan"},248:{name:"land Islands",numeric:"248",alpha2:"AX",token:"land islands"},8:{name:"Albania",numeric:"8",alpha2:"AL",token:"albania"},12:{name:"Algeria",numeric:"12",alpha2:"DZ",token:"algeria"},16:{name:"American Samoa",numeric:"16",alpha2:"AS",token:"american samoa"},20:{name:"Andorra",numeric:"20",alpha2:"AD",token:"andorra"},24:{name:"Angola",numeric:"24",alpha2:"AO",token:"angola"},660:{name:"Anguilla",numeric:"660",alpha2:"AI",token:"anguilla"},10:{name:"Antarctica",numeric:"10",alpha2:"AQ",token:"antarctica"},28:{name:"Antigua and Barbuda",numeric:"28",alpha2:"AG",token:"antigua and barbuda"},32:{name:"Argentina",numeric:"32",alpha2:"AR",token:"argentina"},51:{name:"Armenia",numeric:"51",alpha2:"AM",token:"armenia"},533:{name:"Aruba",numeric:"533",alpha2:"AW",token:"aruba"},36:{name:"Australia",numeric:"36",alpha2:"AU",token:"australia"},40:{name:"Austria",numeric:"40",alpha2:"AT",token:"austria"},31:{name:"Azerbaijan",numeric:"31",alpha2:"AZ",token:"azerbaijan"},44:{name:"Bahamas",numeric:"44",alpha2:"BS",token:"bahamas"},48:{name:"Bahrain",numeric:"48",alpha2:"BH",token:"bahrain"},50:{name:"Bangladesh",numeric:"50",alpha2:"BD",token:"bangladesh"},52:{name:"Barbados",numeric:"52",alpha2:"BB",token:"barbados"},112:{name:"Belarus",numeric:"112",alpha2:"BY",token:"belarus"},56:{name:"Belgium",numeric:"56",alpha2:"BE",token:"belgium"},84:{name:"Belize",numeric:"84",alpha2:"BZ",token:"belize"},204:{name:"Benin",numeric:"204",alpha2:"BJ",token:"benin"},60:{name:"Bermuda",numeric:"60",alpha2:"BM",token:"bermuda"},64:{name:"Bhutan",numeric:"64",alpha2:"BT",token:"bhutan"},68:{name:"Bolivia",numeric:"68",alpha2:"BO",token:"bolivia"},535:{name:"Bonaire, St. Eustatius and Saba",numeric:"535",alpha2:"BQ",token:"bonaire st eustatius and saba"},70:{name:"Bosnia and Herzegovina",numeric:"70",alpha2:"BA",token:"bosnia and herzegovina"},72:{name:"Botswana",numeric:"72",alpha2:"BW",token:"botswana"},74:{name:"Bouvet Island",numeric:"74",alpha2:"BV",token:"bouvet island"},76:{name:"Brazil",numeric:"76",alpha2:"BR",token:"brazil"},86:{name:"British Indian Ocean Territory",numeric:"86",alpha2:"IO",token:"british indian ocean territory"},96:{name:"Brunei Darussalam",numeric:"96",alpha2:"BN",token:"brunei darussalam"},100:{name:"Bulgaria",numeric:"100",alpha2:"BG",token:"bulgaria"},854:{name:"Burkina Faso",numeric:"854",alpha2:"BF",token:"burkina faso"},108:{name:"Burundi",numeric:"108",alpha2:"BI",token:"burundi"},116:{name:"Cambodia",numeric:"116",alpha2:"KH",token:"cambodia"},120:{name:"Cameroon",numeric:"120",alpha2:"CM",token:"cameroon"},124:{name:"Canada",numeric:"124",alpha2:"CA",token:"canada"},132:{name:"Cape Verde",numeric:"132",alpha2:"CV",token:"cape verde"},136:{name:"Cayman Islands",numeric:"136",alpha2:"KY",token:"cayman islands"},140:{name:"Central African Republic",numeric:"140",alpha2:"CF",token:"central african republic"},148:{name:"Chad",numeric:"148",alpha2:"TD",token:"chad"},152:{name:"Chile",numeric:"152",alpha2:"CL",token:"chile"},156:{name:"China",numeric:"156",alpha2:"CN",token:"china"},162:{name:"Christmas Island",numeric:"162",alpha2:"CX",token:"christmas island"},166:{name:"Cocos Islands",numeric:"166",alpha2:"CC",token:"cocos islands"},170:{name:"Colombia",numeric:"170",alpha2:"CO",token:"colombia"},174:{name:"Comoros",numeric:"174",alpha2:"KM",token:"comoros"},178:{name:"Republic Of The Congo",numeric:"178",alpha2:"CG",token:"republic of the congo"},180:{name:"Democratic Republic Of The Congo",numeric:"180",alpha2:"CD",token:"democratic republic of the congo"},184:{name:"Cook Islands",numeric:"184",alpha2:"CK",token:"cook islands"},188:{name:"Costa Rica",numeric:"188",alpha2:"CR",token:"costa rica"},384:{name:"Cte d'Ivoire",numeric:"384",alpha2:"CI",token:"cte divoire"},191:{name:"Croatia",numeric:"191",alpha2:"HR",token:"croatia"},192:{name:"Cuba",numeric:"192",alpha2:"CU",token:"cuba"},531:{name:"Curaao",numeric:"531",alpha2:"CW",token:"curaao"},196:{name:"Cyprus",numeric:"196",alpha2:"CY",token:"cyprus"},203:{name:"Czech Republic",numeric:"203",alpha2:"CZ",token:"czech republic"},208:{name:"Denmark",numeric:"208",alpha2:"DK",token:"denmark"},262:{name:"Djibouti",numeric:"262",alpha2:"DJ",token:"djibouti"},212:{name:"Dominica",numeric:"212",alpha2:"DM",token:"dominica"},214:{name:"Dominican Republic",numeric:"214",alpha2:"DO",token:"dominican republic"},218:{name:"Ecuador",numeric:"218",alpha2:"EC",token:"ecuador"},818:{name:"Egypt",numeric:"818",alpha2:"EG",token:"egypt"},222:{name:"El Salvador",numeric:"222",alpha2:"SV",token:"el salvador"},226:{name:"Equatorial Guinea",numeric:"226",alpha2:"GQ",token:"equatorial guinea"},232:{name:"Eritrea",numeric:"232",alpha2:"ER",token:"eritrea"},233:{name:"Estonia",numeric:"233",alpha2:"EE",token:"estonia"},231:{name:"Ethiopia",numeric:"231",alpha2:"ET",token:"ethiopia"},234:{name:"Faroe Islands",numeric:"234",alpha2:"FO",token:"faroe islands"},238:{name:"Falkland Islands",numeric:"238",alpha2:"FK",token:"falkland islands"},242:{name:"Fiji",numeric:"242",alpha2:"FJ",token:"fiji"},246:{name:"Finland",numeric:"246",alpha2:"FI",token:"finland"},250:{name:"France",numeric:"250",alpha2:"FR",token:"france"},254:{name:"French Guiana",numeric:"254",alpha2:"GF",token:"french guiana"},258:{name:"French Polynesia",numeric:"258",alpha2:"PF",token:"french polynesia"},260:{name:"French Southern Territories",numeric:"260",alpha2:"TF",token:"french southern territories"},266:{name:"Gabon",numeric:"266",alpha2:"GA",token:"gabon"},270:{name:"Gambia",numeric:"270",alpha2:"GM",token:"gambia"},268:{name:"Georgia",numeric:"268",alpha2:"GE",token:"georgia"},276:{name:"Germany",numeric:"276",alpha2:"DE",token:"germany"},288:{name:"Ghana",numeric:"288",alpha2:"GH",token:"ghana"},292:{name:"Gibraltar",numeric:"292",alpha2:"GI",token:"gibraltar"},826:{name:"United Kingdom",numeric:"826",alpha2:"GB",token:"united kingdom"},300:{name:"Greece",numeric:"300",alpha2:"GR",token:"greece"},304:{name:"Greenland",numeric:"304",alpha2:"GL",token:"greenland"},308:{name:"Grenada",numeric:"308",alpha2:"GD",token:"grenada"},312:{name:"Guadeloupe",numeric:"312",alpha2:"GP",token:"guadeloupe"},316:{name:"Guam",numeric:"316",alpha2:"GU",token:"guam"},320:{name:"Guatemala",numeric:"320",alpha2:"GT",token:"guatemala"},324:{name:"Guinea",numeric:"324",alpha2:"GN",token:"guinea"},624:{name:"Guinea-Bissau",numeric:"624",alpha2:"GW",token:"guineabissau"},328:{name:"Guyana",numeric:"328",alpha2:"GY",token:"guyana"},332:{name:"Haiti",numeric:"332",alpha2:"HT",token:"haiti"},334:{name:"Heard Island and Mcdonald Islands",numeric:"334",alpha2:"HM",token:"heard island and mcdonald islands"},340:{name:"Honduras",numeric:"340",alpha2:"HN",token:"honduras"},344:{name:"Hong Kong",numeric:"344",alpha2:"HK",token:"hong kong"},348:{name:"Hungary",numeric:"348",alpha2:"HU",token:"hungary"},352:{name:"Iceland",numeric:"352",alpha2:"IS",token:"iceland"},356:{name:"India",numeric:"356",alpha2:"IN",token:"india"},360:{name:"Indonesia",numeric:"360",alpha2:"ID",token:"indonesia"},364:{name:"Iran",numeric:"364",alpha2:"IR",token:"iran"},368:{name:"Iraq",numeric:"368",alpha2:"IQ",token:"iraq"},372:{name:"Ireland",numeric:"372",alpha2:"IE",token:"ireland"},833:{name:"Isle of Man",numeric:"833",alpha2:"IM",token:"isle of man"},376:{name:"Israel",numeric:"376",alpha2:"IL",token:"israel"},380:{name:"Italy",numeric:"380",alpha2:"IT",token:"italy"},388:{name:"Jamaica",numeric:"388",alpha2:"JM",token:"jamaica"},392:{name:"Japan",numeric:"392",alpha2:"JP",token:"japan"},400:{name:"Jordan",numeric:"400",alpha2:"JO",token:"jordan"},398:{name:"Kazakhstan",numeric:"398",alpha2:"KZ",token:"kazakhstan"},404:{name:"Kenya",numeric:"404",alpha2:"KE",token:"kenya"},296:{name:"Kiribati",numeric:"296",alpha2:"KI",token:"kiribati"},408:{name:"Notrh Korea",numeric:"408",alpha2:"KP",token:"notrh korea"},410:{name:"South Korea",numeric:"410",alpha2:"KR",token:"south korea"},414:{name:"Kuwait",numeric:"414",alpha2:"KW",token:"kuwait"},417:{name:"Kyrgyzstan",numeric:"417",alpha2:"KG",token:"kyrgyzstan"},418:{name:"Lao People's Democratic Republic",numeric:"418",alpha2:"LA",token:"lao peoples democratic republic"},428:{name:"Latvia",numeric:"428",alpha2:"LV",token:"latvia"},422:{name:"Lebanon",numeric:"422",alpha2:"LB",token:"lebanon"},426:{name:"Lesotho",numeric:"426",alpha2:"LS",token:"lesotho"},430:{name:"Liberia",numeric:"430",alpha2:"LR",token:"liberia"},434:{name:"Libya",numeric:"434",alpha2:"LY",token:"libya"},438:{name:"Liechtenstein",numeric:"438",alpha2:"LI",token:"liechtenstein"},440:{name:"Lithuania",numeric:"440",alpha2:"LT",token:"lithuania"},442:{name:"Luxembourg",numeric:"442",alpha2:"LU",token:"luxembourg"},446:{name:"Macao",numeric:"446",alpha2:"MO",token:"macao"},807:{name:"Macedonia",numeric:"807",alpha2:"MK",token:"macedonia"},450:{name:"Madagascar",numeric:"450",alpha2:"MG",token:"madagascar"},454:{name:"Malawi",numeric:"454",alpha2:"MW",token:"malawi"},458:{name:"Malaysia",numeric:"458",alpha2:"MY",token:"malaysia"},462:{name:"Maldives",numeric:"462",alpha2:"MV",token:"maldives"},466:{name:"Mali",numeric:"466",alpha2:"ML",token:"mali"},470:{name:"Malta",numeric:"470",alpha2:"MT",token:"malta"},584:{name:"Marshall Islands",numeric:"584",alpha2:"MH",token:"marshall islands"},474:{name:"Martinique",numeric:"474",alpha2:"MQ",token:"martinique"},478:{name:"Mauritania",numeric:"478",alpha2:"MR",token:"mauritania"},480:{name:"Mauritius",numeric:"480",alpha2:"MU",token:"mauritius"},175:{name:"Mayotte",numeric:"175",alpha2:"YT",token:"mayotte"},484:{name:"Mexico",numeric:"484",alpha2:"MX",token:"mexico"},583:{name:"Micronesia",numeric:"583",alpha2:"FM",token:"micronesia"},498:{name:"Moldova",numeric:"498",alpha2:"MD",token:"moldova"},492:{name:"Monaco",numeric:"492",alpha2:"MC",token:"monaco"},496:{name:"Mongolia",numeric:"496",alpha2:"MN",token:"mongolia"},499:{name:"Montenegro",numeric:"499",alpha2:"ME",token:"montenegro"},500:{name:"Montserrat",numeric:"500",alpha2:"MS",token:"montserrat"},504:{name:"Morocco",numeric:"504",alpha2:"MA",token:"morocco"},508:{name:"Mozambique",numeric:"508",alpha2:"MZ",token:"mozambique"},104:{name:"Myanmar",numeric:"104",alpha2:"MM",token:"myanmar"},516:{name:"Namibia",numeric:"516",alpha2:"NA",token:"namibia"},520:{name:"Nauru",numeric:"520",alpha2:"NR",token:"nauru"},524:{name:"Nepal",numeric:"524",alpha2:"NP",token:"nepal"},528:{name:"Netherlands",numeric:"528",alpha2:"NL",token:"netherlands"},530:{name:"Netherlands Antilles",numeric:"530",alpha2:"AN",token:"netherlands antilles"},540:{name:"New Caledonia",numeric:"540",alpha2:"NC",token:"new caledonia"},554:{name:"New Zealand",numeric:"554",alpha2:"NZ",token:"new zealand"},558:{name:"Nicaragua",numeric:"558",alpha2:"NI",token:"nicaragua"},562:{name:"Niger",numeric:"562",alpha2:"NE",token:"niger"},566:{name:"Nigeria",numeric:"566",alpha2:"NG",token:"nigeria"},570:{name:"Niue",numeric:"570",alpha2:"NU",token:"niue"},574:{name:"Norfolk Island",numeric:"574",alpha2:"NF",token:"norfolk island"},580:{name:"Northern Mariana Islands",numeric:"580",alpha2:"MP",token:"northern mariana islands"},578:{name:"Norway",numeric:"578",alpha2:"NO",token:"norway"},512:{name:"Oman",numeric:"512",alpha2:"OM",token:"oman"},586:{name:"Pakistan",numeric:"586",alpha2:"PK",token:"pakistan"},585:{name:"Palau",numeric:"585",alpha2:"PW",token:"palau"},591:{name:"Panama",numeric:"591",alpha2:"PA",token:"panama"},598:{name:"Papua New Guinea",numeric:"598",alpha2:"PG",token:"papua new guinea"},600:{name:"Paraguay",numeric:"600",alpha2:"PY",token:"paraguay"},604:{name:"Peru",numeric:"604",alpha2:"PE",token:"peru"},608:{name:"Philippines",numeric:"608",alpha2:"PH",token:"philippines"},612:{name:"Pitcairn",numeric:"612",alpha2:"PN",token:"pitcairn"},616:{name:"Poland",numeric:"616",alpha2:"PL",token:"poland"},620:{name:"Portugal",numeric:"620",alpha2:"PT",token:"portugal"},630:{name:"Puerto Rico",numeric:"630",alpha2:"PR",token:"puerto rico"},634:{name:"Qatar",numeric:"634",alpha2:"QA",token:"qatar"},638:{name:"Runion",numeric:"638",alpha2:"RE",token:"runion"},642:{name:"Romania",numeric:"642",alpha2:"RO",token:"romania"},643:{name:"Russia",numeric:"643",alpha2:"RU",token:"russia"},646:{name:"Rwanda",numeric:"646",alpha2:"RW",token:"rwanda"},652:{name:"Saint Barthlemy",numeric:"652",alpha2:"BL",token:"saint barthlemy"},654:{name:"Saint Helena",numeric:"654",alpha2:"SH",token:"saint helena"},659:{name:"Saint Kitts and Nevis",numeric:"659",alpha2:"KN",token:"saint kitts and nevis"},662:{name:"Saint Lucia",numeric:"662",alpha2:"LC",token:"saint lucia"},663:{name:"Saint Martin",numeric:"663",alpha2:"MF",token:"saint martin"},666:{name:"Saint Pierre and Miquelon",numeric:"666",alpha2:"PM",token:"saint pierre and miquelon"},670:{name:"Saint Vincent and the Grenadines",numeric:"670",alpha2:"VC",token:"saint vincent and the grenadines"},882:{name:"Samoa",numeric:"882",alpha2:"WS",token:"samoa"},674:{name:"San Marino",numeric:"674",alpha2:"SM",token:"san marino"},678:{name:"Sao Tome and Principe",numeric:"678",alpha2:"ST",token:"sao tome and principe"},682:{name:"Saudi Arabia",numeric:"682",alpha2:"SA",token:"saudi arabia"},686:{name:"Senegal",numeric:"686",alpha2:"SN",token:"senegal"},688:{name:"Serbia",numeric:"688",alpha2:"RS",token:"serbia"},690:{name:"Seychelles",numeric:"690",alpha2:"SC",token:"seychelles"},694:{name:"Sierra Leone",numeric:"694",alpha2:"SL",token:"sierra leone"},702:{name:"Singapore",numeric:"702",alpha2:"SG",token:"singapore"},534:{name:"Sint Maarten",numeric:"534",alpha2:"SX",token:"sint maarten"},703:{name:"Slovakia",numeric:"703",alpha2:"SK",token:"slovakia"},705:{name:"Slovenia",numeric:"705",alpha2:"SI",token:"slovenia"},90:{name:"Solomon Islands",numeric:"90",alpha2:"SB",token:"solomon islands"},706:{name:"Somalia",numeric:"706",alpha2:"SO",token:"somalia"},710:{name:"South Africa",numeric:"710",alpha2:"ZA",token:"south africa"},239:{name:"South Georgia Island",numeric:"239",alpha2:"GS",token:"south georgia island"},724:{name:"Spain",numeric:"724",alpha2:"ES",token:"spain"},144:{name:"Sri Lanka",numeric:"144",alpha2:"LK",token:"sri lanka"},736:{name:"Sudan",numeric:"736",alpha2:"SD",token:"sudan"},740:{name:"Suriname",numeric:"740",alpha2:"SR",token:"suriname"},744:{name:"Svalbard and Jan Mayen",numeric:"744",alpha2:"SJ",token:"svalbard and jan mayen"},748:{name:"Swaziland",numeric:"748",alpha2:"SZ",token:"swaziland"},752:{name:"Sweden",numeric:"752",alpha2:"SE",token:"sweden"},756:{name:"Switzerland",numeric:"756",alpha2:"CH",token:"switzerland"},760:{name:"Syrian Arab Republic",numeric:"760",alpha2:"SY",token:"syrian arab republic"},158:{name:"Taiwan",numeric:"158",alpha2:"TW",token:"taiwan"},762:{name:"Tajikistan",numeric:"762",alpha2:"TJ",token:"tajikistan"},834:{name:"Tanzania",numeric:"834",alpha2:"TZ",token:"tanzania"},764:{name:"Thailand",numeric:"764",alpha2:"TH",token:"thailand"},626:{name:"Timor-Leste",numeric:"626",alpha2:"TL",token:"timorleste"},768:{name:"Togo",numeric:"768",alpha2:"TG",token:"togo"},772:{name:"Tokelau",numeric:"772",alpha2:"TK",token:"tokelau"},776:{name:"Tonga",numeric:"776",alpha2:"TO",token:"tonga"},780:{name:"Trinidad and Tobago",numeric:"780",alpha2:"TT",token:"trinidad and tobago"},788:{name:"Tunisia",numeric:"788",alpha2:"TN",token:"tunisia"},792:{name:"Turkey",numeric:"792",alpha2:"TR",token:"turkey"},795:{name:"Turkmenistan",numeric:"795",alpha2:"TM",token:"turkmenistan"},796:{name:"Turks and Caicos Islands",numeric:"796",alpha2:"TC",token:"turks and caicos islands"},798:{name:"Tuvalu",numeric:"798",alpha2:"TV",token:"tuvalu"},800:{name:"Uganda",numeric:"800",alpha2:"UG",token:"uganda"},804:{name:"Ukraine",numeric:"804",alpha2:"UA",token:"ukraine"},784:{name:"United Arab Emirates",numeric:"784",alpha2:"AE",token:"united arab emirates"},840:{name:"United States",numeric:"840",alpha2:"US",token:"united states"},581:{name:"United States Minor Outlying Islands",numeric:"581",alpha2:"UM",token:"united states minor outlying islands"},858:{name:"Uruguay",numeric:"858",alpha2:"UY",token:"uruguay"},860:{name:"Uzbekistan",numeric:"860",alpha2:"UZ",token:"uzbekistan"},548:{name:"Vanuatu",numeric:"548",alpha2:"VU",token:"vanuatu"},336:{name:"Vatican City",numeric:"336",alpha2:"VA",token:"vatican city"},862:{name:"Venezuela",numeric:"862",alpha2:"VE",token:"venezuela"},704:{name:"Vietnam",numeric:"704",alpha2:"VN",token:"vietnam"},92:{name:"Virgin Islands, British",numeric:"92",alpha2:"VG",token:"virgin islands british"},850:{name:"Virgin Islands, U.S.",numeric:"850",alpha2:"VI",token:"virgin islands us"},876:{name:"Wallis and Futuna",numeric:"876",alpha2:"WF",token:"wallis and futuna"},732:{name:"Western Sahara",numeric:"732",alpha2:"EH",token:"western sahara"},887:{name:"Yemen",numeric:"887",alpha2:"YE",token:"yemen"},894:{name:"Zambia",numeric:"894",alpha2:"ZM",token:"zambia"},716:{name:"Zimbabwe",numeric:"716",alpha2:"ZW",token:"zimbabwe"},831:{name:"Guernsey",numeric:"831",alpha2:"GG",token:"guernsey"},832:{name:"Jersey",numeric:"832",alpha2:"JE",token:"jersey"},891:{name:"Serbia Republic",numeric:"891",alpha2:"CS",token:"serbia republic"}};e[999]=e[0]={name:"Unknown",alpha2:"",token:""};var t=undefined,n=function(e){return((e||"")+"").toLowerCase().replace(/[^a-z\s]/g,"")},r=function(){t={};var r,i;for(r in e)e.hasOwnProperty(r)&&(i=e[r],t[i.token?i.token:n(i.name)]=i)};return{all:e,byCode:function(t){return e[t]},byName:function(e){if(e)return t||r(),t[n(e)]},getAlpha2:function(t){if(typeof t=="string"||typeof t=="number")t=e[t];return t&&t.alpha2||""},getFlagOf:function(t){if(typeof t=="string"||typeof t=="number")t=e[t];return t&&t.alpha2?t.alpha2.toLowerCase():""},getNameOf:function(t){if(typeof t=="string"||typeof t=="number")t=e[t];return t&&t.name||"Unknown"},findWhere:function(t){return _.findWhere(e,t)}}}),define("app/helpers/queryParams",["jquery"],function(e){var t;return function(n){return t||(t={},e.each(location.search.substr(1).split("&"),function(e,n){var r=n.split("=");t[r[0].toLowerCase()]=decodeURIComponent(r[1])})),n?t[n.toLowerCase()]:t}}),define("app/helpers/env",[],function(){return window.applicationEnvironment||"production"}),define("app/helpers/urlFor",["jquery","underscore","generated/countries","app/helpers/env"],function(e,t,n,r){var i=function(e){return function(){var n=Array.prototype.slice.call(arguments,0),r=n.slice(-1)[0],i=t.isObject(r)?r:null,s=e.call(this,i?n.slice(0,n.length-1):n);return i&&i.absolute&&(s=location.origin+s),s}},s=location.protocol+"//download."+location.hostname.replace(/^www\./i,"")+"/api/exporting",o=location.protocol+"//"+location.hostname+"/dashboard/learn",u="/api/exporting";return{addQueryParams:function(t,n){t=t||"";var r=e.param(n),i=t.indexOf("#"),s=i>-1?t.substr(0,i):t,o=i>-1?t.substr(i+1):"";return s+(~s.indexOf("?")?"&":"?")+r+(o?"#"+o:"")},addUtmParams:function(t,n){t=t||"",n=e.extend({source:"site",medium:"",campaign:""},n);var r="utm_source="+encodeURIComponent(n.source)+"&utm_medium="+encodeURIComponent(n.medium)+"&utm_campaign="+encodeURIComponent(n.campaign),i=t.indexOf("#"),s=i>-1?t.substr(0,i):t,o=i>-1?t.substr(i+1):"";return s+(~s.indexOf("?")?"&":"?")+r+(o?"#"+o:"")},exportSearchResults:function(t){return s+"/search?"+e.param(t)},exportGoogleSheetsSearchResults:function(t){return u+"/search?"+e.param(t)},exportTechnologyReport:function(t,n){return s+"/technology-report/"+t+"?"+e.param(n)},exportGoogleSheetsReport:function(t,n){return u+"/technology-report/"+t+"?"+e.param(n)},exportWebsiteAlert:function(e){return s+"/website-alert/"+e},exportTechnologyAlert:function(e){return s+"/technology-alert/"+e},exportSearchView:function(e){return s+"/search/?view="+e},exportProspects:function(t){return s+"/prospects"+(t?"?"+e.param(t,!0):"")},exportGoogleSheetsProspects:function(t){return u+"/prospects"+(t?"?"+e.param(t,!0):"")},shareVideo:function(e){return o+"/watch/"+e},contactUs:function(){return"/contact-us"},"goto":i(function(e){return"/goto/"+e}),pricing:i(function(){return"/pricing"}),websitesUsing:i(function(e){return"/websites-using"+(e?"/"+e:"")}),websitesUsingCategory:i(function(e){return"/websites-using"+(e?"/"+e+"/all":"")}),exportHistoricalReports:function(t,n){return t="/api/exporting/"+t,t+"?"+e.param(n,!0)},dynamicWebsitesUsing:function(n){var r={},i=n.sysname||n.technology&&n.technology.get?n.technology.get("sysname"):"",s=n.subjectType==="category"||!i,o=s?n.subjectKey||(n.withCategories||[]).shift()||(n.withoutCategories||[]).shift():n.sysname||n.technology&&n.technology.get?n.technology.get("sysname"):"";n.includeVisits!==undefined&&(r.visits=n.includeVisits),n.maxResults&&(r.results=n.maxResults),n.includeAllTechnologies===!0&&(r.includeAllTechnologies=n.includeAllTechnologies),n.withTechs&&n.withTechs.length&&(r.withTechs=t.pluck(n.withTechs,"id")),n.withoutTechs&&n.withoutTechs.length&&(r.withoutTechs=t.pluck(n.withoutTechs,"id")),n.withCategories&&n.withCategories.length&&(r.withCategories=t.pluck(n.withCategories,"key")),n.withoutCategories&&n.withoutCategories.length&&(r.withoutCategories=t.pluck(n.withoutCategories,"key")),n.withTrafficCountries&&n.withTrafficCountries.length&&(r.withTrafficCountries=t.pluck(n.withTrafficCountries,"numeric")),n.withoutTrafficCountries&&n.withoutTrafficCountries.length&&(r.withoutTrafficCountries=t.pluck(n.withoutTrafficCountries,"numeric")),n.withWebCategories&&n.withWebCategories.length&&(r.withWebCategories=n.withWebCategories),n.withoutWebCategories&&n.withoutWebCategories.length&&(r.withoutWebCategories=n.withoutWebCategories),n.withPublicSuffixes&&n.withPublicSuffixes.length&&(r.withPublicSuffixes=n.withPublicSuffixes),n.withoutPublicSuffixes&&n.withoutPublicSuffixes.length&&(r.withoutPublicSuffixes=n.withoutPublicSuffixes),t.isFinite(n.minCoverage)&&(r.minCoverage=Math.round(n.minCoverage*100)),t.isFinite(n.maxCoverage)&&(r.maxCoverage=Math.round(n.maxCoverage*100)),t.isFinite(n.minVisits)&&(r.minVisits=n.minVisits),t.isFinite(n.maxVisits)&&(r.maxVisits=n.maxVisits),n.includeOnlyTlds&&(r.includeOnlyTlds=n.includeOnlyTlds),n.withoutWebCategories&&(r.withoutWebCategories=n.withoutWebCategories),n.withCompanyCountries&&n.withCompanyCountries.length&&(r.withCompanyCountries=n.withCompanyCountries),n.withoutCompanyCountries&&n.withoutCompanyCountries.length&&(r.withoutCompanyCountries=n.withoutCompanyCountries),n.withCompanyCities&&n.withCompanyCities.length&&(r.withCompanyCities=n.withCompanyCities),n.withCompanyStates&&n.withCompanyStates.length&&(r.withCompanyStates=n.withCompanyStates),n.withCompanyZipcodes&&n.withCompanyZipcodes.length&&(r.withCompanyZipcodes=n.withCompanyZipcodes),n.minEmployees>0&&(r.minEmployees=n.minEmployees),t.isFinite(n.maxEmployees)&&(r.maxEmployees=n.maxEmployees),t.isFinite(n.minRevenues)&&(r.minRevenues=n.minRevenues),t.isFinite(n.maxRevenues)&&(r.maxRevenues=n.maxRevenues),n.minPeopleCount&&(r.withPeopleOnly=!0),n.withCompanyInfoOnly&&(r.withCompanyInfoOnly=!0);var u=e.param(r,!0);return"/websites-using"+(u?"?"+u:"")+"#"+(o+(s?"/all":""))},websiteOverview:i(function(e){return"/websites/"+e}),stDomain:function(){return r==="production"?"https://www.similartech.com":r==="staging"?"https://www.similartech.in":"https://www.similartech.st"},domain:function(){var e="https";return r==="extension"?e+"://www.similartech.com":r==="extension-dev"?e+"://www.similartech.st":""},technologyOverview:i(function(e){return"/technologies/"+e}),technologiesCompare:i(function(e){var t=[e[0],e[1]].sort();return"/compare/"+t.join("-vs-")}),techCategoryOverview:i(function(e){return"/categories/"+e})}}),function(e,t){if(typeof define=="function"&&define.amd)define("backbone.radio",["backbone","underscore"],function(e,n){return t(e,n)});else if(typeof exports!="undefined"){var n=require("backbone"),r=require("underscore");module.exports=t(n,r)}else t(e.Backbone,e._)}(this,function(e,t){function s(e,t,n){if(i.DEBUG){var r=n?" on the "+n+" channel":"";console.warn(e+r+': "'+t+'"')}}function o(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}return!0}function a(e){return u[e]||(u[e]=t.partial(i.log,e))}function f(e){return t.isFunction(e)?e:t.constant(e)}var n=Array.prototype.slice,r=e.Radio,i=e.Radio={};i.VERSION="0.6.0",i.noConflict=function(){return e.Radio=r,this},i.DEBUG=!1;var u={};t.extend(i,{log:function(e,t){var r=n.call(arguments,2);console.log("["+e+'] "'+t+'"',r)},tuneIn:function(e){var t=i.channel(e);return t._tunedIn=!0,t.on("all",a(e)),this},tuneOut:function(e){var t=i.channel(e);return t._tunedIn=!1,t.off("all",a(e)),delete u[e],this}}),i.Commands={command:function(e){var t=n.call(arguments,1);if(!o(this,"command",e,t))return this;var r=this.channelName,u=this._commands;r&&this._tunedIn&&i.log.apply(this,[r,e].concat(t));if(u&&(u[e]||u["default"])){var a=u[e]||u["default"];t=u[e]?t:arguments,a.callback.apply(a.context,t)}else s("An unhandled command was fired",e,r);return this},comply:function(e,t,n){return o(this,"comply",e,[t,n])?(this._commands||(this._commands={}),this._commands[e]={callback:t,context:n||this},this):this},complyOnce:function(e,n,r){if(!o(this,"complyOnce",e,[n,r]))return this;var i=this,s=t.once(function(){return i.stopComplying(e),n.apply(this,arguments)});return this.comply(e,s,r)},stopComplying:function(e){if(!o(this,"stopComplying",e))return this;var t=this._commands;return e?t&&t[e]?delete t[e]:s("Attempted to remove the unregistered command",e,this.channelName):delete this._commands,this}},i.Requests={request:function(e){var t=n.call(arguments,1),r=this.channelName,o=this._requests;r&&this._tunedIn&&i.log.apply(this,[r,e].concat(t));if(o&&(o[e]||o["default"])){var u=o[e]||o["default"];return t=o[e]?t:arguments,u.callback.apply(u.context,t)}s("An unhandled request was fired",e,r)},reply:function(e,t,n){return o(this,"reply",e,[t,n])?(this._requests||(this._requests={}),this._requests[e]={callback:f(t),context:n||this},this):this},replyOnce:function(e,n,r){if(!o(this,"replyOnce",e,[n,r]))return this;var i=this,s=t.once(function(){return i.stopReplying(e),f(n).apply(this,arguments)});return this.reply(e,s,r)},stopReplying:function(e){if(!o(this,"stopReplying",e))return this;var t=this._requests;return e?t&&t[e]?delete t[e]:s("Attempted to remove the unregistered request",e,this.channelName):delete this._requests,this}},i._channels={},i.channel=function(e){if(!e)throw new Error("You must provide a name for the channel.");return i._channels[e]||new i.Channel(e)},i.Channel=function(e){this.channelName=e,i._channels[e]=this},t.extend(i.Channel.prototype,e.Events,i.Commands,i.Requests,{reset:function(){return this.off(),this.stopListening(),this.stopComplying(),this.stopReplying(),this}});var l,c,h=[e.Events,i.Commands,i.Requests];return t.each(h,function(e){t.each(e,function(e,t){i[t]=function(e){return c=n.call(arguments,1),l=this.channel(e),l[t].apply(l,c)}})}),i}),define("radio",["backbone.radio"],function(e){return e}),define("app/helpers/errorsTranslator",["underscore","radio"],function(e,t){var n=function(n){var r=[];if(n){var i="An error has occurred, please try again...";e.each([].concat(n),function(e){e&&(e.type==="usage_exceeded"?r.push({message:e.message||"Your have reached your subscription plan limit, Please upgrade your subscription to continue.",type:"upgrade",buttons:[{"data-role":"upgrade",text:"Upgrade"}]}):e.type==="ineligible_feature"?r.push({message:e.message||"Please upgrade your subscription to continue.",type:"upgrade",buttons:[{"data-role":"upgrade",text:"Upgrade"}]}):e.type==="ineligible_alerts_data"?r.push({message:e.message||"Please upgrade your subscription to drill down into alerts data.",type:"upgrade",buttons:[{"data-role":"upgrade",text:"Upgrade"}]}):e.message&&(r.push(e),t.trigger("trace","error","Notified user with error response: "+e.message,e)))}),r.length===0&&r.push({message:i,type:"error"});var s=e.groupBy(r,function(e){return e.message});r=e.map(s,function(e){return e[0]})}return r};return{translate:n}}),define("formatters",["underscore","generated/countries","app/helpers/queryParams","app/helpers/urlFor","app/helpers/errorsTranslator"],function(e,t,n,r,i){var s,o={fromDotNetDateTime:function(e){if(e){if(typeof e=="string"){if(e[0]==="/"){var t=e.replace(/\/Date\((-?\d+)\)\//,"$1");return new Date(Number(t))}return new Date(e)}if(e instanceof Date&&!isNaN(e.valueOf()))return e}return null},fromString:function(e){if(e){if(typeof e=="string"){var t=e.split("/");return new Date(t[2],t[1],t[0])}if(e instanceof Date&&!isNaN(e.valueOf()))return e}return null},toExportDateString:function(e){return o.toIsoString(e).split(".")[0].replace(/[-\:T]/g,"_")},toIsoString:function(e){return typeof e=="string"&&(e=o.fromDotNetDateTime(e)),e.toISOString()},toShortDateString:function(e){return typeof e=="string"&&(e=o.fromDotNetDateTime(e)),e.toDateString()},toOrdinalNumberDate:function(e){typeof e=="string"&&(e=o.fromDotNetDateTime(e));var t=e.getDate();return t+(t>0?["th","st","nd","rd"][t>3&&t<21||t%10>3?0:t%10]:"")},toLocaleDateString:function(e){return typeof e=="string"&&(e=o.fromDotNetDateTime(e)),e.toLocaleDateString()},msToTimeString:function(e){var t=function(e){return(e<10?"0":"")+e},n=e%1e3;e=(e-n)/1e3;var r=e%60;e=(e-r)/60;var i=e%60,s=(e-i)/60;return t(s)+":"+t(i)+":"+t(r)+"."+n}},u="---",a,f={startsWith:function(e,t){return e.slice(0,t.length)==t},endsWith:function(e,t){return e.substring(e.length-t.length,e.length)===t},repeat:function(e,t){return typeof t!="number"||t<1?"":Array(Math.floor(t)+1).join(e)},encodeTechnologyName:function(e){return e?e.replace(/[\s\/\\]/g,"-").replace(/[,.]/g,"").toLowerCase():""},decodeTechnologyName:function(t){if(!t)return"";window.console&&window.console.warn&&window.console.warn('Possibly loose use of translation of technology sysname to tech name using decodeTechnologyName("'+(t||"")+'")'),s=s||require("app/instances/collections/technologiesList");if(s&&s.fetched&&s.length){var n=s.get(t);if(n)return n.get("name")}return e.map(t.split("-"),function(e){return(e[0]||"").toUpperCase()+e.slice(1)}).join(" ")},humanizeJoin:function(e,t,n,r){var i=e?e.slice(0):[],s;if(n){var o=e.length-n;s=o>0?i.splice(-o):[i.splice(-1)]}else s=[i.splice(-1)];return(i.length?i.join(", ")+" "+(t||"and")+" ":"")+(s.length>0?s.length===1?s[0]:s.length+(r?" "+r:" more"):"")},humanizeJoin2:function(e,t,n,r,i){var s=e?e.slice(0):[];if(s.length<=r+1)return s.join(t);var o;if(r){var u=e.length-r;o=u>0?s.splice(-u):[s.splice(-1)]}else o=[s.splice(-1)];return(s.length?s.join(t)+" "+t+""+(n||"and")+" ":"")+(o.length>0?o.length===1?o[0]:o.length+(i?" "+i:" more"):"")},toTitleCase:function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},pascalCaseToCamelCase:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},camelCaseToPascalCase:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},pascalCaseToWords:function(e){var t=/($[a-z])|[A-Z][^A-Z]+/g;return(e.match(t)||[e]).join(" ")},encodeCategoryKey:function(e){return e.replace(/\s>\s/g,"/").replace(/\s/g,"_")},decodeCategoryKey:function(e){return e.replace(/_/g," ").replace(/\//g," > ")},truncate:function(e,t){return e=e||"",e.length<=t?{text:e,truncated:!1}:{text:$.trim(e.substr(0,t-3))+"...",truncated:!0}},isRTL:function(e){return a=a||new RegExp("^[^"+u+"]*?["+u+"]"),a.test(e)},getProspectPid:function(e){var t=e.firstName,n=e.lastName,r=e.domain;return((t||"").replace(/\|/g,"||")+"|"+(n||"").replace(/\|/g,"||")+"|"+(r||"")).toLowerCase()},toSystemName:function(e){return e.toLowerCase().replace(/[^a-zA-Z0-9 \-]/g,"").replace(/ /g,"-")},escape:e.escape},l={round:function(e,t){return arguments.length===1&&(t=2),Math.round(e*Math.pow(10,t))/Math.pow(10,t)},roundFloat:function(e,t,n){return(Math.ceil(e/t)*t).toFixed(n)},withCommas:function(e,t,n){if(e===Infinity)return"&infin;";if(e===-Infinity)return"-&infin;";var r=Math.abs(e),i=r.toString().split(".");i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t&&(i[1]=r.toFixed(t).split(".")[1]);var s=i.join(".");return(e<0?"-":"")+(n||"")+s},fileSize:function(e){var t=e/1024,n;return t<1e3?n="KB":(t/=1024,t<1e3?n="MB":(t/=1024,t<1e3?n="GB":(t/=1024,n="TB"))),l.round(t,2)+n},abbreviateNumber:function(e,t,n){if(typeof e!="number")return 0;if(e===Infinity||e===Math.pow(2,64)-1)return"&infin;";if(e===-Infinity||e===-Math.pow(2,64)+1)return"-&infin;";var r,i="";return e>=1e9?(e/=1e9,r=2,i="B"):e>=1e6?(e/=1e6,r=2,i="M"):e>=1e3?(e/=1e3,r=1,i="K"):r=3,n!==undefined&&(r=Math.min(n,r)),t?e=e.toFixed(r):e=l.round(e,r),e+=i,e},roundBigNumber:function(e){if(!e)return 0;var t=Math.floor(Math.log(e)/Math.log(10)),n=t%2===1?Math.pow(10,(t+3)/2):5*Math.pow(10,(t+2)/2);return Math.round(e/n)*n}},c={fakeProfilePhoto:function(t){t=t||1;if(t===1||t>245)return e(t).times(function(){return"/images/profile-photos/raw/"+e.random(1,245)+".jpg"});if(t>1)return e.map(e.sample(e(245).times(function(e){return e+1}),t),function(e){return"/images/profile-photos/raw/"+e+".jpg"})},pixelatedProfilePhoto:function(t){t=t||1;if(t===1||t>211)return e(t).times(function(){return"/images/profile-photos/pixelated/"+e.random(1,153)+".png"});if(t>1)return e.map(e.sample(e(153).times(function(e){return e+1}),t),function(e){return"/images/profile-photos/pixelated/"+e+".png"})},favicon:function(e,t,n){return"//www.google.com/s2/favicons?domain="+e+(n?"&size="+n:"")+(t?"&defaulticon="+c.verifyProtocolExistence(t):"")},websiteLogoUrl:function(e){return"//logo.clearbit.com/"+c.extractDomainName(e)},verifyProtocolExistence:function(e){return f.startsWith(e,"//")?e="http:"+e:f.startsWith(e,"/")?e="https://www.similartech.com"+e:f.startsWith(e,"http://")==0&&f.startsWith(e,"https://")==0&&(e="http://"+e),e},extractDomainName:function(e){var t=!1;e=$.trim(e).replace(/^https?:\/\//,"").replace(/^www\./,"");var n=e.indexOf("/");return~n&&(t=n<e.length-1,e=e.substring(0,n)),e.replace(/\/\//g,"/"),~e.indexOf(".")?e:null},resizedTechLogo:function(e,t,n){e=e||"",n=n||1;var r=e.lastIndexOf("-");return~r?(t=Math.round(t),e.slice(0,r)+"-"+t+"x"+t+(n>1?"@"+n+"x":"")):e},refererMaksedHref:function(e){return'data:text/html;charset=utf-8, <html><meta http-equiv="refresh" content="0;URL=&#39;'+e+'&#39;"></html>'}},h={take:e.take,aggregateTail:function(e,t,n){var r=n.valueAttr||"value",i=n.createOthers?null:n.othersObj||{},s=n.createOthers?null:!n.nameAttr&&n.othersObj?null:n.nameAttr||"name",o=n.createOthers?null:n.othersLabel||"Others",u=[],a=[],f=-1,l,c=0,h,p=e.length,d;d=Math.min(t-1,e.length);while(++f<d)l=e[f],u.push(l);while(++f<p)l=e[f],h=l[r],c+=h,a.push(l);return c&&(n.createOthers?i=n.createOthers(c,a):(i[r]=c,s&&(i[s]=o)),u.push(i)),u}};return{series:h,date:o,string:f,number:l,countries:t,html:c,url:r,errors:i,queryParams:n}}),function(e){define("libs/backbone/backbone.notifier",["jquery","underscore","backbone"],function(){return function(){return function(e,t,n){var r=function(){},i=t.Notifier=t.Model.extend({defaults:{baseCls:"notifier",types:["warning","error","info","success"],dialog:!1,theme:"plastic",message:"",closeBtn:!1,title:undefined,hideOnClick:!0,type:null,cls:null,ms:1e4,loader:!1,destroy:!1,modal:!1,opacity:1,offsetY:0,fadeInMs:500,fadeOutMs:500,position:"top",screenOpacity:.65,zIndex:1e4,width:undefined,modules:undefined},transitions:{top:{"in":function(e,t,n,i,s){e.css({display:"block",top:-1e3}),e.css({top:-t.innerHeight()}).animate({top:n.offsetY,opacity:n.opacity},i,s||r)},out:function(e,t,n,i,s){e.animate({top:-t.innerHeight(),opacity:0},i,s||r)}},center:{"in":function(e,t,n,i,s){e.css({top:n.offsetY-40,display:"block"}).animate({top:"50%",marginTop:-t.innerHeight()/2,opacity:n.opacity},i,s||r)},out:function(e,t,n,i,s){e.animate({top:"0%",opacity:0},i,s||r)}},bottom:{"in":function(e,t,n,i,s){e.css({bottom:n.offsetY-40,top:"auto",display:"block"}).animate({bottom:t.innerHeight()+n.offsetY,opacity:n.opacity},i,s||r)},out:function(e,t,n,i,s){e.animate({bottom:-t.height(),opacity:0},i,s||r)}}},template:function(t){var r=['<div class="'+t.wrapperCls+'">','<div class="'+t.innerCls+'">',t.title?'<div class="'+t.baseCls+'-title">'+t.title+"</div>":"",t.closeBtn?'<button class="'+t.baseCls+'-close" data-handler="destroy"><span>&times;</span></button>':""];t.dialog?r.push('<div class="'+t.baseCls+'-message">'+t.message+(t.loader?'<div class="'+t.baseCls+'-loader"></div>':"")+"</div>"):r.push('<div class="'+t.baseCls+'-message">'+t.message+"</div>",t.loader?'<div class="'+t.baseCls+'-loader"></div>':"");if(t.buttons){var i=e("<div />");n.each(t.buttons,function(t){i.append(e("<button/>",t))}),r.push('<div class="'+t.baseCls+'-btns">'+i.html()+"</div>")}return r.push("</div></div>"),r.join("")},initEl:function(){var t=this.el?this.el:"body",r=n.isObject(t)?t:e(t);if(!r.length)return e(e.proxy(this.initEl,this));this.$el=r,this._cssPos=r.get(0)===document.body?"fixed":"absolute",r.get(0)!==document.body&&r.css("position","relative"),this._cssPos==="absolute"&&r.css("overflow","hidden")},initialize:function(r){var s=this;this.el=r&&r.el,this.initEl.call(this,r&&r.el),this.current={},s.NotificationView=t.View.extend({defaults:s.attributes,on:function(e,r){var i=r,s=this;return n.isString(r)&&(i=function(){s[r].apply(s,arguments)}),t.View.prototype.on.call(this,e,i)}});var o=function(e,t,r){n.isString(t)&&(t={message:t});var i=n.extend({},{type:""},t);return i.type=i.type?e+" "+i.type:e,s.notify(i,r)},u=function(e){s[e]=s[e]||function(t,n){return o(e,t,n)}};n.each(s.attributes.types,function(e){u(e)});if(s.attributes){var a=this.attributes.modules;a&&e.each(a,function(e,t){t.name=n.isArray(a)?t.name:e,i.regModule(t)}),s.attributes.modules=undefined}},calcZIndex:function(){if(this._cssPos==="absolute")return this.attributes.zIndex;var e=this.attributes.zIndex+1,t=this;return n.each(t.current,function(t){e=t.zIndex>e?t.zIndex:e}),++e},destroyAll:function(e,t){var r=0,i=this;return n.isFunction(e)?n.each(i.current,function(t){e(t)&&(t.destroy.call(t),r++)}):e!==undefined?n.each(i.current,function(n){n.settings[e]===t&&(n.destroy.call(n),r++)}):n.each(i.current,function(e){e.destroy.call(e),r++}),r},getWrapperCls:function(t){var n=t.baseCls+" "+(t.type?t.type+" ":"")+("theme-"+t.theme+" ")+(t.dialog?"dialog ":"")+("pos-"+t.position+" ")+(t.buttons?"with-buttons ":"")+(t.loader?"with-loader ":"")+(t.closeBtn?"with-close-btn ":"");return e.trim(n).split(" ").join(" "+t.baseCls+"-")+" "+(t.cls||"")},getSettings:function(t,r){n.isString(t)&&(t={message:t}),r===!0&&(r={sanitize:!0});var i=e.extend({},this.attributes,t,n.isObject(r)?r:undefined);return i.sanitize&&(i.message=n.escape(i.message)),i.title&&t.dialog===undefined&&(i.dialog=!0),(i.modal||i.dialog)&&t.hideOnClick===undefined&&(i.hideOnClick=!1),i.dialog&&t.ms===undefined&&(i.ms=null),i.dialog&&t.position===undefined&&(i.position="center"),i},notify:function(t,r){typeof t=="string"?t={message:t}:t=t||{},t.el&&(this.el=t&&t.el,this.initEl.call(this,t&&t.el));var s=this,o=this.getSettings(t,r);n.isObject(o.destroy)?o.destroy instanceof s.NotificationView?o.destroy.destroy():s.destroyAll.apply(s,n.isArray(o.destroy)?o.destroy:[o.destroy]):o.destroy===!0&&s.destroyAll();var u=t.zIndex||s.calcZIndex.call(s);o.wrapperCls=s.getWrapperCls(o),o.innerCls=o.baseCls+"-inner";var a=e(s.template(o)),f=a.find("."+o.innerCls);o.width&&f.css({width:o.width}),i._modulesBinder.trigger("beforeAppendMsgEl",s,o,a,f),a.css({display:"none",opacity:0,position:s._cssPos,zIndex:o.modal?++u:u}).prependTo(s.$el);var l=new s.NotificationView({el:a});l.settings=o;if(o.buttons||f.find("button").length)f.on("click","button[data-handler]",function(){var t=e(this).data("handler"),r=n.isFunction(t)?t:l[t];r.apply(l,arguments)}),f.on("button click",function(t){var n=e(t.target);n.is("button")||(n=n.closest("button[data-role]")),n.length&&l.trigger("click:"+n.data("role"))});var c=l.destroy=function(t){n.isObject(t)&&t.preventDefault&&(t.preventDefault(),t.stopPropagation()),l.trigger("beforeHide",l,a),o.modal&&l.screenEl.fadeOut(300,function(){l.trigger("screenHide",l,a),l.screenEl.remove()}),i._modulesBinder.trigger("beforeHideMsgEl",s,o,a,f,l);var r=e.isFunction(o.out)?o.out:s.transitions[o.position].out;r.call(s,a,f,o,o.fadeOutMs,function(){l.remove(),l.trigger("destroy",l,a),i._modulesBinder.trigger("afterDestroyMsgEl",s,o,a,f,l),n.isFunction(t)&&t.call(l,l,a)}),l.timeoutId&&clearTimeout(l.timeoutId),delete l.timeoutId,delete s.current[l.cid]},h=function(e){e&&(e.preventDefault(),e.stopPropagation())};o.modal&&(l.screenEl=e("<div/>",{"class":o.baseCls+"-screen "+o.baseCls+"-theme-"+o.theme,css:{position:s._cssPos,top:0,left:0,width:"100%",height:"100%",opacity:0,zIndex:u-1}}).prependTo(s.$el).click(function(e){return e.preventDefault(),e.stopPropagation(),!1}).fadeTo(300,o.screenOpacity));if(o.ms>0||o.ms===0)l.timeoutId=setTimeout(function(){l.trigger("timeout",l,a),c()},o.ms);f.click("a",function(t){var n=e(t.toElement).attr("href");n&&(window.location.href=n)}),f.click(o.hideOnClick?c:h),o.css&&f.css(o.css);var p=e.isFunction(o["in"])?o["in"]:s.transitions[o.position]["in"];return s.current[l.cid]=l,l.zIndex=u,i._modulesBinder.trigger("beforeAnimateInMsgEl",s,o,a,f,l),p.call(s,a,f,o,o.fadeInMs,function(){i._modulesBinder.trigger("afterAnimateInMsgEl",s,o,a,f,l)}),l}});i.getModule=function(e){return n.isObject(e)?e:i.modules[e]};var s={},o=Array.prototype.shift;n.extend(s,t.Events),i._modulesBinder=s,i.regModule=function(t,r){arguments.length===1?(r=e.isFunction(t)?t():t,t=r.name):(r=e.isFunction(r)?r():r,r.name=t);if(!t)throw"module name is not defined.";return r.extend&&e.each(r.extend,function(t,s){var o=i.prototype[t];n.isFunction(s)||o===undefined?i.prototype[t]=function(){return s.apply({scope:this,supr:o,module:r},arguments)}:n.isObject(s)?i.prototype[t]=e.extend(!0,{},o,s):i.prototype[t]=s}),(i.modules=i.modules||{})[t]=r,e.isFunction(r.register)&&r.register.call(r,i),r.enabled&&i.enableModule(r),r},i.enableModule=function(t){var n=i.getModule(t);return n?(n._handlers=n._handlers||{},n.events&&e.each(n.events,function(e,t){var r=n._handlers[e]=function(){var e=o.call(arguments);t.apply({module:n,scope:e},arguments)};i._modulesBinder.on(e,r)}),n.enabled=!0,e.isFunction(n.enable)&&n.enable.call(n,i),n):!1},i.disableModule=function(t){var n=i.getModule(t);return n?(e.each(n._handlers,function(e,t){i._modulesBinder.off(e,t)}),n.enabled=!1,e.isFunction(n.disable)&&n.disable.call(n,i),n):!1}}(jQuery,Backbone,_),function(e,t,n){e.regModule({name:"template",enabled:!0,extend:{template:function(e){if(e.data){var t=n.template(e.message);e.message=t(e.data)}return this.supr.call(this.scope,e)}}})}(Backbone.Notifier,jQuery,_),Backbone.Notifier}.apply(e,arguments)})}(this),define("notifier",["underscore","formatters","libs/backbone/backbone.notifier"],function(e,t,n){return n.regModule({name:"zIndex",enabled:!0,extend:{getSettings:function(e,t){e=e||{};var n=$.extend({zIndex:this.scope.attributes.zIndex,offsetY:this.scope.attributes.offsetY},e);return n.type==="danger"&&(n.type="error"),typeof n.zIndex=="function"&&(n.zIndex=n.zIndex(n)),typeof n.offsetY=="function"&&(n.offsetY=n.offsetY(n)),this.supr.call(this.scope,n,t)}}}),n.regModule({name:"hPosition",enabled:!0,events:{beforeAnimateInMsgEl:function(e,t,n,r){e.hPosition==="left"?t.addClass("notifier-pos-left").css({"text-align":"left"}):e.hPosition==="right"&&t.addClass("notifier-pos-right").css({"text-align":"right"})}}}),n.regModule({name:"customTemplate",enabled:!0,extend:{template:function(t){var n=t.icon===!1?"":e.isString(t.icon)?t.icon:"icon-"+(t.type||"default"),r=(n?'<i class="'+n+' notify-icon"></i>':"")+t.message,i=['<div class="'+t.wrapperCls+(t.icon===!1?" notifier-no-icon":"")+'">','<div class="'+t.innerCls+'">',t.title?'<div class="'+t.baseCls+'-title">'+t.title+"</div>":"",t.closeBtn?'<button class="'+t.baseCls+'-close" data-handler="destroy"><span>&times;</span></button>':""],s="";t.buttons&&t.inlineActions&&(s+='<span class="'+t.baseCls+"-btns inline-btns"+'">',e.each(t.buttons,function(e){e.class=(e.class||"")+" btn btn-transparent",s+=$("<button/>",e)[0].outerHTML}),s+="</span>"),t.dialog?i.push('<div class="'+t.baseCls+'-message">'+r+(t.loader?'<div class="'+t.baseCls+'-loader">'+$.fn.slideLoader.defaults.template+"</div>":"")+s+"</div>"):i.push('<div class="'+t.baseCls+'-message">'+r+s+"</div>",t.loader?'<div class="'+t.baseCls+'-loader">'+$.fn.slideLoader.defaults.template+"</div>":"");if(t.buttons&&!t.inlineActions){var o=$("<div />");e.each(t.buttons,function(e){e.class=(e.class||"")+" btn btn-transparent",o.append($("<button/>",e))}),i.push('<div class="'+t.baseCls+'-btns">'+o.html()+"</div>")}return i.push("</div></div>"),i.join("")}}}),n.regModule({name:"errorResponseHandler",enabled:!0,extend:{handleErrorResponse:function(r){var i=this;e.each(t.errors.translate(r||[]),function(e){i.scope.notify({src:"errorResponseHandler",type:e.type&&~n.prototype.defaults.types.indexOf(e.type)?e.type:"error",inlineActions:!0,ms:e.buttons?3e4:undefined,icon:e.icon,message:e.message,loader:!1,closeBtn:!0,buttons:e.buttons}).on("click:upgrade",function(){require("subscription").showPlanChooser()})})}}}),n.regModule({name:"flash",enabled:!0,storageKey:"_notifierFlash",push:function(e){if(!this.supportsStorage)return!1;try{window.sessionStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){return!1}return!0},pop:function(){var e,t;try{e=window.sessionStorage.getItem(this.storageKey),e&&(window.sessionStorage.removeItem(this.storageKey),e.length&&(t=JSON.parse(e)))}catch(n){}return t},register:function(){this.supportsStorage=window.sessionStorage!==undefined&&!!window.sessionStorage.setItem&&!!window.sessionStorage.getItem},extend:{initialize:function(){var e=this.supr.apply(this.scope,arguments);return this.scope._showFlashed(),e},_showFlashed:function(){var e=this.module.pop();e&&this.scope.notify.call(this.scope,e)},flash:function(e){return this.module.push(e)}}}),new n({ms:2e4,theme:"st",destroy:!0,zIndex:1e4,offsetY:function(){return $("body").is(".modal-open, .overlay-open")?6:85}})}),function(){var e,t,n,r,i,s,o=[].slice;n=function(e){var t,r;return!_.isObject(e)||_.isFunction(e)?e:e instanceof Backbone.Collection||e instanceof Backbone.Model?e:_.isDate(e)?new Date(e.getTime()):_.isRegExp(e)?new RegExp(e.source,e.toString().replace(/.*\//,"")):(r=_.isArray(e||_.isArguments(e)),t=function(e,t,i){return r?e.push(n(t)):e[i]=n(t),e},_.reduce(e,t,r?[]:{}))},s=function(e){return e==null?!1:(e.prototype==={}.prototype||e.prototype===Object.prototype)&&_.isObject(e)&&!_.isArray(e)&&!_.isFunction(e)&&!_.isDate(e)&&!_.isRegExp(e)&&!_.isArguments(e)},t=function(e){return _.filter(_.keys(e),function(t){return s(e[t])})},e=function(e){return _.filter(_.keys(e),function(t){return _.isArray(e[t])})},i=function(n,r,s){var o,u,a,f,l,c,h,p,d,v;s==null&&(s=20);if(s<=0)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),_.extend(n,r);c=_.intersection(t(n),t(r)),u=function(e){return r[e]=i(n[e],r[e],s-1)};for(h=0,d=c.length;h<d;h++)l=c[h],u(l);f=_.intersection(e(n),e(r)),o=function(e){return r[e]=_.union(n[e],r[e])};for(p=0,v=f.length;p<v;p++)a=f[p],o(a);return _.extend(n,r)},r=function(){var e,t,r,s;r=2<=arguments.length?o.call(arguments,0,s=arguments.length-1):(s=0,[]),t=arguments[s++],_.isNumber(t)||(r.push(t),t=20);if(r.length<=1)return r[0];if(t<=0)return _.extend.apply(this,r);e=r.shift();while(r.length>0)e=i(e,n(r.shift()),t);return e},_.mixin({deepClone:n,isBasicObject:s,basicObjects:t,arrays:e,deepExtend:r})}.call(this),function(e){typeof define=="function"&&define.amd?define("backbone.deepmodel",["underscore","backbone"],e):e(_,Backbone)}(function(e,t){function n(t){var r={},i=o.keyPathSeparator;for(var s in t){var u=t[s];if(u&&u.constructor===Object&&!e.isEmpty(u)){var a=n(u);for(var f in a){var l=a[f];r[s+i+f]=l}}else r[s]=u}return r}function r(t,n,r){var i=o.keyPathSeparator,s=n.split(i),u=t;r||r===!1;for(var a=0,f=s.length;a<f;a++){if(r&&!e.has(u,s[a]))return!1;u=u[s[a]],u==null&&a<f-1&&(u={});if(typeof u=="undefined")return r?!0:u}return r?!0:u}function i(t,n,r,i){i=i||{};var s=o.keyPathSeparator,u=n.split(s),a=t;for(var f=0,l=u.length;f<l&&a!==undefined;f++){var c=u[f];if(f===l-1)i.unset?delete a[c]:a[c]=r;else{if(typeof a[c]=="undefined"||!e.isObject(a[c]))a[c]={};a=a[c]}}}function s(e,t){i(e,t,null,{unset:!0})}var o=t.Model.extend({constructor:function(t,n){var r,i=t||{};this.cid=e.uniqueId("c"),this.attributes={},n&&n.collection&&(this.collection=n.collection),n&&n.parse&&(i=this.parse(i,n)||{});if(r=e.result(this,"defaults"))i=e.deepExtend({},r,i);this.set(i,n),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(t){return e.deepClone(this.attributes)},get:function(e){return r(this.attributes,e)},set:function(t,u,a){var f,l,c,h,p,d,v,m;if(t==null)return this;typeof t=="object"?(l=t,a=u||{}):(l={})[t]=u,a||(a={});if(!this._validate(l,a))return!1;c=a.unset,p=a.silent,h=[],d=this._changing,this._changing=!0,d||(this._previousAttributes=e.deepClone(this.attributes),this.changed={}),m=this.attributes,v=this._previousAttributes,this.idAttribute in l&&(this.id=l[this.idAttribute]),l=n(l);for(f in l)u=l[f],e.isEqual(r(m,f),u)||h.push(f),e.isEqual(r(v,f),u)?s(this.changed,f):i(this.changed,f,u),c?s(m,f):i(m,f,u);if(!p){h.length&&(this._pending=!0);var g=o.keyPathSeparator;for(var y=0,b=h.length;y<b;y++){var t=h[y];this.trigger("change:"+t,this,r(m,t),a);var w=t.split(g);for(var E=w.length-1;E>0;E--){var S=e.first(w,E).join(g),x=S+g+"*";this.trigger("change:"+x,this,r(m,S),a)}}}if(d)return this;if(!p)while(this._pending)this._pending=!1,this.trigger("change",this,a);return this._pending=!1,this._changing=!1,this},clear:function(t){var r={},i=n(this.attributes);for(var s in i)r[s]=void 0;return this.set(r,e.extend({},t,{unset:!0}))},hasChanged:function(t){return t==null?!e.isEmpty(this.changed):r(this.changed,t)!==undefined},changedAttributes:function(t){if(!t)return this.hasChanged()?n(this.changed):!1;var r=this._changing?this._previousAttributes:this.attributes;t=n(t),r=n(r);var i,s=!1;for(var o in t){if(e.isEqual(r[o],i=t[o]))continue;(s||(s={}))[o]=i}return s},previous:function(e){return e==null||!this._previousAttributes?null:r(this._previousAttributes,e)},previousAttributes:function(){return e.deepClone(this._previousAttributes)}});return o.keyPathSeparator=".",t.DeepModel=o,typeof module!="undefined"&&(module.exports=o),t}),define("accountInfo",["jquery","underscore","backbone","initialData","notifier","radio","app/helpers/queryParams","backbone.deepmodel"],function(e,t,n,r,i,s,o){var u=r.accountInfo,a=n.DeepModel.extend({logoutRedirectUrl:"/",loginRedirectUrl:"/dashboard/technologies/reports",registerRedirectUrl:"/dashboard/technologies/reports?callback=joined",url:"/api/account/accountinfo",getFullName:function(){return t.compact([this.get("firstName"),this.get("lastName")]).join(" ")},initialize:function(){var e=this;this.on("change:username",this.onChange)},getLoginRedirectUrl:function(e){var t=o("ReturnUrl");t&&(t+=location.hash);var n=t?t:e?this.registerRedirectUrl:this.loginRedirectUrl;return n&&(t||window.location.pathname==="/"||window.location.pathname.indexOf("/promos/")===0)?n:location.href},onChange:function(){var e=this;if(this.get("username")){var t={preventDefault:function(){t._preventedRedirect=!0},await:function(e){return t._awaitTo=e.promise?e.promise():e,e},_preventedRedirect:!1};this.trigger("login",this.toJSON(),t);var n=function(){var t=e.get("isNewUser");i.flash({type:"success",message:t?"Your account was successfully created":"Welcome back "+(e.get("firstName")||e.get("username"))+"! Your are now logged in"});var n=e.getLoginRedirectUrl(t);n&&(n+=location.hash);var r=n?n:t?e.registerRedirectUrl:e.loginRedirectUrl;r&&(n||window.location.pathname==="/"||window.location.pathname.indexOf("/promos/")===0)?window.location.href=r:window.location.reload()};t._preventedRedirect?this.trigger("loginRedirectPrevented",this.toJSON(),t):t._awaitTo?t._awaitTo.then(n):n()}else this.trigger("logout",this._previousAttributes)},resolveLogin:function(t){var n=this;return e.get("/api/account/csrf").done(function(t){t&&(window.__RequestVerificationToken=t.token,e('body>input[name="__RequestVerificationToken"]').val(t.token))}).fail(function(){}).always(function(){n.set(t)})},logout:function(){var t=this;e.ajax({type:"post",url:"/api/account/logout",cache:!1}).always(function(e,n){t.clear(),i.flash({type:"success",message:"You are now signed out"}),e&&e.success?~location.href.indexOf("/dashboard")?window.location.href=t.logoutRedirectUrl:window.location.reload():window.location.href="/account/logout"})},isLoggedIn:function(){return!!this.get("username")}});return new a(u)}),define("app/models/subscriptionPlanModel",["underscore","jquery","backbone"],function(e,t,n){return n.Model.extend({idAttribute:"code"})}),define("app/collections/subscriptionPlans",["underscore","jquery","backbone","../models/subscriptionPlanModel"],function(e,t,n,r){return n.Collection.extend({initialize:function(e,t){},model:r,url:"/api/subscription/pricingplans"})}),define("subscription",["jquery","underscore","backbone","accountInfo","initialData","radio","formatters","app/collections/subscriptionPlans"],function(e,t,n,r,i,s,o,u){var a={technologyReport:"TechnologyReports",technologyAlert:"TechnologyAlerts",websiteAlert:"WebsitesAlerts",websiteAlert_showData:"WebsiteAlerts_ShowData",websiteAlert_maxWebsites:"WebsiteAlerts_MaxWebsites",technologyReport_byCategory:"TechnologyReports_ByCategory",technologyReport_byCountry:"TechnologyReports_ByCountry",technologyReport_includeVisits:"TechnologyReports_IncludeVisits",technologyReport_includeContactDetails:"TechnologyReports_IncludeContactDetails",technologyReport_includeAllTechnologies:"TechnologyReports_IncludeAllTechnologies",technologyReport_advancedFiltering:"TechnologyReports_AdvancedFiltering",technologyReport_companyFiltering:"TechnologyReports_CompanyFiltering",technologyReport_maxWebsites:"TechnologyReport_MaxWebsites",technologyReport_byTechCategory:"TechnologyReports_ByTechCategory",search_maxWebsite:"Search_MaxWebsite",technologyReport_byDomainSuffix:"TechnologyReports_ByDomainSuffix",technologyReport_byMonthlyVisits:"TechnologyReports_ByMonthlyVisits",technologyReport_maxWebsitesInListSize:"TechnologyReport_MaxWebsitesInListSize",technologyAlert_maxResults:"TechnologyAlerts_MaxResults",apiCredits:"APIMonthlyQuota",apiCreditsTimeless:"APITimelessQuota",emailVerificationQuota:"EmailVerificationQuota",emailIdentificationQuota:"EmailIdentificationQuota",salesforceIntegration:"SalesforceIntegration",technologyReportExports:"TechnologyReportExports",customReport_maxSize:"CustomReports_MaxSize",customReport_totalRecords:"CustomReports_TotalRecords",customReport_refreshReport:"CustomReports_RefreshReport",historicalReports_websitesExports:"HistoricalReports_WebsitesExports",historicalReports_technologyExports:"HistoricalReports_TechnologyExports",search_enabled:"Search_Enabled",users:"Users"},f=s.channel("subscription"),l=function(e){return{TechnologyReports:function(){return e.attributes.permissions.TechnologyReports.limit===undefined||e.attributes.permissions.TechnologyReports.current<e.attributes.permissions.TechnologyReports.limit},TechnologyAlerts:function(){return e.attributes.permissions.TechnologyAlerts.limit===undefined||e.attributes.permissions.TechnologyAlerts.current<e.attributes.permissions.TechnologyAlerts.limit},WebsitesAlerts:function(){return e.attributes.permissions.WebsitesAlerts===undefined||e.attributes.permissions.WebsitesAlerts.current<e.attributes.permissions.WebsitesAlerts.limit},APIMonthlyQuota:function(){return e.attributes.permissions.APIMonthlyQuota===undefined||e.attributes.permissions.APIMonthlyQuota.current<e.attributes.permissions.APIMonthlyQuota.limit},EmailVerificationQuota:function(){return!!(e.attributes.permissions.EmailVerificationQuota&&e.attributes.permissions.EmailVerificationQuota.current<e.attributes.permissions.EmailVerificationQuota.limit)},EmailIdentificationQuota:function(){return!!(e.attributes.permissions.EmailIdentificationQuota&&e.attributes.permissions.EmailIdentificationQuota.current<e.attributes.permissions.EmailIdentificationQuota.limit)},TechnologyReportExports:function(){return!!(e.attributes.permissions.TechnologyReportExports&&e.attributes.permissions.TechnologyReportExports.current<e.attributes.permissions.TechnologyReportExports.limit)},HistoricalReports_WebsitesExports:function(){return!!(e.attributes.permissions.HistoricalReports_WebsitesExports&&e.attributes.permissions.HistoricalReports_WebsitesExports.current<e.attributes.permissions.HistoricalReports_WebsitesExports.limit)},HistoricalReports_TechnologyExports:function(){return!!(e.attributes.permissions.HistoricalReports_TechnologyExports&&e.attributes.permissions.HistoricalReports_TechnologyExports.current<e.attributes.permissions.HistoricalReports_TechnologyExports.limit)},TechnologyReport_MaxWebsites:function(t){return e.attributes.permissions.TechnologyReport_MaxWebsites===undefined||t<=e.attributes.permissions.TechnologyReport_MaxWebsites.value},Search_MaxWebsite:function(t){return e.attributes.permissions.TechnologyReport_MaxWebsites===undefined||t<=e.attributes.permissions.TechnologyReport_MaxWebsites.value},TechnologyAlerts_MaxResults:function(t){return e.attributes.permissions.TechnologyAlerts_MaxResults===undefined||t<=e.attributes.permissions.TechnologyAlerts_MaxResults.value},WebsiteAlerts_MaxWebsites:function(t){return e.attributes.permissions.WebsiteAlerts_MaxWebsites===undefined||t<=e.attributes.permissions.WebsiteAlerts_MaxWebsites.value},TechnologyReport_MaxWebsitesInListSize:function(t){return e.attributes.permissions.TechnologyReport_MaxWebsitesInListSize===undefined||t<=e.attributes.permissions.TechnologyReport_MaxWebsitesInListSize.value},TechnologyReports_ByCategory:function(){return!!e.attributes.permissions.TechnologyReports_ByCategory&&!!e.attributes.permissions.TechnologyReports_ByCategory.enabled},Search_Enabled:function(){return!!e.attributes.permissions.Search_Enabled&&!!e.attributes.permissions.Search_Enabled.enabled},TechnologyReports_ByCountry:function(){return!!e.attributes.permissions.TechnologyReports_ByCountry&&!!e.attributes.permissions.TechnologyReports_IncludeVisits.enabled},TechnologyReports_IncludeVisits:function(){return!!e.attributes.permissions.TechnologyReports_IncludeVisits&&!!e.attributes.permissions.TechnologyReports_IncludeVisits.enabled},TechnologyReports_IncludeContactDetails:function(){return!!e.attributes.permissions.TechnologyReports_IncludeContactDetails&&!!e.attributes.permissions.TechnologyReports_IncludeContactDetails.enabled},TechnologyReports_IncludeAllTechnologies:function(){return!!e.attributes.permissions.TechnologyReports_IncludeAllTechnologies&&!!e.attributes.permissions.TechnologyReports_IncludeAllTechnologies.enabled},WebsiteAlerts_ShowData:function(){return!!e.attributes.permissions.WebsiteAlerts_ShowData&&!!e.attributes.permissions.WebsiteAlerts_ShowData.enabled},TechnologyReports_AdvancedFiltering:function(){return!!e.attributes.permissions.TechnologyReports_AdvancedFiltering&&!!e.attributes.permissions.TechnologyReports_AdvancedFiltering.enabled},TechnologyReports_CompanyFiltering:function(){return!!e.attributes.permissions.TechnologyReports_CompanyFiltering&&!!e.attributes.permissions.TechnologyReports_CompanyFiltering.enabled},TechnologyReports_ByTechCategory:function(){return!!e.attributes.permissions.TechnologyReports_ByTechCategory&&!!e.attributes.permissions.TechnologyReports_ByTechCategory.enabled},TechnologyReports_ByDomainSuffix:function(){return!!e.attributes.permissions.TechnologyReports_ByDomainSuffix&&!!e.attributes.permissions.TechnologyReports_ByDomainSuffix.enabled},SalesforceIntegration:function(){return!!e.attributes.permissions.SalesforceIntegration&&!!e.attributes.permissions.SalesforceIntegration.enabled},CustomReports_RefreshReport:function(){return!!e.attributes.permissions.CustomReports_RefreshReport&&!!e.attributes.permissions.CustomReports_RefreshReport.enabled},TechnologyReports_ByMonthlyVisits:function(){return!!e.attributes.permissions.TechnologyReports_ByMonthlyVisits&&!!e.attributes.permissions.TechnologyReports_ByMonthlyVisits.enabled}}},c=new u(i.plans),h=function(e,t){var n=r.get("permissions"),i;arguments.length===1?i=e||{}:(i={},i[e]=t),d(i,n)},p=function(e){var t=r.previousAttributes().permissions;d(e,t)},d=function(n,r){t.each(t.keys(n),function(i){var s=r[i],o=n[i],u=!t.isEqual(s,o);if(u){var a={};a[i]=o,e.extend(!0,r,a),f.trigger("usageChange",i,o)}})},v={plans:c,upgradeSubscriptionUrl:function(e){var n;return e&&(t.isObject(e)?(n=e,e=n.get("code")):n=c.get(e)),"/contact-us/methods/message?message="+encodeURIComponent("Please change my subscription plan (and billing amount accordingly) from `#CURRENT#` to - #NEW#".replace("#CURRENT#",r.get("plan")).replace("#NEW#",n?"`"+n.get("name")+"` ("+n.get("code")+")":""))},inquiryUrl:function(e,t){return"/contact-us/methods/message?query=inquiry"+(e?"&message="+encodeURIComponent("Please contact me regarding"+(t&&(t+"").toLowerCase()!=="monthly"?" "+t+" billing of":"")+" the #PLAN# plan.".replace("#PLAN#",e)):"")},customInquiryUrl:function(e){return"/contact-us/methods/message?query=inquiry&message="+(e?encodeURIComponent(e):"")},buyEmailDiscoveryCreditsUrl:function(){return"/contact-us/methods/message?query=inquiry&message="+encodeURIComponent("Please contact me regarding purchasing of email discovery credits.")},multipleUsersinquiryUrl:function(){return"/contact-us/methods/message?query=inquiry&message="+encodeURIComponent("Please contact me regarding a solution for multiple team members")},PERMISSIONS:a,showPlanChooser:function(e){window.location.href=v.getPlanChooserUrl(e)},getPlanChooserUrl:function(t){return o.url.addQueryParams("/pricing",e.extend(v.isPaying()?{mode:"change-plan"}:{},t))},startUpgradePlanFlow:function(t){t=e.extend({completeRedirectUrl:"/dashboard?callback=joined",completeButtonText:"Continue"},t);var n=(t.planData?t.planData.get("code"):null)||t.planCode||c.last().id,r=t.planData||c.get(n),i=new e.Deferred;if(!t.forced&&(v.isPaying()||v.isPending()))s.trigger("subscriptionFlow","redirectToUpgrade",{planCode:n,planName:r.get("name")}),window.location.href=v.upgradeSubscriptionUrl(r);else{var o=r.toJSON(),u=s.request("subscriptionFlow","showDialog",{planData:o,forced:t.forced,completeButtonText:t.completeButtonText,completeRedirectUrl:t.completeRedirectUrl,onComplete:function(){i.resolve()}});s.trigger("subscriptionFlow","dialogShown",{planCode:n,planName:o.name})}return i.promise()},requirePermissions:function(e,t){var n=Array.prototype.slice.call(arguments,0,arguments.length-1);v.isPermitted.apply(v,n)?t&&t():v.startUpgradePlanFlow(undefined,t)},getLabelForFeatureValue:function(e,n){if(arguments.length===1&&t.isObject(e)){var r=e;e=r.key,n=r.value}if(e===a.technologyReport||e===a.technologyAlert||e===a.websiteAlert)if(n>=1e3)return"Unlimited";return o.number.withCommas(n)},value:function(e,t){t=t||r;var n=t.attributes&&t.attributes.permissions&&t.attributes.permissions[e];return(n||{}).value},quota:function(e,t){t=t||r;var n=t.attributes&&t.attributes.permissions&&t.attributes.permissions[e];return n||(n={limit:0,current:0}),n},credits:function(e,t){t=t||r;var n=t.attributes&&t.attributes.permissions&&t.attributes.permissions[e];return n&&n.hasOwnProperty("current")&&n.hasOwnProperty("limit")?Math.max(0,n.limit-n.current):0},isPermitted:function(e,t){return t=t||r,!t.attributes||!t.attributes.permissions||!l(t)[e]?!1:l(t)[e].apply(v,Array.prototype.splice.call(arguments,1))},isOnFreePlan:function(e){return e=e||r,e.isLoggedIn()&&(e.get("plan")||"").toLowerCase()==="free"},isPaying:function(e){return e=e||r,!!(e.isLoggedIn()&&Number(e.get("planCode")||0)>0)},isPending:function(e){return e=e||r,!!(e.isLoggedIn()&&e.get("subscriptionStatus")&&~e.get("subscriptionStatus").toLowerCase().indexOf("pending"))},getCustomRecordsQuota:function(){var e=v.value(a.customReport_maxSize)||0,t=v.quota(a.customReport_totalRecords)||{},n=t.limit||0,r=t.current||0,i=Math.max(n-r,0),s=Math.min(i,e);return{maxSize:e,quotaLimit:n,quotaCurrent:r,quotaRemaining:i,globalAllowed:s}},isTeamMember:function(e){e=e||r;if(e.isLoggedIn()){var t=e.get("username"),n="@similartech.com";return t.indexOf(n,t.length-n.length)!==-1}return!1},isBlocked:function(e){return e=e||r,!!e.isLoggedIn()&&!!(e.get("plan")==="Deleted"||e.get("subscriptionStatus")&&e.get("subscriptionStatus").toLowerCase()==="blocked")},channel:f};return v.plans.each(function(e){e.attributes.getFeatureValueLabel=function(t){return v.getLabelForFeatureValue(e.attributes.features[t])}}),s.on("technologyAlerts","create",function(){r.attributes.permissions.TechnologyAlerts&&(r.attributes.permissions.TechnologyAlerts.current++,f.trigger("usageChange","watchedTechnologies",r.attributes.permissions.TechnologyAlerts.current))}),s.on("technologyAlerts","delete",function(){r.attributes.permissions.TechnologyAlerts&&(r.attributes.permissions.TechnologyAlerts.current--,f.trigger("usageChange","watchedTechnologies",r.attributes.permissions.TechnologyAlerts.current))}),s.on("websiteAlerts","create",function(){r.attributes.permissions.WebsitesAlerts&&(r.attributes.permissions.WebsitesAlerts.current++,f.trigger("usageChange","watchedWebsites",r.attributes.permissions.WebsitesAlerts.current))}),s.on("websiteAlerts","delete",function(){r.attributes.permissions.WebsitesAlerts&&(r.attributes.permissions.WebsitesAlerts.current--,f.trigger("usageChange","watchedWebsites",r.attributes.permissions.WebsitesAlerts.current))}),s.on("emailDiscoveryService","creditsUpdate",function(e){h(a.emailIdentificationQuota,e)}),s.on("customReports","quotaUpdate",function(e){h(a.customReport_totalRecords,e)}),s.on("techReportsDownload","downloadStarted",function(){var e=v.quota(a.technologyReportExports)||{};h(a.technologyReportExports,{current:(e.current||0)+1,limit:e.limit||0})}),t.extend(v,n.Events),v.listenTo(r,"sync change:permissions.*",function(e,t,n){var i=r.get("permissions");p(i)}),v}),function(e){define("modernizr",[],function(){return function(){return window.Modernizr=function(e,t,n){function N(e){f.cssText=e}function C(e,t){return N(h.join(e+";")+(t||""))}function k(e,t){return typeof e===t}function L(e,t){return!!~(""+e).indexOf(t)}function A(e,t){for(var r in e){var i=e[r];if(!L(i,"-")&&f[i]!==n)return t=="pfx"?i:!0}return!1}function O(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:k(s,"function")?s.bind(r||t):s}return!1}function M(e,t,n){var r=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+d.join(r+" ")+r).split(" ");return k(t,"string")||k(t,"undefined")?A(i,t):(i=(e+" "+v.join(r+" ")+r).split(" "),O(i,t,n))}var r="2.8.3",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l,c={}.toString,h=" -webkit- -moz- -o- -ms- ".split(" "),p="Webkit Moz O ms",d=p.split(" "),v=p.toLowerCase().split(" "),m={},g={},y={},b=[],w=b.slice,E,S=function(e,n,r,i){var s,a,f,l,c=t.createElement("div"),h=t.body,p=h||t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:u+(r+1),c.appendChild(f);return s=["&#173;",'<style id="s',u,'">',e,"</style>"].join(""),c.id=u,(h?c:p).innerHTML+=s,p.appendChild(c),h||(p.style.background="",p.style.overflow="hidden",l=o.style.overflow,o.style.overflow="hidden",o.appendChild(p)),a=n(c,e),h?c.parentNode.removeChild(c):(p.parentNode.removeChild(p),o.style.overflow=l),!!a},x={}.hasOwnProperty,T;!k(x,"undefined")&&!k(x.call,"undefined")?T=function(e,t){return x.call(e,t)}:T=function(e,t){return t in e&&k(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=w.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(w.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(w.call(arguments)))};return i}),m.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:S(["@media (",h.join("touch-enabled),("),u,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n},m.cssanimations=function(){return M("animationName")},m.csstransforms3d=function(){var e=!!M("perspective");return e&&"webkitPerspective"in o.style&&S("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t,n){e=t.offsetLeft===9&&t.offsetHeight===3}),e},m.csstransitions=function(){return M("transition")};for(var _ in m)T(m,_)&&(E=_.toLowerCase(),i[E]=m[_](),b.push((i[E]?"":"no-")+E));return i.addTest=function(e,t){if(typeof e=="object")for(var r in e)T(e,r)&&i.addTest(r,e[r]);else{e=e.toLowerCase();if(i[e]!==n)return i;t=typeof t=="function"?t():t,typeof s!="undefined"&&s&&(o.className+=" "+(t?"":"no-")+e),i[e]=t}return i},N(""),a=l=null,i._version=r,i._prefixes=h,i._domPrefixes=v,i._cssomPrefixes=d,i.testProp=function(e){return A([e])},i.testAllProps=M,i.testStyles=S,i.prefixed=function(e,t,n){return t?M(e,t,n):M(e,"pfx")},o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+b.join(" "):""),i}(this,this.document),e.Modernizr=Modernizr}.apply(e,arguments)})}(this),function(e,t){if(typeof define=="function"&&define.amd)define("marionette",["backbone","underscore"],function(n,r){return e.Marionette=e.Mn=t(e,n,r)});else if(typeof exports!="undefined"){var n=require("backbone"),r=require("underscore");module.exports=t(e,n,r)}else e.Marionette=e.Mn=t(e,e.Backbone,e._)}(this,function(e,t,n){(function(e,t){var n=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;return this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){if(e===n)return delete this._indexByCustom[t],!0},this),delete this._views[n],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(r){t.isFunction(r[e])&&r[e].apply(r,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(r,function(e){n.prototype[e]=function(){var n=t.values(this._views),r=[n].concat(t.toArray(arguments));return t[e].apply(t,r)}}),n}(e,t),e.ChildViewContainer.VERSION="0.1.11",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=n,this},e.ChildViewContainer})(t,n),function(e,t){var n=e.Wreqr,r=e.Wreqr={};return e.Wreqr.VERSION="1.3.6",e.Wreqr.noConflict=function(){return e.Wreqr=n,this},r.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var r=null;t.isObject(e)&&!t.isFunction(e)&&(r=e.context,e=e.callback),this.setHandler(n,e,r)},this)},setHandler:function(e,t,n){var r={callback:t,context:n};this._wreqrHandlers[e]=r,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(!t)return;return function(){return t.callback.apply(t.context,arguments)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,t),r.CommandStorage=function(){var n=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(n.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),n}(),r.Commands=function(e,t){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),e.Handlers.prototype.constructor.apply(this,arguments)},execute:function(e){e=arguments[0];var n=t.rest(arguments);this.hasHandler(e)?this.getHandler(e).apply(this,n):this.storage.addCommand(e,n)},_executeCommands:function(e,n,r){var i=this.storage.getCommands(e);t.each(i.instances,function(e){n.apply(r,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var n,r=e.storageType||this.storageType;t.isFunction(r)?n=new r:n=r,this.storage=n}})}(r,t),r.RequestResponse=function(e,t){return e.Handlers.extend({request:function(e){if(this.hasHandler(e))return this.getHandler(e).apply(this,t.rest(arguments))}})}(r,t),r.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,t),r.Channel=function(n){var r=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(r.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,n,r){if(!n)return;r=r||this;var i=e==="vent"?"on":"setHandler";t.each(n,function(n,s){this[e][i](s,t.bind(n,r))},this)}}),r}(r),r.radio=function(e,t){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(n.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var n=this._channels[t];return n||(n=new e.Channel(t),this._channels[t]=n),n},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(r[e],function(t){this[e][t]=i(this,e,t)},this)},this)}});var r={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},i=function(e,n,r){return function(i){var s=e._getChannel(i)[n];return s[r].apply(s,t.rest(arguments))}};return new n}(r,t),e.Wreqr}(t,n);var r=e.Marionette,i=e.Mn,s=t.Marionette={};s.VERSION="2.4.7",s.noConflict=function(){return e.Marionette=r,e.Mn=i,this},t.Marionette=s,s.Deferred=t.$.Deferred,s.extend=t.Model.extend,s.isNodeAttached=function(e){return t.$.contains(document.documentElement,e)},s.mergeOptions=function(e,t){if(!e)return;n.extend(this,n.pick(e,t))},s.getOption=function(e,t){if(!e||!t)return;return e.options&&e.options[t]!==undefined?e.options[t]:e[t]},s.proxyGetOption=function(e){return s.getOption(this,e)},s._getValue=function(e,t,r){return n.isFunction(e)&&(e=r?e.apply(t,r):e.call(t)),e},s.normalizeMethods=function(e){return n.reduce(e,function(e,t,r){return n.isFunction(t)||(t=this[t]),t&&(e[r]=t),e},{},this)},s.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(e){return t[e.slice(4)]})},s.normalizeUIKeys=function(e,t){return n.reduce(e,function(e,n,r){var i=s.normalizeUIString(r,t);return e[i]=n,e},{})},s.normalizeUIValues=function(e,t,r){return n.each(e,function(i,o){n.isString(i)?e[o]=s.normalizeUIString(i,t):n.isObject(i)&&n.isArray(r)&&(n.extend(i,s.normalizeUIValues(n.pick(i,r),t)),n.each(r,function(e){var r=i[e];n.isString(r)&&(i[e]=s.normalizeUIString(r,t))}))}),e},s.actAsCollection=function(e,t){var r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];n.each(r,function(r){e[r]=function(){var e=n.values(n.result(this,t)),i=[e].concat(n.toArray(arguments));return n[r].apply(n,i)}})};var o=s.deprecate=function(e,t){n.isObject(e)&&(e=e.prev+" is going to be removed in the future. "+"Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),(t===undefined||!t)&&!o._cache[e]&&(o._warn("Deprecation warning: "+e),o._cache[e]=!0)};o._console=typeof console!="undefined"?console:{},o._warn=function(){var e=o._console.warn||o._console.log||function(){};return e.apply(o._console,arguments)},o._cache={},s._triggerMethod=function(){function t(e,t,n){return n.toUpperCase()}var e=/(^|:)(\w)/gi;return function(r,i,s){var o=arguments.length<3;o&&(s=i,i=s[0]);var u="on"+i.replace(e,t),a=r[u],f;return n.isFunction(a)&&(f=a.apply(r,o?n.rest(s):s)),n.isFunction(r.trigger)&&(o+s.length>1?r.trigger.apply(r,o?s:[i].concat(n.drop(s,0))):r.trigger(i)),f}}(),s.triggerMethod=function(e){return s._triggerMethod(this,arguments)},s.triggerMethodOn=function(e){var t=n.isFunction(e.triggerMethod)?e.triggerMethod:s.triggerMethod;return t.apply(e,n.rest(arguments))},s.MonitorDOMRefresh=function(e){function t(){e._isShown=!0,r()}function n(){e._isRendered=!0,r()}function r(){e._isShown&&e._isRendered&&s.isNodeAttached(e.el)&&s.triggerMethodOn(e,"dom:refresh",e)}if(e._isDomRefreshMonitored)return;e._isDomRefreshMonitored=!0,e.on({show:t,render:n})},function(e){function t(t,r,i,s){var o=s.split(/\s+/);n.each(o,function(n){var s=t[n];if(!s)throw new e.Error('Method "'+n+'" was configured as an event handler, but does not exist.');t.listenTo(r,i,s)})}function r(e,t,n,r){e.listenTo(t,n,r)}function i(e,t,r,i){var s=i.split(/\s+/);n.each(s,function(n){var i=e[n];e.stopListening(t,r,i)})}function s(e,t,n,r){e.stopListening(t,n,r)}function o(t,r,i,s,o){if(!r||!i)return;if(!n.isObject(i))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});i=e._getValue(i,t),n.each(i,function(e,i){n.isFunction(e)?s(t,r,i,e):o(t,r,i,e)})}e.bindEntityEvents=function(e,n,i){o(e,n,i,r,t)},e.unbindEntityEvents=function(e,t,n){o(e,t,n,s,i)},e.proxyBindEntityEvents=function(t,n){return e.bindEntityEvents(this,t,n)},e.proxyUnbindEntityEvents=function(t,n){return e.unbindEntityEvents(this,t,n)}}(s);var u=["description","fileName","lineNumber","name","message","number"];return s.Error=s.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+s.VERSION+"/",constructor:function(e,t){n.isObject(e)?(t=e,e=t.message):t||(t={});var r=Error.call(this,e);n.extend(this,n.pick(r,u),n.pick(t,u)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,s.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),s.Error.extend=s.extend,s.Callbacks=function(){this._deferred=s.Deferred(),this._callbacks=[]},n.extend(s.Callbacks.prototype,{add:function(e,t){var r=n.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),r.then(function(n){t&&(n.context=t),e.call(n.context,n.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=s.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),s.Controller=function(e){this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},s.Controller.extend=s.extend,n.extend(s.Controller.prototype,t.Events,{destroy:function(){return s._triggerMethod(this,"before:destroy",arguments),s._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:s.triggerMethod,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption}),s.Object=function(e){this.options=n.extend({},n.result(this,"options"),e),this.initialize.apply(this,arguments)},s.Object.extend=s.extend,n.extend(s.Object.prototype,t.Events,{initialize:function(){},destroy:function(e){return e=e||{},this.triggerMethod("before:destroy",e),this.triggerMethod("destroy",e),this.stopListening(),this},triggerMethod:s.triggerMethod,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.Region=s.Object.extend({constructor:function(e){this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el;if(!this.el)throw new s.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),s.Object.call(this,e)},show:function(e,t){if(!this._ensureElement())return;this._ensureViewIsIntact(e),s.MonitorDOMRefresh(e);var r=t||{},i=e!==this.currentView,o=!!r.preventDestroy,u=!!r.forceShow,a=!!this.currentView,f=i&&!o,l=i||u;a&&this.triggerMethod("before:swapOut",this.currentView,this,t),this.currentView&&i&&delete this.currentView._parent,f?this.empty():a&&l&&this.currentView.off("destroy",this.empty,this);if(l){e.once("destroy",this.empty,this),e._parent=this,this._renderView(e),a&&this.triggerMethod("before:swap",e,this,t),this.triggerMethod("before:show",e,this,t),s.triggerMethodOn(e,"before:show",e,this,t),a&&this.triggerMethod("swapOut",this.currentView,this,t);var c=s.isNodeAttached(this.el),h=[],p=n.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},r);return c&&p.triggerBeforeAttach&&(h=this._displayedViews(e),this._triggerAttach(h,"before:")),this.attachHtml(e),this.currentView=e,c&&p.triggerAttach&&(h=this._displayedViews(e),this._triggerAttach(h)),a&&this.triggerMethod("swap",e,this,t),this.triggerMethod("show",e,this,t),s.triggerMethodOn(e,"show",e,this,t),this}return this},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(e,t){var r=(t||"")+"attach";n.each(e,function(e){s.triggerMethodOn(e,r,e,this)},this)},_displayedViews:function(e){return n.union([e],n.result(e,"_getNestedViews")||[])},_renderView:function(e){e.supportsRenderLifecycle||s.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||s.triggerMethodOn(e,"render",e)},_ensureElement:function(){n.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]);if(!this.$el||this.$el.length===0){if(this.getOption("allowMissingEl"))return!1;throw new s.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(e){if(!e)throw new s.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e.isDestroyed)throw new s.Error({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(e){return t.$(e,s._getValue(this.options.parentEl,this))},attachHtml:function(e){this.$el.contents().detach(),this.el.appendChild(e.el)},empty:function(e){var t=this.currentView,n=e||{},r=!!n.preventDestroy;return t?(t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),r||this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,r&&this.$el.contents().detach(),this):this},_destroyView:function(){var e=this.currentView;if(e.isDestroyed)return;e.supportsDestroyLifecycle||s.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():(e.remove(),e.isDestroyed=!0),e.supportsDestroyLifecycle||s.triggerMethodOn(e,"destroy",e)},attachView:function(e){return this.currentView&&delete this.currentView._parent,e._parent=this,this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(e,t){if(n.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(n.isFunction(e))return this._buildRegionFromRegionClass(e);throw new s.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,t){var r=e.regionClass||t,i=n.omit(e,"selector","regionClass");return e.selector&&!i.el&&(i.el=e.selector),new r(i)},_buildRegionFromRegionClass:function(e){return new e}}),s.RegionManager=s.Controller.extend({constructor:function(e){this._regions={},this.length=0,s.Controller.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(e,t){return e=s._getValue(e,this,arguments),n.reduce(e,function(e,r,i){return n.isString(r)&&(r={selector:r}),r.selector&&(r=n.defaults({},r,t)),e[i]=this.addRegion(i,r),e},{},this)},addRegion:function(e,t){var n;return t instanceof s.Region?n=t:n=s.Region.buildRegion(t,s.Region),this.triggerMethod("before:add:region",e,n),n._parent=this,this._store(e,n),this.triggerMethod("add:region",e,n),n},get:function(e){return this._regions[e]},getRegions:function(){return n.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return n.each(this._regions,function(e,t){this._remove(t,e)},this),e},emptyRegions:function(){var e=this.getRegions();return n.invoke(e,"empty"),e},destroy:function(){return this.removeRegions(),s.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}}),s.actAsCollection(s.RegionManager.prototype,"_regions"),s.TemplateCache=function(e){this.templateId=e},n.extend(s.TemplateCache,{templateCaches:{},get:function(e,t){var n=this.templateCaches[e];return n||(n=new s.TemplateCache(e),this.templateCaches[e]=n),n.load(t)},clear:function(){var e,t=n.toArray(arguments),r=t.length;if(r>0)for(e=0;e<r;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(s.TemplateCache.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e,n){var r=t.$(e);if(!r.length)throw new s.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return r.html()},compileTemplate:function(e,t){return n.template(e,t)}}),s.Renderer={render:function(e,t){if(!e)throw new s.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var r=n.isFunction(e)?e:s.TemplateCache.get(e);return r(t)}},s.View=t.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(e){this.render=n.bind(this.render,this),e=s._getValue(e,this),this.options=n.extend({},n.result(this,"options"),e),this._behaviors=s.Behaviors(this),t.View.call(this,this.options),s.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,n.rest(arguments))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return t=s._getValue(t,this),n.extend(e,t)},normalizeUIKeys:function(e){var t=n.result(this,"_uiBindings");return s.normalizeUIKeys(e,t||n.result(this,"ui"))},normalizeUIValues:function(e,t){var r=n.result(this,"ui"),i=n.result(this,"_uiBindings");return s.normalizeUIValues(e,i||r,t)},configureTriggers:function(){if(!this.triggers)return;var e=this.normalizeUIKeys(n.result(this,"triggers"));return n.reduce(e,function(e,t,n){return e[n]=this._buildViewTrigger(t),e},{},this)},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(e){var r=s._getValue(e||this.events,this);r=this.normalizeUIKeys(r),n.isUndefined(e)&&(this.events=r);var i={},o=n.result(this,"behaviorEvents")||{},u=this.configureTriggers(),a=n.result(this,"behaviorTriggers")||{};n.extend(i,o,r,u,a),t.View.prototype.delegateEvents.call(this,i)},undelegateEvents:function(){return t.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new s.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var e=n.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.isRendered=!1,this.remove(),n.invoke(this._behaviors,"destroy",e),this},bindUIElements:function(){this._bindUIElements(),n.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(!this.ui)return;this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(e,function(e,t){this.ui[t]=this.$(e)},this)},unbindUIElements:function(){this._unbindUIElements(),n.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){if(!this.ui||!this._uiBindings)return;n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings},_buildViewTrigger:function(e){var t=n.defaults({},e,{preventDefault:!0,stopPropagation:!0}),r=n.isObject(e)?t.event:e;return function(e){e&&(e.preventDefault&&t.preventDefault&&e.preventDefault(),e.stopPropagation&&t.stopPropagation&&e.stopPropagation());var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(r,n)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return n.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=s._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],n.rest(arguments)),e},_triggerEventOnBehaviors:function(e){var t=s._triggerMethod,n=this._behaviors;for(var r=0,i=n&&n.length;r<i;r++)t(n[r],e)},_triggerEventOnParentLayout:function(e,t){var r=this._parentLayoutView();if(!r)return;var i=s.getOption(r,"childViewEventPrefix"),o=i+":"+e,u=[this].concat(t);s._triggerMethod(r,o,u);var a=s.getOption(r,"childEvents");a=s._getValue(a,r);var f=r.normalizeMethods(a);f&&n.isFunction(f[e])&&f[e].apply(r,u)},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var e=this._getImmediateChildren();return e.length?n.reduce(e,function(e,t){return t._getNestedViews?e.concat(t._getNestedViews()):e},e):e},_parentLayoutView:function(){var e=this._parent;while(e){if(e instanceof s.LayoutView)return e;e=e._parent}},normalizeMethods:s.normalizeMethods,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.ItemView=s.View.extend({constructor:function(){s.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var e=[this.model||this.collection];return arguments.length&&e.push.apply(e,arguments),this.model?this.serializeModel.apply(this,e):{items:this.serializeCollection.apply(this,e)}},serializeCollection:function(e){return e.toJSON.apply(e,n.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(e===!1)return;if(!e)throw new s.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.mixinTemplateHelpers(this.serializeData()),n=s.Renderer.render(e,t,this);return this.attachElContent(n),this},attachElContent:function(e){return this.$el.html(e),this}}),s.CollectionView=s.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(e){this.once("render",this._initialEvents),this._initChildViewStorage(),s.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var e=this._isShown&&s.isNodeAttached(this.el),t;this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),e&&this._triggerBeforeAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),e&&this._triggerAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(e,t,r){var i=n.drop(arguments,3);n.each(e,function(e){s.triggerMethodOn.apply(e,[e,r,e,t].concat(i))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,t,r){var i=r.at!==undefined&&(r.index||t.indexOf(e));if(this.getOption("filter")||i===!1)i=n.indexOf(this._filteredSortedModels(i),e);if(this._shouldAddChild(e,i)){this.destroyEmptyView();var s=this.getChildView(e);this.addChild(e,s,i)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each(function(e){s.triggerMethodOn(e,"before:show",e)})},_onShowCalled:function(){this.children.each(function(e){s.triggerMethodOn(e,"show",e)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var e=this.children,t=this._filteredSortedModels();if(!t.length&&this._showingEmptyView)return this;var r=n.some(t,function(t){return!e.findByModel(t)});if(r)this.render();else{var i=n.map(t,function(t,n){var r=e.findByModel(t);return r._index=n,r.el}),s=e.filter(function(e){return!n.contains(i,e.el)});this.triggerMethod("before:reorder"),this._appendReorderedChildren(i),n.each(s,this.removeChildView,this),this.checkEmpty(),this.triggerMethod("reorder")}},resortView:function(){s.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var e=this._filteredSortedModels(),t=n.find(e,function(e,t){var n=this.children.findByModel(e);return!n||n._index!==t},this);t&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var e,t=this._filteredSortedModels();n.each(t,function(t,n){e=this.getChildView(t),this.addChild(t,e,n)},this)},_filteredSortedModels:function(e){var t=this.getViewComparator(),r=this.collection.models;e=Math.min(Math.max(e,0),r.length-1);if(t){var i;e&&(i=r[e],r=r.slice(0,e).concat(r.slice(e+1))),r=this._sortModelsBy(r,t),i&&r.splice(e,0,i)}return this.getOption("filter")&&(r=n.filter(r,function(e,t){return this._shouldAddChild(e,t)},this)),r},_sortModelsBy:function(e,t){return typeof t=="string"?n.sortBy(e,function(e){return e.get(t)},this):t.length===1?n.sortBy(e,t,this):e.sort(n.bind(t,this))},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var n=new t.Model;this.addEmptyView(n,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var r=this._isShown&&!this.isBuffering&&s.isNodeAttached(this.el),i,o=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");n.isFunction(o)&&(o=o.call(this,e,this._emptyViewIndex));var u=this.buildChildView(e,t,o);u._parent=this,this.proxyChildEvents(u),u.once("render",function(){this._isShown&&s.triggerMethodOn(u,"before:show",u),r&&this._triggerBeforeAttach&&(i=this._getViewAndNested(u),this._triggerMethodMany(i,this,"before:attach"))},this),this.children.add(u),this.renderChildView(u,this._emptyViewIndex),r&&this._triggerAttach&&(i=this._getViewAndNested(u),this._triggerMethodMany(i,this,"attach")),this._isShown&&s.triggerMethodOn(u,"show",u)},getChildView:function(e){var t=this.getOption("childView");if(!t)throw new s.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(e,t,n){var r=this.getOption("childViewOptions");r=s._getValue(r,this,[e,n]);var i=this.buildChildView(e,t,r);return this._updateIndices(i,!0,n),this.triggerMethod("before:add:child",i),this._addChildView(i,n),this.triggerMethod("add:child",i),i._parent=this,i},_updateIndices:function(e,t,n){if(!this.getOption("sort"))return;t&&(e._index=n),this.children.each(function(n){n._index>=e._index&&(n._index+=t?1:-1)})},_addChildView:function(e,t){var n=this._isShown&&!this.isBuffering&&s.isNodeAttached(this.el),r;this.proxyChildEvents(e),e.once("render",function(){this._isShown&&!this.isBuffering&&s.triggerMethodOn(e,"before:show",e),n&&this._triggerBeforeAttach&&(r=this._getViewAndNested(e),this._triggerMethodMany(r,this,"before:attach"))},this),this.children.add(e),this.renderChildView(e,t),n&&this._triggerAttach&&(r=this._getViewAndNested(e),this._triggerMethodMany(r,this,"attach")),this._isShown&&!this.isBuffering&&s.triggerMethodOn(e,"show",e)},renderChildView:function(e,t){return e.supportsRenderLifecycle||s.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||s.triggerMethodOn(e,"render",e),this.attachHtml(this,e,t),e},buildChildView:function(e,t,r){var i=n.extend({model:e},r),o=new t(i);return s.MonitorDOMRefresh(o),o},removeChildView:function(e){return e?(this.triggerMethod("before:remove:child",e),e.supportsDestroyLifecycle||s.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():e.remove(),e.supportsDestroyLifecycle||s.triggerMethodOn(e,"destroy",e),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1),e):e},isEmpty:function(){return!this.collection||this.collection.length===0},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},_createBuffer:function(){var e=document.createDocumentFragment();return n.each(this._bufferedChildren,function(t){e.appendChild(t.el)}),e},attachHtml:function(e,t,n){e.isBuffering?e._bufferedChildren.splice(n,0,t):e._insertBefore(t,n)||e._insertAfter(t)},_insertBefore:function(e,t){var n,r=this.getOption("sort")&&t<this.children.length-1;return r&&(n=this.children.find(function(e){return e._index===t+1})),n?(n.$el.before(e.el),!0):!1},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),s.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(e){var t=e||{},r=!0,i=this.children.map(n.identity);return n.isUndefined(t.checkEmpty)||(r=t.checkEmpty),this.children.each(this.removeChildView,this),r&&this.checkEmpty(),i},_shouldAddChild:function(e,t){var r=this.getOption("filter");return!n.isFunction(r)||r.call(this,e,t,this.collection)},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(){var r=n.toArray(arguments),i=r[0],s=this.normalizeMethods(n.result(this,"childEvents"));r[0]=t+":"+i,r.splice(1,0,e),typeof s!="undefined"&&n.isFunction(s[i])&&s[i].apply(this,r.slice(1)),this.triggerMethod.apply(this,r)})},_getImmediateChildren:function(){return n.values(this.children._views)},_getViewAndNested:function(e){return[e].concat(n.result(e,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}}),s.CompositeView=s.CollectionView.extend({constructor:function(){s.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(e){var t=this.getOption("childView")||this.constructor;return t},serializeData:function(){var e={};return this.model&&(e=n.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&s.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),n=s.Renderer.render(t,e,this);this.attachElContent(n),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e,t){var n=this.getChildViewContainer(e);n.append(t)},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);t.append(e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);t.append(e)},getChildViewContainer:function(e,t){if(!e.$childViewContainer){var n,r=s.getOption(e,"childViewContainer");if(r){var i=s._getValue(r,e);i.charAt(0)==="@"&&e.ui?n=e.ui[i.substr(4)]:n=e.$(i);if(n.length<=0)throw new s.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else n=e.$el;return e.$childViewContainer=n,n}return e.$childViewContainer},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=undefined)}}),s.LayoutView=s.ItemView.extend({regionClass:s.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),s.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),s.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),s.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(e,t,r){var i=this.getRegion(e);return i.show.apply(i,n.rest(arguments))},getChildView:function(e){return this.getRegion(e).currentView},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t={regionClass:this.getOption("regionClass"),parentEl:n.partial(n.result,this,"el")};return this.regionManager.addRegions(e,t)},_initializeRegions:function(e){var t;this._initRegionManager(),t=s._getValue(this.regions,this,[e])||{};var r=this.getOption.call(e,"regions");r=s._getValue(r,this,[e]),n.extend(t,r),t=this.normalizeUIValues(t,["selector","el"]),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new s.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this.regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this.regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this.regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})},_getImmediateChildren:function(){return n.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),s.Behavior=s.Object.extend({constructor:function(e,t){this.view=t,this.defaults=n.result(this,"defaults")||{},this.options=n.extend({},this.defaults,e),this.ui=n.extend({},n.result(t,"ui"),n.result(this,"ui")),s.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el}}),s.Behaviors=function(e,t){function r(e,n){return t.isObject(e.behaviors)?(n=r.parseBehaviors(e,n||t.result(e,"behaviors")),r.wrap(e,n,t.keys(i)),n):{}}function s(e,t){this._view=e,this._behaviors=t,this._triggers={}}function o(e){return e._uiBindings||e.ui}var n=/^(\S+)\s*(.*)$/,i={behaviorTriggers:function(e,t){var n=new s(this,t);return n.buildBehaviorTriggers()},behaviorEvents:function(r,i){var s={};return t.each(i,function(r,i){var u={},a=t.clone(t.result(r,"events"))||{};a=e.normalizeUIKeys(a,o(r));var f=0;t.each(a,function(e,s){var o=s.match(n),a=o[1]+"."+[this.cid,i,f++," "].join(""),l=o[2],c=a+l,h=t.isFunction(e)?e:r[e];if(!h)return;u[c]=t.bind(h,r)},this),s=t.extend(s,u)},this),s}};return t.extend(r,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,n){return t.behaviorClass?t.behaviorClass:e._getValue(r.behaviorsLookup,this,[t,n])[n]},parseBehaviors:function(e,n){return t.chain(n).map(function(n,i){var s=r.getBehaviorClass(n,i),o=new s(n,e),u=r.parseBehaviors(e,t.result(o,"behaviors"));return[o].concat(u)}).flatten().value()},wrap:function(e,n,r){t.each(r,function(r){e[r]=t.partial(i[r],e[r],n)})}}),t.extend(s.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(n,r){var i=t.clone(t.result(n,"triggers"))||{};i=e.normalizeUIKeys(i,o(n)),t.each(i,t.bind(this._setHandlerForBehavior,this,n,r))},_setHandlerForBehavior:function(e,t,n,r){var i=r.replace(/^\S+/,function(e){return e+"."+"behaviortriggers"+t});this._triggers[i]=this._view._buildViewTrigger(n)}}),r}(s,n),s.AppRouter=t.Router.extend({constructor:function(e){this.options=e||{},t.Router.apply(this,arguments);var n=this.getOption("appRoutes"),r=this._getController();this.processAppRoutes(r,n),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},_processOnRoute:function(e,t){if(n.isFunction(this.onRoute)){var r=n.invert(this.getOption("appRoutes"))[e];this.onRoute(e,r,t)}},processAppRoutes:function(e,t){if(!t)return;var r=n.keys(t).reverse();n.each(r,function(n){this._addAppRoute(e,n,t[n])},this)},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,r){var i=e[r];if(!i)throw new s.Error('Method "'+r+'" was not found on the controller');this.route(t,r,n.bind(i,e))},mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,triggerMethod:s.triggerMethod,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.Application=s.Object.extend({constructor:function(e){this._initializeRegions(e),this._initCallbacks=new s.Callbacks,this.submodules={},n.extend(this,e),this._initChannel(),s.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var r=s.Module.getClass(t),i=n.toArray(arguments);return i.unshift(this),r.create.apply(r,i)},getRegionManager:function(){return new s.RegionManager},_initializeRegions:function(e){var t=n.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var r=s.getOption(e,"regions");return n.isFunction(r)&&(r=r.call(this,e)),n.extend(t,r),this.addRegions(t),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){s._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,s._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){s._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(e){delete this[e],s._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=n.result(this,"channelName")||"global",this.channel=n.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=n.result(this,"vent")||this.channel.vent,this.commands=n.result(this,"commands")||this.channel.commands,this.reqres=n.result(this,"reqres")||this.channel.reqres}}),s.Module=function(e,t,r){this.moduleName=e,this.options=n.extend({},this.options,r),this.initialize=r.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,n.isFunction(this.initialize)&&this.initialize(e,t,this.options)},s.Module.extend=s.extend,n.extend(s.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){if(this._isInitialized)return;n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e)},stop:function(){if(!this._isInitialized)return;this._isInitialized=!1,this.triggerMethod("before:stop"),n.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(undefined,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop")},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,r){if(!e)return;var i=n.flatten([this,this.app,t,s,t.$,n,r]);e.apply(this,i)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new s.Callbacks,this._finalizerCallbacks=new s.Callbacks},triggerMethod:s.triggerMethod}),n.extend(s.Module,{create:function(e,t,r){var i=e,s=n.drop(arguments,3);t=t.split(".");var o=t.length,u=[];return u[o-1]=r,n.each(t,function(t,n){var o=i;i=this._getModule(o,t,e,r),this._addModuleDefinition(o,i,u[n],s)},this),i},_getModule:function(e,t,r,i,s){var o=n.extend({},i),u=this.getClass(i),a=e[t];return a||(a=new u(t,r,o),e[t]=a,e.submodules[t]=a),a},getClass:function(e){var t=s.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,n,r){var i=this._getDefine(n),s=this._getStartWithParent(n,t);i&&t.addDefinition(i,r),this._addStartWithParent(e,t,s)},_getStartWithParent:function(e,t){var r;return n.isFunction(e)&&e.prototype instanceof s.Module?(r=t.constructor.prototype.startWithParent,n.isUndefined(r)?!0:r):n.isObject(e)?(r=e.startWithParent,n.isUndefined(r)?!0:r):!0},_getDefine:function(e){return!n.isFunction(e)||e.prototype instanceof s.Module?n.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,n){t.startWithParent=t.startWithParent&&n;if(!t.startWithParent||!!t.startWithParentIsConfigured)return;t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)})}}),s}),define("userParams",["underscore","jquery","accountInfo"],function(e,t,n){var r=function(){};r.prototype={getItem:function(e){},setItem:function(e,t){},convertToString:function(t){if(t){if(e.isDate(t))return t.getTime()+"";if(e.isBoolean(t)||e.isNumber(t))return t+""}else t===undefined&&(t=null);return t},convertFromString:function(e,t){if(e){if(t===null||t==="")return null;if(e===Boolean)return t==="true"||t==="True";if(e===Number){var n=Number(t);return isNaN(n)?null:n}if(e===Date){var n=Number(t);return isNaN(n)?null:new Date(n)}}return t}};var i=function(e){this.store={},r.apply(this,arguments)};i.prototype=t.extend(new r,{reset:function(){this.store={}},getItem:function(e,n){var r,i=t.Deferred();return this.store.hasOwnProperty(e)?(r=this.store[e],n&&(!r||r&&r.constructor&&r.constructor!==n)&&(r=this.convertFromString(n,r===null?null:r+"")),i.resolve(r)):i.reject(),i.promise()},setItem:function(e,n){var r=t.Deferred();return this.store[e]=n,r.resolve(),r.promise()}});var s=function(e){this.storage=e.storage||window.sessionStorage,this.storageKey=e.storageKey;if(!this.storage||!this.storage.getItem||!this.storage.setItem||!this.storage.removeItem)this.disabled=!0;this.loadFromStorage(),r.apply(this,arguments)};s.prototype=t.extend(new r,{reset:function(){this.data=undefined,this.storage&&this.storage.removeItem(this.storageKey)},loadFromStorage:function(){var e;try{e=t.parseJSON(this.storage.getItem(this.storageKey))}catch(n){try{this.storage.removeItem(this.storageKey)}catch(r){}}return this.data=e||{}},saveToStorage:function(e){this.data=e;var t=JSON.stringify(this.data||{});this.storage.setItem(this.storageKey,t)},serialize:function(e,t){return this.convertToString(t)},deserialize:function(e,t){return this.convertFromString(e,t)},getItem:function(e,n){var r=t.Deferred(),i,s;try{i=this.data||this.loadFromStorage(),s=!0}catch(o){s=!1}if(s)if(i.hasOwnProperty(e)){var u=this.deserialize(n,i[e]);r.resolve(u)}else r.reject();else r.reject();return r.promise()},setItem:function(e,n){var r=t.Deferred(),i=this.data||{},s;if(n===null)try{delete i[e]}catch(o){i[e]=null}else i[e]=this.serialize(e,n);try{this.saveToStorage(i),s=!0}catch(o){s=!1}return s?r.resolve():r.reject(),r.promise()}});var o=function(e){this.url=e.url,window.userCustomParamsReadOnly&&(this.disabled=!0),r.apply(this,arguments)};o.prototype=t.extend(new r,{serialize:function(e,t){return this.convertToString(t)},deserialize:function(e,t,n){if(t!==null)return this.convertFromString(e,t.value)},getItem:function(e,n){var r=this,i=t.Deferred();return t.ajax({method:"get",url:this.url,data:{name:e},success:function(t,s,o){var u=r.deserialize(n,t,e);u?i.resolve(u):i.reject()},error:function(e,t,n){i.reject()}}),i.promise()},setItem:function(e,n){var r=this,i=t.Deferred(),s=r.serialize(e,n);return t.ajax({method:"post",contentType:"application/json; charset=utf-8",dataType:"json",url:this.url,data:JSON.stringify({name:e,value:s===null?"":s}),success:function(e,t,n){i.resolve()},error:function(e,t,n){i.reject(t,n)}}),i.promise()}});var u=function(t,n){var r=this;this.proxies=e.filter(t,function(e){return!e.disabled}),this.options=n||{},this.options.tempStorageKey&&n.recoverInterruptions&&(this.tempStorage=window.sessionStorage,e.each(this._loadTempsObj(),function(e,t){t&&r.setItem.call(r,t,e,!0)}))};u.prototype={reset:function(){e.each(this.proxies,function(e){e.reset&&e.reset()})},_getItem:function(e,t,n,r,i){var s=this;i=i||{},r=r||[];var o=n.shift();o.getItem(e,t).then(function(t){i.ensureCache?s._setItem(e,t,r,undefined,{ignoreFailures:!0,success:function(){i.success&&i.success(t)}}):i.success&&i.success(t)},function(){r.push(o),n.length?s._getItem(e,t,n,r,i):i.error&&i.error()})},getItem:function(e,n){var r=t.Deferred();return this.proxies.length&&(!this.options.prerequisite||this.options.prerequisite(e))?this._getItem.call(this,e,n,this.proxies.slice(),[],{ensureCache:!0,success:function(e){r.resolve(e)},error:function(){r.reject()}}):r.reject(),r.promise()},_setItem:function(e,t,n,r,i){var s=this;i=i||{},r=r||[];if(!n.length){i.success&&i.success();return}var o=n.shift();o.setItem(e,t).then(function(){r.push(o),n.length?s._setItem(e,t,n,r,i):i.success&&i.success()},function(){i.ignoreFailures?(r.push(o),n.length?s._setItem(e,t,n,r,i):i.success&&i.success()):i.error&&i.error()})},_loadTempsObj:function(){var n;if(this.tempStorage){var r=this.options.tempStorageKey;try{n=t.parseJSON(this.tempStorage.getItem(r)),e.isEmpty(n)&&(n=undefined)}catch(i){}}return n},_saveTempsObj:function(t){if(this.tempStorage){var n=this.options.tempStorageKey;try{return e.isEmpty(t)?this.tempStorage.removeItem(n):this.tempStorage.setItem(n,JSON.stringify(t)),!0}catch(r){return!1}}},_removeTemp:function(e){var t=this._loadTempsObj()||{};try{delete t[e]}catch(n){t[e]=null}this._saveTempsObj(t)},setItem:function(e,n,r){var i=t.Deferred(),s=this;if(!this.options.prerequisite||this.options.prerequisite(e)){if(!r){var o=this._loadTempsObj()||{};o[e]=n,this._saveTempsObj(o)}this._setItem.call(this,e,n,this.proxies.slice(),[],{success:function(){s._removeTemp.call(s,e),i.resolve()},error:function(){r&&s._removeTemp.call(s,e),i.reject()}})}return i.promise()}};var a=new u([new i,new s({storageKey:"userParams",storage:window.sessionStorage}),new o({url:"/api/account/custom-param"})],{recoverInterruptions:!0,tempStorageKey:"userParams:queue",prerequisite:function(){return n.isLoggedIn()}});return n.on("logout login",e.bind(a.reset,a)),a}),define("app/helpers/tracking",["jquery","underscore","accountInfo","radio","app/helpers/env","formatters","generated/countries","subscription","userParams"],function($,_,accountInfo,radio,env,formatters,countries,subscription,userParams){var log=function(){if(env==="development"&&window.console){var paramsCount=arguments.length,i,args=[];for(i=0;i<paramsCount;i++)args.push("arguments["+i+"]");var fnName=console.info?"info":"log";eval("console."+fnName+"("+args.join(", ")+");")}},trackEvent=function(e,t,n){log("trackEvent",e,t,n);try{window.mixpanel&&mixpanel.track(e,t);if(window.ga){var r=e.split(" ");ga("send","event",r[0],r[1],n)}window.Intercom&&window.Intercom("trackEvent",e,t)}catch(i){log("trackEvent Error",i)}},trackPeople=function(e){log("trackPeople",e);try{window.mixpanel&&(mixpanel.identify(e.$username),mixpanel.people.set(e)),window.ga&&ga("set",{userId:e.$username,dimension1:e.$username,dimension2:accountInfo.get("plan")})}catch(t){log("trackPeople Error",t)}},trackConversion=function(e){window.google_trackConversion?window.google_trackConversion(e):$.getScript("https://www.googleadservices.com/pagead/conversion_async.js",function(){window.google_trackConversion&&window.google_trackConversion(e)})},_trackedSelectors={},trackLinks=function(e,t,n){if(window.mixpanel)try{mixpanel.track_links(e,t,n)}catch(r){log("trackLinks mixpanel Error",r)}_trackedSelectors.hasOwnProperty(e)?_trackedSelectors[e].push(t):(_trackedSelectors[e]=[t],window.ga&&$(document).on("click",e,function(){var t=$(this),n=t.is('button,[class~="btn"],input')?"button":"link",r=t.data("track")||"",i=t.attr("id")||"",s;_.each(_trackedSelectors[e],function(e){e=e||"";var o=e.replace("click ","").replace("{id}",i).replace("{track}",r);o||(o=s=t.text()),trackEvent(n+" click",{title:document.title,page:window.location.pathname+window.location.hash,className:t.attr("class"),id:i},o)})}))},translateCustomizedReportData=function(e){return{amount:e.amountValue||null,currency:e.currency||"USD",payer:e.payer,"item name":e.itemName,"technology name":e.technologyName,country:e.countryName||(e.byCountry?countries.byCode(e.byCountry).name:null),"country code":e.byCountry,"results limit":e.resultsLimit,"technology id":e.technologyId,"total results available":e.totalWebsites,"include visits":e.includeVisits}};return{init:function(){setTimeout(function(){trackLinks("a[data-track]","click {track} {id}",{referrer:document.referrer}),trackLinks("button[data-track]","click {track} {id}",{referrer:document.referrer}),trackLinks("label[data-track]","click {track} {id}",{referrer:document.referrer})},300),accountInfo.on("login",function(e,t){e.isNewUser&&(trackEvent("user register success",{username:e.username},e.username),trackConversion({google_conversion_id:971706859,google_conversion_language:"en",google_conversion_format:"3",google_conversion_color:"ffffff",google_conversion_label:"vevKCKnU0VsQ66OszwM",google_remarketing_only:!1})),trackEvent("user login",{username:e.username},e.username),trackPeople({$username:e.username,$email:e.email,$created:formatters.date.toIsoString(e.creationDate),$last_login:new Date}),t&&setTimeout(t.await(new $.Deferred).resolve,e.isNewUser?1300:100)}).on("logout",function(e,t){trackEvent("user logout",{username:e.username},e.username)}),radio.channel("subscriptionFlow").on("completeStep",function(e){trackEvent("subscribe-flow completeStep",{title:document.title,step:e.step},e.step)}).on("beginFlowStep",function(e){trackEvent("subscribe-flow beginStep",{title:document.title,step:e.step},e.step)}).on("conversion",function(e){trackConversion({google_conversion_id:971706859,google_conversion_language:"en",google_conversion_format:"3",google_conversion_color:"ffffff",google_conversion_label:"g2XXCOSKkVwQ66OszwM",google_conversion_value:e.cost,google_conversion_currency:e.currency,google_remarketing_only:!1})}).on("complete",function(e){trackEvent("subscribe-flow complete",{title:document.title,planName:e.planName,planCode:e.planCode},e.planName+" ("+e.planCode+")")}).on("redirectToUpgrade",function(e){trackEvent("subscribe-flow redirectToUpgrade",{title:document.title,planName:e.planName,planCode:e.planCode},e.planName+" ("+e.planCode+")")}).on("dialogShown",function(e){trackEvent("subscribe-flow openDialog",{title:document.title,planName:e.planName,planCode:e.planCode},e.planName+" ("+e.planCode+")")}),radio.channel("subscription").on("usageChange",function(e){if(window.intercomSettings&&window.Intercom){var t=subscription.quota(subscription.PERMISSIONS.technologyAlert),n=subscription.quota(subscription.PERMISSIONS.websiteAlert),r=subscription.quota(subscription.PERMISSIONS.technologyReport),i=subscription.quota(subscription.PERMISSIONS.emailIdentificationQuota);window.Intercom("update",{watchedTechnologies_current:t&&t.current,watchedTechnologies_limit:t&&t.limit,watchedWebsites_current:n&&n.current,watchedWebsites_limit:n&&n.limit,technologyReports_current:r&&r.current,technologyReports_limit:r&&r.limit,emailIdentification_current:i&&i.current,emailIdentification_limit:i&&i.limit})}});var e;radio.channel("dashboard").on("routeChange",function(t){var n=location.hash||"#";ga("send","pageview",location.pathname+n);if(window.intercomSettings&&window.Intercom){var r=window.location.hash.replace(/^#/,""),i=(t.name||"").split("_")[0]||"";i!==e&&(i&&window.Intercom("trackEvent","dashboard enter-section "+i),e=i),window.Intercom("trackEvent","dashboard enter-route "+t.name,{path:r})}}),radio.channel("websiteOverview").on("ready",function(e){trackEvent("page view",{title:document.title,website:e.site,url:window.location.pathname},e.site)}).on("share.click",function(e){trackEvent("click share-"+e.provider,{"share url":e.href,website:e.site},e.site)}).on("watch.click",function(e){trackEvent("click track-website-"+e.label,{website:e.site},e.site)}),radio.channel("technologyCategoryOverview").on("ready",function(e){trackEvent("page view",{title:document.title,category:e.name,url:window.location.pathname},e.name)}),radio.channel("technologyCategoryOverview").on("share.click",function(e){trackEvent("click share-"+e.provider,translateCustomizedReportData({"share url":e.href,category:e.name,"technology id":e.id}),e.name)}),radio.channel("websitesUsing").on("navigate",function(e){trackEvent("page view",{title:document.title,"technology name":e.name,url:window.location.pathname+window.location.hash},e.name)}),radio.channel("navigation").on("noResultsPage",function(e){window.ga&&ga("send","pageview","/errors/no-search-results/"+e.entityType+"/"+(e.query||""))}),radio.channel("masterSearch").on("searchedTerm",function(e,t,n){trackEvent("search searchPanel",{query:e,resultsCount:t})}).on("clicked-search",function(e){trackEvent("clicked-search "+e)}),radio.channel("reportsWizard").on("create",function(e){window.intercomSettings&&window.Intercom&&window.Intercom("update",{increments:{technologyReports_total:1}})}),radio.channel("technologyAlerts").on("create",function(e){var t=e&&e.toJSON?e.toJSON():{};trackEvent("create technology-alert",{id:t.id,enabled:t.enabled,emailNotifications:t.emailNotifications,"technology name":t.technology},t.technology)}).on("delete",function(e){var t=e&&e.toJSON?e.toJSON():{};trackEvent("delete technology-alert",{id:t.id,enabled:t.enabled,emailNotifications:t.emailNotifications,"technology name":t.technology},t.technology)}).on("update",function(e){var t=e&&e.toJSON?e.toJSON():{};trackEvent("update technology-alert",{id:t.id,enabled:t.enabled,emailNotifications:t.emailNotifications,"technology name":t.technology},t.technology)}),radio.channel("customReports").on("create",function(e){window.intercomSettings&&window.Intercom&&window.Intercom("update",{increments:{customReports_total:1}}),e&&trackEvent("create custom-report",{name:e.reportName,"list size":e.websitesList.count,"list id":e.websitesList.id,"list name":e.websitesList.name},e.websitesList.name)}),radio.channel("technologiesComparison").on("share.click",function(e){trackEvent("click share-"+e.provider,{"share url":e.href,"technology 1":e.technology1,"technology 2":e.technology2},e.name)}),radio.channel("technologyOverview").on("ready",function(e){trackEvent("page view",{title:document.title,"technology name":e.name,"technology id":e.id,url:window.location.pathname},e.name),trackLinks("a.btn-full-report","click getFullReport",{referrer:document.referrer})}).on("share.click",function(e){trackEvent("click share-"+e.provider,{"share url":e.href,"technology name":e.name,"technology id":e.id},e.name)}).on("getFullReport.click",function(e){trackEvent("click getFullReport",translateCustomizedReportData({"technology name":e.name,"technology id":e.id}),e.name)}).on("getFullReportRow.click",function(e){trackEvent("click getFullReportRow",translateCustomizedReportData({"technology name":e.name,"technology id":e.id}),e.name)}),radio.channel("purchaseReport").on("getReport.click",function(e){trackEvent("click getReport",translateCustomizedReportData(e.data),e.data["technology name"])}).on("requestReport",function(e){trackEvent("click getReport-success",translateCustomizedReportData(e.data),e.data["technology name"])}),radio.channel("pricingView").on("viewingPricing",function(){trackEvent("view pricing")}),radio.channel("homepage").on("viewingDemo",function(){trackEvent("view demo-video")}),radio.channel("sidepanel").on("opened",function(e,t){trackEvent("side-panel viewed "+e,t)}),radio.channel("account").on("reportPostPurchase",function(e){trackEvent("purchased report",translateCustomizedReportData(e),e["technology name"])}).on("loginViolationNotified",function(e){trackEvent("user notified-login-violation",{username:e.username},e.username)}).on("tryItFree",function(){trackEvent("nav-bar try-it-free")}),radio.channel("about-us").on("clicked",function(e){trackEvent("about-us clicked "+e)}),radio.channel("apiPricing").on("openRequestInfoDialog",function(){trackEvent("show request-api-info-form",{title:document.title,url:window.location.pathname})}).on("formSent",function(){trackEvent("submit request-api-info-form",{title:document.title,url:window.location.pathname})}),radio.channel("datagridPagesCell").on("clickViewPages",function(e){e=e||{},trackEvent("click datagrid-view-pages-button",{title:document.title,page:window.location.pathname+window.location.hash,site:e.domain||"",technologyId:e.technologyId||""})}),radio.channel("datagridBusinessInfoCell").on("clickViewContacts",function(e){e=e||{},trackEvent("click datagrid-view-contacts-button",{title:document.title,page:window.location.pathname+window.location.hash,site:e.domain||"",company:e.business||""})}).on("clickSearchEmployeesOnLinkedIn",function(e){e=e||{},trackEvent("click datagrid-search-employees-on-linkedin",{title:document.title,page:window.location.pathname+window.location.hash,site:e.domain||"",company:e.business||""})}),radio.channel("emailsDiscoveryService").on("start",function(){trackEvent("started email-discovery")});var t="extensions.prospecting.status",n=_.debounce(function(e){userParams.getItem(t,String).always(function(n){n!==e&&userParams.setItem(t,e),window.intercomSettings&&window.Intercom&&window.Intercom("update",{prospecting_extension_status:e})})},5e3);radio.channel("extensionCommunicator").on("detected",function(){n("installed")}).on("notInstalled",function(){n("notInstalled")}).on("platformNotSupported",function(){n("platformNotSupported")}),radio.channel("chromeExtensionBanner").on("show",function(){trackEvent("chrome-extension-promo show",{title:document.title,url:window.location.pathname})}).on("clickInstall",function(){trackEvent("chrome-extension-promo click-install",{title:document.title,url:window.location.pathname})}).on("installed",function(){trackEvent("chrome-extension-promo installed",{title:document.title,url:window.location.pathname})}).on("installCanceled",function(){trackEvent("chrome-extension-promo install-canceled",{title:document.title,url:window.location.pathname})}),radio.channel("tours").on("start",function(e){trackEvent("tour started",{tour:e,title:document.title,url:window.location.pathname})}).on("complete",function(e){trackEvent("tour completed",{tour:e,title:document.title,url:window.location.pathname})}).on("stepStarted",function(e,t){trackEvent("tour step-started",{tour:e,step:t,title:document.title,url:window.location.pathname})}),radio.channel("subscriptionCancellationRequest").on("reasonSet",function(e,t){trackEvent("cancel-subscription-reason-answer "+e,{reasonId:e,reasonText:t},t)});var r=function(e){return e?e.options&&_.isString(e.options.track)?e.options.track:e.constructor&&e.constructor.prototype&&_.isString(e.constructor.prototype.track)?e.constructor.prototype.track:undefined:undefined};radio.channel("ui.dialog").on("show:after",function(e){var t=r(e);t&&trackEvent("open-dialog "+t,{title:document.title,page:window.location.pathname+window.location.hash})})},trackEvent:trackEvent,trackConversion:trackConversion}}),define("app/helpers/trace",["jquery","underscore","radio","formatters","modernizr","app/helpers/env"],function(e,t,n,r,i,s){var o=25,u="/api/tr/evs",a="st_trc",f=new Date,l=[],c,h=0,p=0,d,v={},m=window.sessionStorage||{},g={start:f.getTime(),count:0,pages:0},y=t.throttle(function(){var e;if(window.JSON)try{e=JSON.stringify(g),m[a]=e}catch(t){}},400,{leading:!1}),b=function(e,t){g[e]=t,y()},w=function(){var e;if(window.JSON)try{var n=m[a];n&&(e=JSON.parse(n)),e&&t.isNumber(e.start)&&t.isNumber(e.count)&&t.isNumber(e.pages)||(e=null)}catch(r){}e?g=e:y()};w();var E=function(){if(d)return d;var e=window.navigator||{},t=function(){var t=e.userAgent,n,r=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(r[1]))return n=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(n[1]||"");if(r[1]==="Chrome"){n=t.match(/\b(OPR|Edge)\/(\d+)/);if(n!=null)return n.slice(1).join(" ").replace("OPR","Opera")}return r=r[2]?[r[1],r[2]]:[e.appName,e.appVersion,"-?"],(n=t.match(/version\/(\d+)/i))!=null&&r.splice(1,1,n[1]),r.join(" ")}();return d={browser_name:t,browser_cookieEnabled:e.cookieEnabled,browser_browserLanguage:e.language,browser_languages:e.languages.join(", "),browser_systemLanguage:e.systemLanguage,browser_doNotTrack:e.doNotTrack,browser_maxTouchPoints:e.maxTouchPoints||e.msMaxTouchPoints||i.touch}},S=function(e,n){var r=["timeInPage","timeInSession","eventsInPage","eventsInSession","time"],i=[],s=0,o,u,a,f,l=null,c=0,h,p=!0;while(p!==!1){if(!e.length||i.length>n)p=!1;o=e.shift()||{},u=t.omit(o.args,r),a&&f&&o.message===a.message&&o.level===a.level&&t.isEqual(f,u)?(l||(h=t.omit(o.args,r),t.each(r,function(e){h[e]=[a.args[e]]}),l={level:o.level,message:o.message,args:h},c=1),t.each(r,function(e){l.args[e].push(o.args[e])}),c++):l?(l.message+=" ("+c+" collapsed)",l.args.collapsed=c,t.each(r,function(e){var t=l.args[e];l.args[e]=t&&t.length?t[t.length-1]:undefined}),i.push(l),l=null,c=0):a&&i.push(a),a=o,f=u,s++}return{events:i,count:s-1}},x=t.throttle(function(){if(l.length&&!c&&p<o){c=!0;var t=S(l,o-p);e.ajax({url:u,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({events:t.events})}).always(function(){p+=t.count,c=!1,x()})}},3e3,{leading:!1}),T=function(){try{return window.self!==window.top}catch(e){return!0}},N=function(t,n){return function(i,o){if(i){o=o||{};var u=new Date,a=o.stack;if(n&&!a)try{a=(new Error).stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@")}catch(c){}try{h++,b("count",g.count+1);var p=e(window),d=e(document),v={level:t,message:i,args:e.extend({stack:a,location:location.href,time:u,timeInPage:r.date.msToTimeString(u-f),timeInSession:r.date.msToTimeString(u-g.start),eventsInPage:h,eventsInSession:g.count,pageViewsInSession:g.pages,screenWidth:(window.screen||{}).width,screenHeight:(window.screen||{}).height,windowWidth:p.width(),windowHeight:p.height(),documentWidth:d.width(),documentHeight:d.height(),isIframe:T()},E(),o)};l.push(v),x();if(s!=="production")try{t==="error"?console.error("trace",v,a):console.info("trace",v,a)}catch(c){}}catch(c){window.console&&window.console.error&&console.error("trace failed",c,i,o)}}}},C=N("error",!0),k=N("info",!1),L=function(e){v[e]=new Date},A=function(t,n){var i=v[t];if(i){var s=new Date-i;k(t+" took "+r.date.msToTimeString(s),e.extend({timerLabel:t,timerTime:r.date.msToTimeString(s),timerMs:s},n));try{delete v[t]}catch(o){v[t]=undefined}}},O=[".zopim.com/",".google.com/uds/api/visualization","ajax.googleapis.com/ajax/libs/webfont"],M=function(e){if(!e)return!1;var n=((e||"")+"").toLowerCase();return t.some(O,function(e){return~n.indexOf(e)})},_=window.onerror;window.onerror=function(t,n,r,i,s){_&&_.apply(this,arguments);var o="";s&&s.stack&&s.stack.toString&&(o=e.trim(s.stack.toString()));var u=s&&s.stReported;!u&&!M(n)&&!M(o)&&(t==="Script error."&&!n&&!r&&!i&&!o||C(t,{handler:"window.onerror",scriptFile:n,lineNumber:r,column:i,stack:o&&o.length>2?o:undefined}))};var D=function(e,t,n,r){return t._errTrace||(t._errTrace=function(){var i;try{i=t.apply(this,arguments)}catch(s){s&&(s.stReported=!0,C(s.message,{stack:s.stack,handler:e}));if(!n)throw s;return r}return i}),t._errTrace},P=function(e){t.each(e,function(e){var n=window[e];t.isFunction(n)&&(window[e]=D(e,n))})},H=n.channel("trace");H.on("error",C).on("info",k).on("time",L).on("timeEnd",A),b("pages",g.pages+1);var B=function(n,r,i){var s={stopPropagation:!1,defaultReturnValue:n},o=!1;i&&(t.isBoolean(i)?s.stopPropagation=i:t.isObject(s)&&e.extend(s,i)),t.each(r,function(e){n[e]=D(e,n[e],s.stopPropagation,s.defaultReturnValue)})};return{channel:H,time:L,timeEnd:A,error:C,info:k,hookInto:B}}),define("browserType",[],function(){var e=navigator.appVersion,t=navigator.userAgent,n=navigator.appName,r=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10),s,o,u;return(o=t.indexOf("OPR/"))!==-1?(n="Opera",r=t.substring(o+4)):(o=t.indexOf("Opera"))!==-1?(n="Opera",r=t.substring(o+6),(o=t.indexOf("Version"))!==-1&&(r=t.substring(o+8))):(o=t.indexOf("MSIE"))!==-1?(n="Microsoft Internet Explorer",r=t.substring(o+5)):(o=t.indexOf("Chrome"))!==-1?(n="Chrome",r=t.substring(o+7)):(o=t.indexOf("Safari"))!==-1?(n="Safari",r=t.substring(o+7),(o=t.indexOf("Version"))!==-1&&(r=t.substring(o+8))):(o=t.indexOf("Firefox"))!==-1?(n="Firefox",r=t.substring(o+8)):(s=t.lastIndexOf(" ")+1)<(o=t.lastIndexOf("/"))&&(n=t.substring(s,o),r=t.substring(o+1),n.toLowerCase()===n.toUpperCase()&&(n=navigator.appName)),(u=r.indexOf(";"))!==-1&&(r=r.substring(0,u)),(u=r.indexOf(" "))!==-1&&(r=r.substring(0,u)),i=parseInt(""+r,10),isNaN(i)&&(r=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),{name:n,fullVersion:r,majorVersion:i,appName:navigator.appName,userAgent:navigator.userAgent,isFireFox:"firefox".localeCompare((n||"").toLowerCase())===0,isChrome:"chrome".localeCompare((n||"").toLowerCase())===0}}),define("app/helpers/extensionCommunicator",["jquery","underscore","backbone","initialData","notifier","radio","accountInfo","browserType"],function(e,t,n,r,i,s,o,u){var a=!!window.chrome&&!!window.chrome.runtime&&u.isChrome,f=u.isFireFox,l=a||f,c=function(r,i){var u=this,c=0,h=0,p=0,d=0,v,m,g,y=e.extend({},i),b=function(){c=0,h=0,p=0,d=0,v=undefined,m=undefined,g=undefined},w=function(){if(m)return;if(c>0||p>0||v)m=!0,u.trigger("detect")},E=function(e,t,n){if(a)try{chrome&&chrome.runtime&&chrome.runtime.sendMessage(r,{type:e,params:t},function(e){e&&(p++,w()),n&&n(e)}),h++}catch(i){s.trigger("trace","error","Exception during chrome.runtime.sendMessage to prospecting extension: "+i.message,{stack:i.stack})}},S=function(){var t=e.Deferred();l||u.trigger("initialize:platformNotSupported");if(a)E("accountInfo",{accountInfo:o.toJSON()},function(e){e&&e.version?(u.trigger("initialize:installed"),t.resolve(e)):(t.reject(),u.trigger("initialize:notInstalled"))});else var n=10,r=setInterval(function(){n--;var i=e("input#9v8h928osibs28349s35azs").length>0;n<0&&!i?(t.reject(),u.trigger("initialize:notInstalled"),clearInterval(r)):i&&(u.trigger("initialize:installed"),t.resolve({version:"0.1",isInstalled:!0,browser:"Firefox"}),clearInterval(r))},100);var i=t.promise();return g=g||i,i},x=function(){a&&window.addEventListener("message",function(e){if(e.origin===window.location.origin){var t=e.data||{};if((t.source||{}).id===r){c++,w();if(t.type){var n=y[t.type];if(n)return n.call(u,t.params,t.source);console.log("unknown message type ("+t.type+")")}else console.log("message type specified")}}},!1)},T=function(t){if(a){var n=new Image,i=e(n),s=function(e){i.off(),v=e,w(),t&&t(e)};a?n.src="chrome-extension://"+r+"/images/pixel.gif"+"?_"+(new Date).getTime():n.src="moz-extension://"+r+"/images/icons/16.png"+"?_"+(new Date).getTime(),i.on("load",function(){s(!0)}),i.on("error",function(){s(!1)}),d++}else t&&t()};x(),e.extend(this,{extensionId:r,isChrome:a,isFireFox:f,isSupported:l,setHandlers:function(e){y=e||{}},getCounters:function(){return{incoming:c,outgoing:h,responses:p}},isInstalled:function(e){if(!a)return!1;m?e(!0):t.isBoolean(v)?e(v):T(function(t){e(t)})},hasDetected:function(){return a?m?!0:t.isBoolean(v)?v:undefined:!1},forceCheckInstalled:T,sendMessage:E,sendAccountInfo:S,initAccountInfo:function(){return g?g:S()}},n.Events)};return c}),define("app/helpers/extensionIntegration",["./extensionCommunicator","radio"],function(e,t){var n="jiabgmelnfhgjkfdaoiccfcbaedjfcnm",r="ba240349-9ad8-46ac-8a81-28153f9ee31a",i="baojbclikodjabmiajkpfldgdccicnhm",s=[n,i,r],o=document.getElementsByTagName("head"),u=o&&o.length&&o[0].getAttribute("data-prospecting-extension-id");u&&~s.indexOf(u)&&(console.info("Using custom build of Prospecting Chrome Extension ("+u+")"),n=u);var a=function(t,n){e.apply(this,arguments)};a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.prototype.init=function(){return this.initAccountInfo()};var f=new a(n,{addProspect:function(e,n){t.channel("prospects").trigger("created:external",e)},updateProspect:function(e,n){t.channel("prospects").trigger("updated:external",e)},installed:function(e,t){this.forceCheckInstalled(),console.log("extension installed",e,t)}}),l=t.channel("extensionCommunicator");return f.on("detect",function(){l.trigger("detected")}),f.on("initialize:notInstalled",function(){l.trigger("notInstalled")}),f.on("initialize:platformNotSupported",function(){l.trigger("platformNotSupported")}),f}),define("app/collections/promised",["underscore","backbone","jquery"],function(e,t,n){return t.Collection.extend({constructor:function(){t.Collection.prototype.constructor.apply(this,arguments),this.promisedConstructor.apply(this,arguments)},promisedConstructor:function(){var e=n.Deferred(),t=this,r=this.loadPromise=e.promise(),i=!this.length;this.fetched=i,this.initialLoad=function(){return i&&(i=!1,this.fetch()),r};if(this.length)e.resolve(this.models);else{var s=function(){i=!1,t.fetched=!0,e.resolve(t.models),u()},o=function(){i=!1,t.fetched=!0,e.reject(),u()},u=function(){t.off("sync",s),t.off("error",o)};this.on("sync",s),this.on("error",o)}}})}),define("app/collections/technologyCategoriesList",["underscore","jquery","backbone","formatters","./promised","app/helpers/urlFor"],function(e,t,n,r,i,s){return i.extend({model:n.Model.extend({idAttribute:"sysname",defaults:{parent:undefined,orderIndex:0,fullName:""},toJSON:function(){var t=e.clone(this.attributes);return this.attributes.parent&&!this.attributes.parent.attributes.parent&&(t.parent=this.attributes.parent.toJSON()),t}}),url:s.domain()+"/api/technologies/categories",getNamesDictionary:function(){if(!this._byName){var e=this._byName={};this.each(function(t){e[t.attributes.name]=t})}return this._byName},getByName:function(e){return this.getNamesDictionary()[e]},parse:function(t){var n=this.model,r={},i=e.map(t,function(e){return r[e.sysname]=new n(e)});return e.each(i,function(e){var t=e.attributes.parent,n=e.attributes.name;if(t){var i=r[t];e.set("parent",i),n=i.attributes.name+" > "+n}e.set("fullName",n)}),i}})}),define("app/instances/collections/technologyCategoriesList",["app/collections/technologyCategoriesList"],function(e){return new e}),define("app/models/technology",["underscore","backbone","formatters"],function(e,t,n){return t.Model.extend({parse:function(e){return e.fullCategory=e.parentCategory?e.parentCategory+" > "+e.category:e.category,e},idAttribute:"sysname",getFavicon:function(){return n.html.favicon(this.get("homepage"),this.get("logo"))},getOverviewUrl:function(){return n.url.technologyOverview(this.get("sysname"))}})}),define("app/collections/technologiesList",["underscore","backbone","formatters","./promised","../models/technology","initialData"],function(e,t,n,r,i,s){var o=s.dataDate;return r.extend({buildTechIdsHash:function(){if(this.length){var e={};this.each(function(t){e[t.attributes.id]=t}),this._byTechId=e}},getById:function(e){return this._byTechId||this.buildTechIdsHash(),this._byTechId[e]},model:i,url:"/api/technologies/list?includeEmpty=true&dataDate="+o})}),define("app/instances/collections/technologiesList",["app/collections/technologiesList"],function(e){return new e}),define("rollouts",["jquery","underscore","accountInfo","subscription"],function(e,t,n,r){var i={emailDiscovery:"Rollout_EmailDiscovery",customReports:"Rollout_CustomReports",historyReports:"Rollout_HistoryReports"},s={};return n&&n.attributes.permissions&&t.each(i,function(e,t){var r=n.attributes.permissions[e];r&&r.enabled&&(s[t]=!0)}),s}),function(e){define("libs/bootstrap/scrollspy",["jquery"],function(){return function(){+function(e){function t(n,r){var i,s=e.proxy(this.process,this);this.$element=e(n).is("body")?e(window):e(n),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",s),this.options=e.extend({},t.DEFAULTS,r),this.selector=(this.options.target||(i=e(n).attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}t.DEFAULTS={offset:10},t.prototype.refresh=function(){var t=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var n=this,r=this.$body.find(this.selector).map(function(){var r=e(this),i=r.data("target")||r.attr("href"),s=/^#./.test(i)&&e(i);return s&&s.length&&s.is(":visible")&&[[s[t]().top+(!e.isWindow(n.$scrollElement.get(0))&&n.$scrollElement.scrollTop()),i]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},t.prototype.process=function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);if(s&&e<=r[0])return s!=(o=i[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',r=e(n).parents("li").addClass("active");r.parent(".dropdown-menu").length&&(r=r.closest("li.dropdown").addClass("active")),r.trigger("activate.bs.scrollspy")};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("bs.scrollspy"),s=typeof n=="object"&&n;i||r.data("bs.scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(jQuery)}.apply(e,arguments)})}(this),+function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focusin",a=o=="hover"?"mouseleave":"focusout";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this,r=this.tip();this.setContent(),this.options.animation&&r.addClass("fade");var i=typeof this.options.placement=="function"?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,o=s.test(i);o&&(i=i.replace(s,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(i),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);var u=this.getPosition(),a=r[0].offsetWidth,f=r[0].offsetHeight;if(o){var l=this.$element.parent(),c=i,h=document.documentElement.scrollTop||document.body.scrollTop,p=this.options.container=="body"?window.innerWidth:l.outerWidth(),d=this.options.container=="body"?window.innerHeight:l.outerHeight(),v=this.options.container=="body"?0:l.offset().left;i=i=="bottom"&&u.top+u.height+f-h>d?"top":i=="top"&&u.top-h-f<0?"bottom":i=="right"&&u.right+a>p?"left":i=="left"&&u.left-a<v?"right":i,r.removeClass(c).addClass(i)}var m=this.getCalculatedOffset(i,u,a,f);this.applyPlacement(m,i),this.hoverState=null;var g=function(){n.$element.trigger("shown.bs."+n.type)};e.support.transition&&this.$tip.hasClass("fade")?r.one(e.support.transition.end,g).emulateTransitionEnd(150):g()}},t.prototype.applyPlacement=function(t,n){var r,i=this.tip(),s=i[0].offsetWidth,o=i[0].offsetHeight,u=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(u)&&(u=0),isNaN(a)&&(a=0),t.top=t.top+u,t.left=t.left+a,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var f=i[0].offsetWidth,l=i[0].offsetHeight;n=="top"&&l!=o&&(r=!0,t.top=t.top+o-l);if(/bottom|top/.test(n)){var c=0;t.left<0&&(c=t.left*-2,t.left=0,i.offset(t),f=i[0].offsetWidth,l=i[0].offsetHeight),this.replaceArrow(c-s+f,f,"left")}else this.replaceArrow(l-o,l,"top");r&&i.offset(t)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach(),t.$element.trigger("hidden.bs."+t.type)}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;if(!i&&n=="destroy")return;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),define("libs/bootstrap/tooltip",function(){}),function(e){define("libs/bootstrap/affix",["jquery"],function(){return function(){+function(e){var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var e=this.$window.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=e(document).height(),r=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,o=s.top,u=s.bottom;this.affixed=="top"&&(i.top+=r),typeof s!="object"&&(u=o=s),typeof o=="function"&&(o=s.top(this.$element)),typeof u=="function"&&(u=s.bottom(this.$element));var a=this.unpin!=null&&r+this.unpin<=i.top?!1:u!=null&&i.top+this.$element.height()>=n-u?"bottom":o!=null&&r<=o?"top":!1;if(this.affixed===a)return;this.unpin&&this.$element.css("top","");var f="affix"+(a?"-"+a:""),l=e.Event(f+".bs.affix");this.$element.trigger(l);if(l.isDefaultPrevented())return;this.affixed=a,this.unpin=a=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(f).trigger(e.Event(f.replace("affix","affixed"))),a=="bottom"&&this.$element.offset({top:n-u-this.$element.height()})};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(jQuery)}.apply(e,arguments)})}(this),define("app/modules/dashboard/views/discoveryPane/base",["underscore","jquery","backbone","marionette","radio","libs/bootstrap/scrollspy","libs/bootstrap/tooltip","libs/bootstrap/affix"],function(e,t,n,r,i){var s=i.channel("discoveryPane"),o=i.channel("dashboard");return r.LayoutView.extend({className:"discovery-pane-root",template:e.template('<div class="title-view unavailable"></div><div class="discovery-pane">   <div class="tabs-bar row"></div>   <div class="panel-group tabs-group" role="tablist"></div></div><div class="discovery-depth-ph"></div><div class="discovery-depth-close dismiss-pinning">&times;</div>'),regions:{depth:".discovery-depth-ph"},emptyView:n.View,initialize:function(){t("body").css("overflow-y","hidden"),this.model=this.model||this.createModel(this.options.subjectModel),this.emptyView=this.options.emptyView||this.emptyView,this.noDataView=this.options.noDataView||this.noDataView,this.options.hasOwnProperty("toggleHandle")&&(this.toggleHandle=this.options.toggleHandle),this.panels={},this.onBeforePanelExpand=e.bind(this.onBeforePanelExpand,this),this._renderWithData=e.bind(this._renderWithData,this),this.pinPanel=e.bind(this.pinPanel,this),this.onClickToggle=e.bind(this.onClickToggle,this),this.unpinPanel=e.bind(this.unpinPanel,this),this.resizePinnedPane=e.bind(this.resizePinnedPane,this),this.options.persist!==!1&&this.model.loadFromStorage&&this.model.loadFromStorage(),this.options.activePanel&&this.model.set("activePanel",this.options.activePanel),this.listenTo(this.model,"change:activePanel",this._setActivePanel),this.listenTo(s,"cmd:setActivePanel",this.setActivePanel),this.listenTo(s,"req:reqActivePanel",this.reqActivePanel),this.listenTo(s,"req:panel",this.reqPanel),this.listenTo(s,"req:site",this.reqSite),this.appendToggleHandle()},events:{"click a.panel-trigger":"onClickPanelLink"},onClickPanelLink:function(e){if(e&&e.currentTarget){var n=t(e.currentTarget),r=n.data("panel");this.model.set("activePanel",r),e.preventDefault()}},reqPanel:function(e,t){var n=this.panels[e];t(n,e)},reqActivePanel:function(e){var t=this.model.get("activePanel"),n=t?this.panels[t]:undefined;e(n,t)},reqSite:function(e){e(this.model.id)},setActivePanel:function(e){var t=this.panels[e];t&&this.model.set("activePanel",e)},_setActivePanel:function(){var e=this.model.get("activePanel");if(e){var t=this.panels[e];t&&t.expand()}},_renderWithData:function(){this.$el.html(this.template(this.model.toJSON())),this.appendToggleHandle(),this.$(".dismiss-pinning").off().on("click",this.unpinPanel),this.renderPanels()?(this._setActivePanel(),s.trigger("render:after",this,!0,this.model)):this.renderNoData()},toggleHandle:'<div class="toggle-handle-ph"><div class="btn-toggle-sidebar"><i class="toggle-icon"></i></div></div>',appendToggleHandle:function(){this.toggleHandle&&this.$el.prepend(t(this.toggleHandle).click(this.onClickToggle))},onClickToggle:function(){o.trigger("toggleDiscoverySidebar"),this.trigger("toggleDiscoverySidebar")},render:function(){var e=this,t=this.$el;return this.empty(),this.appendToggleHandle(),!this.model||!this.model.id?(this.currentView=new this.emptyView,t.html(this.currentView.render().$el),this.appendToggleHandle(),s.trigger("render:after",this,null,this.model)):this.model._parsed?setTimeout(this._renderWithData,0):(t.circleLoader(!0,{autoColor:!0}),this.model.fetch({success:function(){t.circleLoader("hide",{force:!0}),t.removeClass("loading-masked"),e.onResponse?e.onResponse(e._renderWithData):e._renderWithData()},error:function(){t.circleLoader("hide",{force:!0}),t.removeClass("loading-masked"),e.renderNoData()}})),this},renderNoData:function(){this.noDataView&&(this.currentView=new this.noDataView({model:this.model}),this.$el.html(this.currentView.render().$el),this.appendToggleHandle()),s.trigger("render:after",this,!1,this.model)},renderPanels:function(){var n=this.model,r=this,i=!1,s=this.$(".panel-group"),o=this.panels=this.panels||{},u=this.$(".tabs-bar"),a={},f=this.model.get("activePanel"),l=this.options.panels||this.getPanels();e.first(e.filter(l,function(e,t){return t.localeCompare(f)}));var c=0,h=undefined,p=undefined,d=function(e,t){return e==="company"?!!t.name:!0};e.each(l,function(e,l){f=f||l;if(e){var v=e.view,m=v.prototype.Model,g=r.model.get(e.modelRoot);if(g){var y=new m(g,{parse:!0,parent:r.model});if(!y.isEmpty()&&d(e.modelRoot,g)){i=!0;var b=new v(t.extend({parentView:r,parentModel:n,model:y,isActive:f===l,title:e.title,dataType:l},e.viewOptions||{}));r.listenTo(b,"tabview:bodyExpand:before",function(){r.onBeforePanelExpand(b,l,e)}),r.listenTo(b,"child:requestPin",r.pinPanel),r.listenTo(b,"child:requestUnpin",r.unpinPanel),o[l]=b,s.append(b.render().$el),u.append("<div class='col-xs-2 group-panel group-"+l+" group-tab-panel-item"+(f===l?" selected":"")+"' data-type='"+l+"' title='"+(e.shortTitle||e.title)+"'>"+'   <div class="menu-bar st-tooltip" title=\''+(e.shortTitle||e.title)+"'>"+"     <div class='"+l+"-tab'><i class='icon-"+l+"'></i></div>"+"   </div>"+"</div>"),a[l]=b,b.appendClass(l),c++,f===l&&(h=b,p=l)}}}}),t(".menu-bar.st-tooltip").tooltip({placement:"bottom",delay:0}),u.append("<div class='col-xs-12 title-menu-bar'></div>");var v=100/c+"%";return t(".group-panel").css("width",v).click(function(e){e.preventDefault();var n=t(this).attr("data-type");a[n].expand()}),t(".group-tab-panel-item.selected").length||t(".group-tab-panel-item").first().addClass("selected"),t(".group-tab-panel-item.selected").click(),i},pinPanel:function(n,r){r=r||{};var i=this.model.get("activePanel"),o=this.panels[i],u=o.$el,a=r.expandPromise,f=!!r.clickScreenToUnpin,l=e.bind(function(){if(this._pinningCancelled)return;this.depthView=n,this.depth.show(n),this.listenTo(n,"requestUnpin",this.unpinPanel)},this);if(!o.pinned){this.pinned=!0,o.pinned=!0,o.trigger("pin",n),o.disableToggle(),u.addClass("pinned");var c=u.position().top,h=this.$el.innerHeight()-c-u.height();u.css({top:c,bottom:h}),setTimeout(function(){o.$el.addClass("in")},0);if(n){a=a||t.when(!0);var p=t.Deferred();setTimeout(function(){p.resolve()},300),t.when(p.promise(),a).done(e.bind(function(){if(this._pinningCancelled)return;l(),this.pinnedWithDepth=!0;var n=this.$el.parent();if(n&&n.length){var r=n.parent();if(n.length){var i=this.$screen=t("<div />",{"class":"discover-pane-screen"+(f?" clickable":"")});r.append(this.$screen);if(f){var u,a=this.$el,c;i.on("mouseenter",e.bind(function(){u=!0,c||(c=setTimeout(function(){u&&a.addClass("screen-hovered"),c=null},300))},this)).on("mouseleave",e.bind(function(){u=!1,c&&(clearTimeout(c),c=null),this.$el.removeClass("screen-hovered")},this)).one("click",e.bind(function(){c&&(clearTimeout(c),c=null),this.$el.removeClass("screen-hovered"),i.removeClass("clickable"),this.unpinPanel()},this)),o.once("unpin:before",function(){c&&(clearTimeout(c),c=null)})}setTimeout(function(){i.addClass("in")},0)}}t("body").addClass("discovery-pane-pinned"),s.trigger("pin",o);var a=this.$el,n=a.parent(),h=n&&n.length?n.height():t(window).height()-a.position().top;a.addClass("pinned-with-depth").css("height",h),t(window).on("resize.pinned-discovery-pane",this.resizePinnedPane),setTimeout(function(){a.addClass("pinned-with-depth-in")},0)},this))}}else n&&l()},resizePinnedPane:function(){this.pinnedWithDepth&&this.$el.css("height",t(window).height()-this.$el.position().top)},hideTitleView:function(){var e=t(".discovery-pane-root").find(".title-view");e.addClass("unavailable")},unpinPanel:function(){var n=this.model.get("activePanel"),r=this.panels[n],i=r.$el,o=this;if(r.pinned&&!this._pinningCancelled){this._pinningCancelled=!0;var u=e.bind(function(){this.pinned=!1,r.pinned=!1,r.trigger("unpin"),r.enableToggle(),r.$el.removeClass("in"),o.hideTitleView(),setTimeout(function(){i.css({top:"",bottom:""}).removeClass("pinned")},300),this._pinningCancelled=undefined},this);if(this.depthView){t(window).off(".pinned-discovery-pane"),this.$el.removeClass("pinned-with-depth-in").css("height","");var a=this.$screen;a&&a.removeClass("in").off(),setTimeout(e.bind(function(){this.trigger("unpin:before"),r.trigger("unpin:before"),this.$el.removeClass("pinned-with-depth"),this.depthView=null,this.depth.reset();if(a){try{setTimeout(function(){a.detach()},400)}catch(e){}this.$screen=null}t("body").removeClass("discovery-pane-pinned"),s.trigger("unpin",r),this.pinnedWithDepth=!1,u()},this),300)}else this.trigger("unpin:before"),r.trigger("unpin:before"),u()}},onBeforePanelExpand:function(n,r){var i=this.$el.innerHeight(),s,o,u=t(".tabs-bar");e.each(this.panels,function(e){n!==e&&e.collapse()}),s=u.height()+parseInt(u.css("padding-top"))+parseInt(u.css("padding-bottom"))+parseInt(u.css("border-top"))+parseInt(u.css("border-bottom")),o=i-s,n.setMaxBodyHeight(o),this.model.set("activePanel",r),this.options.persist!==!1&&this.model.saveToStorage&&this.model.saveToStorage()},empty:function(){this.$(".panel-group").empty();var t=this.panels||{};e.each(t,function(e){try{e.destroy()}catch(t){}}),this.panels={},this.currentView&&(this.currentView.destroy(),this.currentView=null)},onDestroy:function(){this.empty()}})}),define("app/mixins/modelStorage",["jquery","underscore"],function(e,t){return{storageKey:"_",getStorage:function(){return window.localStorage},isStorageSupported:function(){if(this._storageSupported!==undefined)return this._storageSupported;var e=this.getStorage();return this._storageSupported=!!(e&&e.getItem&&e.setItem&&e.removeItem)},clearStorage:function(){this.getStorage().removeItem(this.storageKey)},loadFromStorage:function(){if(this.isStorageSupported())try{var t,n=this.getStorage().getItem(this.storageKey);if(n){t=e.parseJSON(n);var r=this.parseFromStorage(t);this.trigger("setFromStorage:before",r),this.setFromStorage(r),this.trigger("setFromStorage:after",r)}}catch(i){console.warn(i)}},setFromStorage:function(e){this.set(e)},parseFromStorage:function(e){return e},serializeForStorage:function(){return this.toJSON()},saveToStorage:function(){if(this.isStorageSupported())try{var e=this.serializeForStorage();this.trigger("saveToStorage:before",e),this.getStorage().setItem(this.storageKey,JSON.stringify(e)),this.trigger("saveToStorage:after",e)}catch(t){console.warn(t)}}}}),define("app/modules/dashboard/models/websiteDiscovery/index",["underscore","jquery","backbone","app/mixins/modelStorage"],function(e,t,n,r){var i=n.Model.extend({});return e.extend(i.prototype,r,{idAttribute:"site",urlRoot:"/api/websites/discover",parse:function(e){return e.technologies&&e.technologies.technologiesBudgetScore&&e.info&&(e.info.technologiesBudgetScore=e.technologies.technologiesBudgetScore,e.info.budgetScoreDistribution=e.technologies.budgetScoreDistribution),e&&(this._parsed=!0),e},getStorage:function(){return window.localStorage},storageKey:"dashboard.discoveryPane",setFromStorage:function(e){this.set("activePanel",e.activePanel)},serializeForStorage:function(){return{activePanel:this.attributes.activePanel}}}),i}),define("app/modules/dashboard/views/discoveryPane/websiteDiscoveryPane",["underscore","jquery","backbone","marionette","radio","app/instances/collections/technologyCategoriesList","app/instances/collections/technologiesList","rollouts","./base","../../models/websiteDiscovery/index"],function(e,t,n,r,i,s,o,u,a,f){var l="app/modules/dashboard/views/discoveryPane/panels";return a.extend({className:"discovery-pane-root website-discovery-pane-root",emptyView:r.ItemView.extend({className:"empty-state dark text-center",template:e.template('<i class="icon-graduation-cap icon-empty" style="padding-top: 30px;"></i><p>Hit a record to discover a current, extremely useful information about it</p>')}),noDataView:r.ItemView.extend({className:"empty-state dark text-center",template:e.template('<i class="icon-empty" style="padding-top: 30px;">=/</i><p>No data for <%- obj.site %> at the moment</p>')}),onResponse:function(e){t.when(o.initialLoad(),s.initialLoad()).done(e)},createModel:function(t){return new f({site:t?e.isString(t)?t:t.get("site"):undefined},{parent:t})},getPanels:function(){var e={siteInfo:{view:require(l+"/siteInfo"),modelRoot:"info",title:"Website Information",shortTitle:"Website"},companyInfo:{view:require(l+"/siteCompany"),modelRoot:"company",title:"Company Information",shortTitle:"Company"},siteTechnologies:{view:require(l+"/siteTechnologies"),modelRoot:"technologies",title:"Technologies"},emailsInfo:{view:require(l+"/siteEmails"),modelRoot:"emails",title:"Company Emails",shortTitle:"Emails"}};return u.emailDiscovery&&(e.contactInfo={view:require(l+"/siteContacts"),modelRoot:"contacts",title:"Search People",shortTitle:"People"}),e}})}),define("app/helpers/checkImageUrl",[],function(){return function(e,t,n){var r=new Image;r.onload=function(){if(this.naturalHeight!==undefined){if(this.naturalHeight+this.naturalWidth===0){n();return}}else if(this.width+this.height==0){n();return}t({height:this.naturalHeight||this.height,width:this.naturalWidth||this.width})},r.onerror=function(){n()},r.src=e}}),function(e){define("highcharts",["jquery"],function(){return function(){return function(){function Nt(e,t){var n;e||(e={});for(n in t)e[n]=t[n];return e}function Ct(){var e,t=arguments,n,r={},i=function(e,t){var n,r;typeof e!="object"&&(e={});for(r in t)t.hasOwnProperty(r)&&(n=t[r],n&&typeof n=="object"&&Object.prototype.toString.call(n)!=="[object Array]"&&r!=="renderTo"&&typeof n.nodeType!="number"?e[r]=i(e[r]||{},n):e[r]=t[r]);return e};t[0]===!0&&(r=t[1],t=Array.prototype.slice.call(t,2)),n=t.length;for(e=0;e<n;e++)r=i(r,t[e]);return r}function kt(){var e=0,t=arguments,n=t.length,r={};for(;e<n;e++)r[t[e++]]=t[e];return r}function Lt(e,t){return parseInt(e,t||10)}function At(e){return typeof e=="string"}function Ot(e){return typeof e=="object"}function Mt(e){return Object.prototype.toString.call(e)==="[object Array]"}function _t(e){return typeof e=="number"}function Dt(e){return r.log(e)/r.LN10}function Pt(e){return r.pow(10,e)}function Ht(e,t){var n=e.length;while(n--)if(e[n]===t){e.splice(n,1);break}}function Bt(t){return t!==e&&t!==null}function jt(e,t,n){var r,i;if(At(t))Bt(n)?e.setAttribute(t,n):e&&e.getAttribute&&(i=e.getAttribute(t));else if(Bt(t)&&Ot(t))for(r in t)e.setAttribute(r,t[r]);return i}function Ft(e){return Mt(e)?e:[e]}function It(){var e=arguments,t,n,r=e.length;for(t=0;t<r;t++){n=e[t];if(typeof n!="undefined"&&n!==null)return n}}function qt(t,n){m&&!S&&n&&n.opacity!==e&&(n.filter="alpha(opacity="+n.opacity*100+")"),Nt(t.style,n)}function Rt(e,n,r,i,s){var o=t.createElement(e);return n&&Nt(o,n),s&&qt(o,{padding:0,border:$,margin:0}),r&&qt(o,r),i&&i.appendChild(o),o}function Ut(e,t){var n=function(){};return n.prototype=new e,Nt(n.prototype,t),n}function zt(e,t,n,r){var i=O.lang,s=+e||0,o=t===-1?(s.toString().split(".")[1]||"").length:isNaN(t=f(t))?2:t,u=n===undefined?i.decimalPoint:n,a=r===undefined?i.thousandsSep:r,l=s<0?"-":"",c=String(Lt(s=f(s).toFixed(o))),h=c.length>3?c.length%3:0;return l+(h?c.substr(0,h)+a:"")+c.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?u+f(s-c).toFixed(o).slice(2):"")}function Wt(e,t){return(new Array((t||2)+1-String(e).length)).join(0)+e}function Xt(e,t,n){var r=e[t];e[t]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(r),n.apply(this,e)}}function Vt(e,t){var n=/f$/,r=/\.([0-9])/,i=O.lang,s;return n.test(e)?(s=e.match(r),s=s?s[1]:-1,t!==null&&(t=zt(t,s,i.decimalPoint,e.indexOf(",")>-1?i.thousandsSep:""))):t=M(e,t),t}function $t(e,t){var n="{",r=!1,i,s,o,u,a,f=[],l,c;while((c=e.indexOf(n))!==-1){i=e.slice(0,c);if(r){s=i.split(":"),o=s.shift().split("."),a=o.length,l=t;for(u=0;u<a;u++)l=l[o[u]];s.length&&(l=Vt(s.join(":"),l)),f.push(l)}else f.push(i);e=e.slice(c+1),r=!r,n=r?"}":"{"}return f.push(e),f.join("")}function Jt(e){return r.pow(10,s(r.log(e)/r.LN10))}function Kt(e,t,n,r){var i,s;n=It(n,1),i=e/n,t||(t=[1,2,2.5,5,10],r&&r.allowDecimals===!1&&(n===1?t=[1,2,5,10]:n<=.1&&(t=[1/n])));for(s=0;s<t.length;s++){e=t[s];if(i<=(t[s]+(t[s+1]||t[s]))/2)break}return e*=n,e}function Qt(){this.color=0,this.symbol=0}function Gt(e,t){var n=e.length,r,i;for(i=0;i<n;i++)e[i].ss_i=i;e.sort(function(e,n){return r=t(e,n),r===0?e.ss_i-n.ss_i:r});for(i=0;i<n;i++)delete e[i].ss_i}function Yt(e){var t=e.length,n=e[0];while(t--)e[t]<n&&(n=e[t]);return n}function Zt(e){var t=e.length,n=e[0];while(t--)e[t]>n&&(n=e[t]);return n}function en(e,t){var n;for(n in e)e[n]&&e[n]!==t&&e[n].destroy&&e[n].destroy(),delete e[n]}function tn(e){A||(A=Rt(q)),e&&A.appendChild(e),A.innerHTML=""}function nn(e,t){var r="Highcharts error #"+e+": www.highcharts.com/errors/"+e;if(t)throw r;n.console&&console.log(r)}function rn(e){return parseFloat(e.toPrecision(14))}function sn(e,t){_=It(e,t.animation)}function Tn(){var e=O.global.useUTC,t=e?"getUTC":"get",n=e?"setUTC":"set";ct=(e&&O.global.timezoneOffset||0)*6e4,lt=e?Date.UTC:function(e,t,n,r,i,s){return(new Date(e,t,It(n,1),It(r,0),It(i,0),It(s,0))).getTime()},ht=t+"Minutes",pt=t+"Hours",dt=t+"Day",vt=t+"Date",mt=t+"Month",gt=t+"FullYear",yt=n+"Minutes",bt=n+"Hours",wt=n+"Date",Et=n+"Month",St=n+"FullYear"}function Nn(e){return O=Ct(!0,O,e),Tn(),O}function Cn(){return O}function Mn(){}function Fn(e,t,n,r){this.axis=e,this.pos=t,this.type=n||"",this.isNew=!0,!n&&!r&&this.addLabel()}function In(){this.init.apply(this,arguments)}function Kn(){this.init.apply(this,arguments)}function Zn(e,t,n,r,i){var s=e.chart.inverted;this.axis=e,this.isNegative=n,this.options=t,this.x=r,this.total=null,this.points={},this.stack=i,this.alignOptions={align:t.align||(s?n?"left":"right":"center"),verticalAlign:t.verticalAlign||(s?"middle":n?"bottom":"top"),y:It(t.y,s?4:n?14:-6),x:It(t.x,s?n?-6:6:0)},this.textAlign=t.textAlign||(s?n?"right":"left":"center")}var e,t=document,n=window,r=Math,i=r.round,s=r.floor,o=r.ceil,u=r.max,a=r.min,f=r.abs,l=r.cos,c=r.sin,h=r.PI,p=h*2/360,d=navigator.userAgent,v=n.opera,m=/msie/i.test(d)&&!v,g=t.documentMode===8,y=/AppleWebKit/.test(d),b=/Firefox/.test(d),w=/(Mobile|Android|Windows Phone)/.test(d),E="http://www.w3.org/2000/svg",S=!!t.createElementNS&&!!t.createElementNS(E,"svg").createSVGRect,x=b&&parseInt(d.split("Firefox/")[1],10)<4,T=!S&&!m&&!!t.createElement("canvas").getContext,N,C,k={},L=0,A,O,M,_,D,P,H=function(){},B=[],j=0,F="Highcharts",I="4.0.1",q="div",R="absolute",U="relative",z="hidden",W="highcharts-",X="visible",V="px",$="none",J="M",K="L",Q=/^[0-9]+$/,G="",Y="hover",Z="select",et="millisecond",tt="second",nt="minute",rt="hour",it="day",st="week",ot="month",ut="year",at,ft="stroke-width",lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt={},Tt=n.Highcharts=n.Highcharts?nn(16,!0):{};M=function(e,t,n){if(!Bt(t)||isNaN(t))return"Invalid date";e=It(e,"%Y-%m-%d %H:%M:%S");var r=new Date(t-ct),s,o=r[pt](),u=r[dt](),a=r[vt](),f=r[mt](),l=r[gt](),c=O.lang,h=c.weekdays,p=Nt({a:h[u].substr(0,3),A:h[u],d:Wt(a),e:a,b:c.shortMonths[f],B:c.months[f],m:Wt(f+1),y:l.toString().substr(2,2),Y:l,H:Wt(o),I:Wt(o%12||12),l:o%12||12,M:Wt(r[ht]()),p:o<12?"AM":"PM",P:o<12?"am":"pm",S:Wt(r.getSeconds()),L:Wt(i(t%1e3),3)},Tt.dateFormats);for(s in p)while(e.indexOf("%"+s)!==-1)e=e.replace("%"+s,typeof p[s]=="function"?p[s](t):p[s]);return n?e.substr(0,1).toUpperCase()+e.substr(1):e},Qt.prototype={wrapColor:function(e){this.color>=e&&(this.color=0)},wrapSymbol:function(e){this.symbol>=e&&(this.symbol=0)}},P=kt(et,1,tt,1e3,nt,6e4,rt,36e5,it,864e5,st,6048e5,ot,26784e5,ut,31556952e3),D={init:function(e,t,n){t=t||"";var r=e.shift,i=t.indexOf("C")>-1,s=i?7:3,o,u,a,f=t.split(" "),l=[].concat(n),c,h,p=function(e){a=e.length;while(a--)e[a]===J&&e.splice(a+1,0,e[a+1],e[a+2],e[a+1],e[a+2])};i&&(p(f),p(l)),e.isArea&&(c=f.splice(f.length-6,6),h=l.splice(l.length-6,6));if(r<=l.length/s&&f.length===l.length)while(r--)l=[].concat(l).splice(0,s).concat(l);e.shift=0;if(f.length){o=l.length;while(f.length<o)u=[].concat(f).splice(f.length-s,s),i&&(u[s-6]=u[s-2],u[s-5]=u[s-1]),f=f.concat(u)}return c&&(f=f.concat(c),l=l.concat(h)),[f,l]},step:function(e,t,n,r){var i=[],s=e.length,o;if(n===1)i=r;else if(s===t.length&&n<1)while(s--)o=parseFloat(e[s]),i[s]=isNaN(o)?e[s]:n*parseFloat(t[s]-o)+o;else i=t;return i}},function(r){n.HighchartsAdapter=n.HighchartsAdapter||r&&{init:function(t){var n=r.fx,i=n.step,s,o=r.Tween,u=o&&o.propHooks,a=r.cssHooks.opacity;r.extend(r.easing,{easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n}}),r.each(["cur","_default","width","height","opacity"],function(t,r){var s=i,a;r==="cur"?s=n.prototype:r==="_default"&&o&&(s=u[r],r="set"),a=s[r],a&&(s[r]=function(n){var i;n=t?n:this;if(n.prop==="align")return;return i=n.elem,i.attr?i.attr(n.prop,r==="cur"?e:n.now):a.apply(this,arguments)})}),Xt(a,"get",function(e,t,n){return t.attr?t.opacity||0:e.call(this,t,n)}),s=function(e){var n=e.elem,r;e.started||(r=t.init(n,n.d,n.toD),e.start=r[0],e.end=r[1],e.started=!0),n.attr("d",t.step(e.start,e.end,e.pos,n.toD))},o?u.d={set:s}:i.d=s,this.each=Array.prototype.forEach?function(e,t){return Array.prototype.forEach.call(e,t)}:function(e,t){var n=0,r=e.length;for(;n<r;n++)if(t.call(e[n],e[n],n,e)===!1)return n},r.fn.highcharts=function(){var t="Chart",n=arguments,r,i,s;return this[0]&&(At(n[0])&&(t=n[0],n=Array.prototype.slice.call(n,1)),r=n[0],r!==e&&(r.chart=r.chart||{},r.chart.renderTo=this[0],s=new Tt[t](r,n[1]),i=this),r===e&&(i=B[jt(this[0],"data-highcharts-chart")])),i}},getScript:r.getScript,inArray:r.inArray,adapterRun:function(e,t){return r(e)[t]()},grep:r.grep,map:function(e,t){var n=[],r=0,i=e.length;for(;r<i;r++)n[r]=t.call(e[r],e[r],r,e);return n},offset:function(e){return r(e).offset()},addEvent:function(e,t,n){r(e).bind(t,n)},removeEvent:function(e,n,i){var s=t.removeEventListener?"removeEventListener":"detachEvent";t[s]&&e&&!e[s]&&(e[s]=function(){}),r(e).unbind(n,i)},fireEvent:function(e,t,n,i){var s=r.Event(t),o="detached"+t,u;!m&&n&&(delete n.layerX,delete n.layerY,delete n.returnValue),Nt(s,n),e[t]&&(e[o]=e[t],e[t]=null),r.each(["preventDefault","stopPropagation"],function(e,t){var n=s[t];s[t]=function(){try{n.call(s)}catch(e){t==="preventDefault"&&(u=!0)}}}),r(e).trigger(s),e[o]&&(e[t]=e[o],e[o]=null),i&&!s.isDefaultPrevented()&&!u&&i(s)},washMouseEvent:function(t){var n=t.originalEvent||t;return n.pageX===e&&(n.pageX=t.pageX,n.pageY=t.pageY),n},animate:function(t,n,i){var s=r(t);t.style||(t.style={}),n.d&&(t.toD=n.d,n.d=1),s.stop(),n.opacity!==e&&t.attr&&(n.opacity+="px"),s.animate(n,i)},stop:function(e){r(e).stop()}}}(n.jQuery);var on=n.HighchartsAdapter,un=on||{};on&&on.init.call(on,D);var an=un.adapterRun,fn=un.getScript,ln=un.inArray,cn=un.each,hn=un.grep,pn=un.offset,dn=un.map,vn=un.addEvent,mn=un.removeEvent,gn=un.fireEvent,yn=un.washMouseEvent,bn=un.animate,wn=un.stop,En={enabled:!0,x:0,y:15,style:{color:"#606060",cursor:"default",fontSize:"11px"}};O={colors:["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#8085e8","#8d4653","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/4.0.1/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/4.0.1/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"}},subtitle:{text:"",align:"center",style:{color:"#555555"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:Ct(En,{align:"center",enabled:!1,formatter:function(){return this.y===null?"":zt(this.y,-1)},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,states:{hover:{marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3}},labels:{style:{position:R,color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:R,width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:U,top:"1em"},style:{position:R,backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:S,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}"></span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:w?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var Sn=O.plotOptions,xn=Sn.line;Tn();var kn=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,Ln=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,An=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,On=function(e){function i(e){e&&e.stops?r=dn(e.stops,function(e){return On(e[1])}):(n=kn.exec(e),n?t=[Lt(n[1]),Lt(n[2]),Lt(n[3]),parseFloat(n[4],10)]:(n=Ln.exec(e),n?t=[Lt(n[1],16),Lt(n[2],16),Lt(n[3],16),1]:(n=An.exec(e),n&&(t=[Lt(n[1]),Lt(n[2]),Lt(n[3]),1]))))}function s(n){var i;return r?(i=Ct(e),i.stops=[].concat(i.stops),cn(r,function(e,t){i.stops[t]=[i.stops[t][0],e.get(n)]})):t&&!isNaN(t[0])?n==="rgb"?i="rgb("+t[0]+","+t[1]+","+t[2]+")":n==="a"?i=t[3]:i="rgba("+t.join(",")+")":i=e,i}function o(e){if(r)cn(r,function(t){t.brighten(e)});else if(_t(e)&&e!==0){var n;for(n=0;n<3;n++)t[n]+=Lt(e*255),t[n]<0&&(t[n]=0),t[n]>255&&(t[n]=255)}return this}function u(e){return t[3]=e,this}var t=[],n,r;return i(e),{get:s,brighten:o,rgba:t,setOpacity:u}};Mn.prototype={init:function(e,n){var r=this;r.element=n==="span"?Rt(n):t.createElementNS(E,n),r.renderer=e},opacity:1,animate:function(e,t,n){var r=It(t,_,!0);wn(this),r?(r=Ct(r,{}),n&&(r.complete=n),bn(this,e,r)):(this.attr(e),n&&n())},colorGradient:function(e,t,n){var r=this.renderer,i,s,o,u,a,f,l,c,h,p,d,v=[];e.linearGradient?s="linearGradient":e.radialGradient&&(s="radialGradient");if(s){o=e[s],u=r.gradients,f=e.stops,h=n.radialReference,Mt(o)&&(e[s]=o={x1:o[0],y1:o[1],x2:o[2],y2:o[3],gradientUnits:"userSpaceOnUse"}),s==="radialGradient"&&h&&!Bt(o.gradientUnits)&&(o=Ct(o,{cx:h[0]-h[2]/2+o.cx*h[2],cy:h[1]-h[2]/2+o.cy*h[2],r:o.r*h[2],gradientUnits:"userSpaceOnUse"}));for(p in o)p!=="id"&&v.push(p,o[p]);for(p in f)v.push(f[p]);v=v.join(","),u[v]?d=u[v].attr("id"):(o.id=d=W+L++,u[v]=a=r.createElement(s).attr(o).add(r.defs),a.stops=[],cn(f,function(e){var t;e[1].indexOf("rgba")===0?(i=On(e[1]),l=i.get("rgb"),c=i.get("a")):(l=e[1],c=1),t=r.createElement("stop").attr({offset:e[0],"stop-color":l,"stop-opacity":c}).add(a),a.stops.push(t)})),n.setAttribute(t,"url("+r.url+"#"+d+")")}},attr:function(t,n){var r,i,s=this.element,o,u=this,a;typeof t=="string"&&n!==e&&(r=t,t={},t[r]=n);if(typeof t=="string")u=(this[t+"Getter"]||this._defaultGetter).call(this,t,s);else{for(r in t)i=t[r],a=!1,this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(r)&&(o||(this.symbolAttr(t),o=!0),a=!0),this.rotation&&(r==="x"||r==="y")&&(this.doTransform=!0),a||(this[r+"Setter"]||this._defaultSetter).call(this,i,r,s),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(r)&&this.updateShadows(r,i);this.doTransform&&(this.updateTransform(),this.doTransform=!1)}return u},updateShadows:function(e,t){var n=this.shadows,r=n.length;while(r--)n[r].setAttribute(e,e==="height"?u(t-(n[r].cutHeight||0),0):e==="d"?this.d:t)},addClass:function(e){var t=this.element,n=jt(t,"class")||"";return n.indexOf(e)===-1&&jt(t,"class",n+" "+e),this},symbolAttr:function(e){var t=this;cn(["x","y","r","start","end","width","height","innerR","anchorX","anchorY"],function(n){t[n]=It(e[n],t[n])}),t.attr({d:t.renderer.symbols[t.symbolName](t.x,t.y,t.width,t.height,t)})},clip:function(e){return this.attr("clip-path",e?"url("+this.renderer.url+"#"+e.id+")":$)},crisp:function(e){var t=this,n,r={},o,u=e.strokeWidth||t.strokeWidth||t.attr&&t.attr("stroke-width")||0;o=i(u)%2/2,e.x=s(e.x||t.x||0)+o,e.y=s(e.y||t.y||0)+o,e.width=s((e.width||t.width||0)-2*o),e.height=s((e.height||t.height||0)-2*o),e.strokeWidth=u;for(n in e)t[n]!==e[n]&&(t[n]=r[n]=e[n]);return r},css:function(e){var t=this,n=t.styles,r={},i=t.element,s,o,u="",a,f=!n;e&&e.color&&(e.fill=e.color);if(n)for(o in e)e[o]!==n[o]&&(r[o]=e[o],f=!0);if(f){s=t.textWidth=e&&e.width&&i.nodeName.toLowerCase()==="text"&&Lt(e.width),n&&(e=Nt(n,r)),t.styles=e,s&&(T||!S&&t.renderer.forExport)&&delete e.width;if(m&&!S)qt(t.element,e);else{a=function(e,t){return"-"+t.toLowerCase()};for(o in e)u+=o.replace(/([A-Z])/g,a)+":"+e[o]+";";jt(i,"style",u)}s&&t.added&&t.renderer.buildText(t)}return t},on:function(e,t){var n=this,r=n.element;return C&&e==="click"?(r.ontouchstart=function(e){n.touchEventFired=Date.now(),e.preventDefault(),t.call(r,e)},r.onclick=function(e){(d.indexOf("Android")===-1||Date.now()-(n.touchEventFired||0)>1100)&&t.call(r,e)}):r["on"+e]=t,this},setRadialReference:function(e){return this.element.radialReference=e,this},translate:function(e,t){return this.attr({translateX:e,translateY:t})},invert:function(){var e=this;return e.inverted=!0,e.updateTransform(),e},updateTransform:function(){var e=this,t=e.translateX||0,n=e.translateY||0,r=e.scaleX,i=e.scaleY,s=e.inverted,o=e.rotation,u=e.element,a;s&&(t+=e.attr("width"),n+=e.attr("height")),a=["translate("+t+","+n+")"],s?a.push("rotate(90) scale(-1,1)"):o&&a.push("rotate("+o+" "+(u.getAttribute("x")||0)+" "+(u.getAttribute("y")||0)+")"),(Bt(r)||Bt(i))&&a.push("scale("+It(r,1)+" "+It(i,1)+")"),a.length&&u.setAttribute("transform",a.join(" "))},toFront:function(){var e=this.element;return e.parentNode.appendChild(e),this},align:function(e,t,n){var r,s,o,u,a={},f,l=this.renderer,c=l.alignedObjects;if(e){this.alignOptions=e,this.alignByTranslate=t;if(!n||At(n))this.alignTo=f=n||"renderer",Ht(c,this),c.push(this),n=null}else e=this.alignOptions,t=this.alignByTranslate,f=this.alignTo;n=It(n,l[f],l),r=e.align,s=e.verticalAlign,o=(n.x||0)+(e.x||0),u=(n.y||0)+(e.y||0);if(r==="right"||r==="center")o+=(n.width-(e.width||0))/{right:1,center:2}[r];a[t?"translateX":"x"]=i(o);if(s==="bottom"||s==="middle")u+=(n.height-(e.height||0))/({bottom:1,middle:2}[s]||1);return a[t?"translateY":"y"]=i(u),this[this.placed?"animate":"attr"](a),this.placed=!0,this.alignAttr=a,this},getBBox:function(){var e=this,t=e.bBox,n=e.renderer,r,i,s=e.rotation,o=e.element,u=e.styles,a=s*p,h=e.textStr,d;if(h===""||Q.test(h))d="num."+h.toString().length+(u?"|"+u.fontSize+"|"+u.fontFamily:"");d&&(t=n.cache[d]);if(!t){if(o.namespaceURI===E||n.forExport){try{t=o.getBBox?Nt({},o.getBBox()):{width:o.offsetWidth,height:o.offsetHeight}}catch(v){}if(!t||t.width<0)t={width:0,height:0}}else t=e.htmlGetBBox();n.isSVG&&(r=t.width,i=t.height,m&&u&&u.fontSize==="11px"&&i.toPrecision(3)==="16.9"&&(t.height=i=14),s&&(t.width=f(i*c(a))+f(r*l(a)),t.height=f(i*l(a))+f(r*c(a)))),e.bBox=t,d&&(n.cache[d]=t)}return t},show:function(e){return e&&this.element.namespaceURI===E?(this.element.removeAttribute("visibility"),this):this.attr({visibility:e?"inherit":X})},hide:function(){return this.attr({visibility:z})},fadeOut:function(e){var t=this;t.animate({opacity:0},{duration:e||150,complete:function(){t.hide()}})},add:function(e){var t=this.renderer,n=e||t,r=n.element||t.box,i,s=this.element,o=this.zIndex,u,a,f,l;e&&(this.parentGroup=e),this.parentInverted=e&&e.inverted,this.textStr!==undefined&&t.buildText(this),o&&(n.handleZ=!0,o=Lt(o));if(n.handleZ){i=r.childNodes;for(f=0;f<i.length;f++){u=i[f],a=jt(u,"zIndex");if(u!==s&&(Lt(a)>o||!Bt(o)&&Bt(a))){r.insertBefore(s,u),l=!0;break}}}return l||r.appendChild(s),this.added=!0,this.onAdd&&this.onAdd(),this},safeRemoveChild:function(e){var t=e.parentNode;t&&t.removeChild(e)},destroy:function(){var e=this,t=e.element||{},n=e.shadows,r=e.renderer.isSVG&&t.nodeName==="SPAN"&&e.parentGroup,i,s,o;t.onclick=t.onmouseout=t.onmouseover=t.onmousemove=t.point=null,wn(e),e.clipPath&&(e.clipPath=e.clipPath.destroy());if(e.stops){for(o=0;o<e.stops.length;o++)e.stops[o]=e.stops[o].destroy();e.stops=null}e.safeRemoveChild(t),n&&cn(n,function(t){e.safeRemoveChild(t)});while(r&&r.div.childNodes.length===0)i=r.parentGroup,e.safeRemoveChild(r.div),delete r.div,r=i;e.alignTo&&Ht(e.renderer.alignedObjects,e);for(s in e)delete e[s];return null},shadow:function(e,t,n){var r=[],i,s,o=this.element,a,f,l,c;if(e){f=It(e.width,3),l=(e.opacity||.15)/f,c=this.parentInverted?"(-1,-1)":"("+It(e.offsetX,1)+", "+It(e.offsetY,1)+")";for(i=1;i<=f;i++)s=o.cloneNode(0),a=f*2+1-2*i,jt(s,{isShadow:"true",stroke:e.color||"black","stroke-opacity":l*i,"stroke-width":a,transform:"translate"+c,fill:$}),n&&(jt(s,"height",u(jt(s,"height")-a,0)),s.cutHeight=a),t?t.element.appendChild(s):o.parentNode.insertBefore(s,o),r.push(s);this.shadows=r}return this},xGetter:function(e){return this.element.nodeName==="circle"&&(e={x:"cx",y:"cy"}[e]||e),this._defaultGetter(e)},_defaultGetter:function(e){var t=It(this[e],this.element?this.element.getAttribute(e):null,0);return/^[0-9\.]+$/.test(t)&&(t=parseFloat(t)),t},dSetter:function(e,t,n){e&&e.join&&(e=e.join(" ")),/(NaN| {2}|^$)/.test(e)&&(e="M 0 0"),n.setAttribute(t,e),this[t]=e},dashstyleSetter:function(e){var t;e=e&&e.toLowerCase();if(e){e=e.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(","),t=e.length;while(t--)e[t]=Lt(e[t])*this.element.getAttribute("stroke-width");e=e.join(","),this.element.setAttribute("stroke-dasharray",e)}},alignSetter:function(e){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[e])},opacitySetter:function(e,t,n){this[t]=e,n.setAttribute(t,e)},"stroke-widthSetter":function(e,t,n){e===0&&(e=1e-5),this.strokeWidth=e,n.setAttribute(t,e)},titleSetter:function(e){var n=this.element.getElementsByTagName("title")[0];n||(n=t.createElementNS(E,"title"),this.element.appendChild(n)),n.textContent=e},textSetter:function(e){e!==this.textStr&&(delete this.bBox,this.textStr=e,this.added&&this.renderer.buildText(this))},fillSetter:function(e,t,n){typeof e=="string"?n.setAttribute(t,e):e&&this.colorGradient(e,t,n)},zIndexSetter:function(e,t,n){n.setAttribute(t,e),this[t]=e},_defaultSetter:function(e,t,n){n.setAttribute(t,e)}},Mn.prototype.yGetter=Mn.prototype.xGetter,Mn.prototype.translateXSetter=Mn.prototype.translateYSetter=Mn.prototype.rotationSetter=Mn.prototype.verticalAlignSetter=Mn.prototype.scaleXSetter=Mn.prototype.scaleYSetter=function(e,t){this[t]=e,this.doTransform=!0},Mn.prototype.strokeSetter=Mn.prototype.fillSetter;var _n=function(){this.init.apply(this,arguments)};_n.prototype={Element:Mn,init:function(e,r,i,s,u){var a=this,f=location,l,c,h;l=a.createElement("svg").attr({version:"1.1"}).css(this.getStyle(s)),c=l.element,e.appendChild(c),e.innerHTML.indexOf("xmlns")===-1&&jt(c,"xmlns",E),a.isSVG=!0,a.box=c,a.boxWrapper=l,a.alignedObjects=[],a.url=(b||y)&&t.getElementsByTagName("base").length?f.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",h=this.createElement("desc").add(),h.element.appendChild(t.createTextNode("Created with "+F+" "+I)),a.defs=this.createElement("defs").add(),a.forExport=u,a.gradients={},a.cache={},a.setSize(r,i,!1);var p,d;b&&e.getBoundingClientRect&&(a.subPixelFix=p=function(){qt(e,{left:0,top:0}),d=e.getBoundingClientRect(),qt(e,{left:o(d.left)-d.left+V,top:o(d.top)-d.top+V})},p(),vn(n,"resize",p))},getStyle:function(e){return this.style=Nt({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},e)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var e=this,t=e.defs;return e.box=null,e.boxWrapper=e.boxWrapper.destroy(),en(e.gradients||{}),e.gradients=null,t&&(e.defs=t.destroy()),e.subPixelFix&&mn(n,"resize",e.subPixelFix),e.alignedObjects=null,null},createElement:function(e){var t=new this.Element;return t.init(this,e),t},draw:function(){},buildText:function(e){var n=e.element,r=this,i=r.forExport,s=It(e.textStr,"").toString(),o=s.indexOf("<")!==-1,u,a=n.childNodes,f,l,c=jt(n,"x"),h=e.styles,p=e.textWidth,d=h&&h.lineHeight,v=a.length,m=function(e){return d?Lt(d):r.fontMetrics(/(px|em)$/.test(e&&e.style.fontSize)?e.style.fontSize:h&&h.fontSize||r.style.fontSize||12).h};while(v--)n.removeChild(a[v]);if(!o&&s.indexOf(" ")===-1){n.appendChild(t.createTextNode(s));return}f=/<.*style="([^"]+)".*>/,l=/<.*href="(http[^"]+)".*>/,p&&!e.added&&this.box.appendChild(n),o?u=s.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):u=[s],u[u.length-1]===""&&u.pop(),cn(u,function(s,o){var u,a=0;s=s.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),u=s.split("|||"),cn(u,function(s){if(s!==""||u.length===1){var d={},v=t.createElementNS(E,"tspan"),g;f.test(s)&&(g=s.match(f)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),jt(v,"style",g)),l.test(s)&&!i&&(jt(v,"onclick",'location.href="'+s.match(l)[1]+'"'),qt(v,{cursor:"pointer"})),s=(s.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">");if(s!==" "){v.appendChild(t.createTextNode(s)),a?d.dx=0:o&&c!==null&&(d.x=c),jt(v,d),!a&&o&&(!S&&i&&qt(v,{display:"block"}),jt(v,"dy",m(v),y&&v.offsetHeight)),n.appendChild(v),a++;if(p){var b=s.replace(/([^\^])-/g,"$1- ").split(" "),w=b.length>1&&h.whiteSpace!=="nowrap",x,T,N=e._clipHeight,C=[],k=m(),L=1,A;while(w&&(b.length||C.length))delete e.bBox,A=e.getBBox(),T=A.width,!S&&r.forExport&&(T=r.measureSpanWidth(v.firstChild.data,e.styles)),x=T>p,!x||b.length===1?(b=C,C=[],b.length&&(L++,N&&L*k>N?(b=["..."],e.attr("title",e.textStr)):(v=t.createElementNS(E,"tspan"),jt(v,{dy:k,x:c}),g&&jt(v,"style",g),n.appendChild(v),T>p&&(p=T)))):(v.removeChild(v.firstChild),C.unshift(b.pop())),b.length&&v.appendChild(t.createTextNode(b.join(" ").replace(/- /g,"-")))}}}})})},button:function(e,t,n,r,i,s,o,u,a){var f=this.label(e,t,n,a,null,null,null,null,"button"),l=0,c,h,p,d,v,g,y={x1:0,y1:0,x2:0,y2:1};return i=Ct({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:y,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},i),p=i.style,delete i.style,s=Ct(i,{stroke:"#68A",fill:{linearGradient:y,stops:[[0,"#FFF"],[1,"#ACF"]]}},s),d=s.style,delete s.style,o=Ct(i,{stroke:"#68A",fill:{linearGradient:y,stops:[[0,"#9BD"],[1,"#CDF"]]}},o),v=o.style,delete o.style,u=Ct(i,{style:{color:"#CCC"}},u),g=u.style,delete u.style,vn(f.element,m?"mouseover":"mouseenter",function(){l!==3&&f.attr(s).css(d)}),vn(f.element,m?"mouseout":"mouseleave",function(){l!==3&&(c=[i,s,o][l],h=[p,d,v][l],f.attr(c).css(h))}),f.setState=function(e){f.state=l=e,e?e===2?f.attr(o).css(v):e===3&&f.attr(u).css(g):f.attr(i).css(p)},f.on("click",function(){l!==3&&r.call(f)}).attr(i).css(Nt({cursor:"default"},p))},crispLine:function(e,t){return e[1]===e[4]&&(e[1]=e[4]=i(e[1])-t%2/2),e[2]===e[5]&&(e[2]=e[5]=i(e[2])+t%2/2),e},path:function(e){var t={fill:$};return Mt(e)?t.d=e:Ot(e)&&Nt(t,e),this.createElement("path").attr(t)},circle:function(e,t,n){var r=Ot(e)?e:{x:e,y:t,r:n},i=this.createElement("circle");return i.xSetter=function(e){this.element.setAttribute("cx",e)},i.ySetter=function(e){this.element.setAttribute("cy",e)},i.attr(r)},arc:function(e,t,n,r,i,s){var o;return Ot(e)&&(t=e.y,n=e.r,r=e.innerR,i=e.start,s=e.end,e=e.x),o=this.symbol("arc",e||0,t||0,n||0,n||0,{innerR:r||0,start:i||0,end:s||0}),o.r=n,o},rect:function(t,n,r,i,s,o){s=Ot(t)?t.r:s;var a=this.createElement("rect"),f=Ot(t)?t:t===e?{}:{x:t,y:n,width:u(r,0),height:u(i,0)};return o!==e&&(f.strokeWidth=o,f=a.crisp(f)),s&&(f.r=s),a.rSetter=function(e){jt(this.element,{rx:e,ry:e})},a.attr(f)},setSize:function(e,t,n){var r=this,i=r.alignedObjects,s=i.length;r.width=e,r.height=t,r.boxWrapper[It(n,!0)?"animate":"attr"]({width:e,height:t});while(s--)i[s].align()},g:function(e){var t=this.createElement("g");return Bt(e)?t.attr({"class":W+e}):t},image:function(e,t,n,r,i){var s={preserveAspectRatio:$},o;return arguments.length>1&&Nt(s,{x:t,y:n,width:r,height:i}),o=this.createElement("image").attr(s),o.element.setAttributeNS?o.element.setAttributeNS("http://www.w3.org/1999/xlink","href",e):o.element.setAttribute("hc-svg-href",e),o},symbol:function(e,t,n,r,s,o){var u,a=this.symbols[e],f=a&&a(i(t),i(n),r,s,o),l,c=/^url\((.*?)\)$/,h,p,d;return f?(u=this.path(f),Nt(u,{symbolName:e,x:t,y:n,width:r,height:s}),o&&Nt(u,o)):c.test(e)&&(d=function(e,t){e.element&&(e.attr({width:t[0],height:t[1]}),e.alignByTranslate||e.translate(i((r-t[0])/2),i((s-t[1])/2)))},h=e.match(c)[1],p=k[h],u=this.image(h).attr({x:t,y:n}),u.isImg=!0,p?d(u,p):(u.attr({width:0,height:0}),l=Rt("img",{onload:function(){d(u,k[h]=[this.width,this.height])},src:h}))),u},symbols:{circle:function(e,t,n,r){var i=.166*n;return[J,e+n/2,t,"C",e+n+i,t,e+n+i,t+r,e+n/2,t+r,"C",e-i,t+r,e-i,t,e+n/2,t,"Z"]},square:function(e,t,n,r){return[J,e,t,K,e+n,t,e+n,t+r,e,t+r,"Z"]},triangle:function(e,t,n,r){return[J,e+n/2,t,K,e+n,t+r,e,t+r,"Z"]},"triangle-down":function(e,t,n,r){return[J,e,t,K,e+n,t,e+n/2,t+r,"Z"]},diamond:function(e,t,n,r){return[J,e+n/2,t,K,e+n,t+r/2,e+n/2,t+r,e,t+r/2,"Z"]},arc:function(e,t,n,r,i){var s=i.start,o=i.r||n||r,u=i.end-.001,a=i.innerR,f=i.open,p=l(s),d=c(s),v=l(u),m=c(u),g=i.end-s<h?0:1;return[J,e+o*p,t+o*d,"A",o,o,0,g,1,e+o*v,t+o*m,f?J:K,e+a*v,t+a*m,"A",a,a,0,g,0,e+a*p,t+a*d,f?"":"Z"]},callout:function(e,t,n,r,s){var o=6,u=6,f=a(s&&s.r||0,n,r),l=f+u,c=s&&s.anchorX,h=s&&s.anchorY,p,d=i(s.strokeWidth||0)%2/2;return e+=d,t+=d,p=["M",e+f,t,"L",e+n-f,t,"C",e+n,t,e+n,t,e+n,t+f,"L",e+n,t+r-f,"C",e+n,t+r,e+n,t+r,e+n-f,t+r,"L",e+f,t+r,"C",e,t+r,e,t+r,e,t+r-f,"L",e,t+f,"C",e,t,e,t,e+f,t],c&&c>n&&h>t+l&&h<t+r-l?p.splice(13,3,"L",e+n,h-u,e+n+o,h,e+n,h+u,e+n,t+r-f):c&&c<0&&h>t+l&&h<t+r-l?p.splice(33,3,"L",e,h+u,e-o,h,e,h-u,e,t+f):h&&h>r&&c>e+l&&c<e+n-l?p.splice(23,3,"L",c+u,t+r,c,t+r+o,c-u,t+r,e+f,t+r):h&&h<0&&c>e+l&&c<e+n-l&&p.splice(3,3,"L",c-u,t,c,t-o,c+u,t,n-f,t),p}},clipRect:function(e,t,n,r){var i,s=W+L++,o=this.createElement("clipPath").attr({id:s}).add(this.defs);return i=this.rect(e,t,n,r,0).add(o),i.id=s,i.clipPath=o,i},text:function(e,t,n,r){var i=this,s=T||!S&&i.forExport,o,u={};if(r&&!i.forExport)return i.html(e,t,n);u.x=Math.round(t||0),n&&(u.y=Math.round(n));if(e||e===0)u.text=e;return o=i.createElement("text").attr(u),s&&o.css({position:R}),r||(o.xSetter=function(e,t,n){var r=n.childNodes,i,s;for(s=1;s<r.length;s++)i=r[s],i.getAttribute("x")===n.getAttribute("x")&&i.setAttribute("x",e);n.setAttribute(t,e)}),o},fontMetrics:function(e){e=e||this.style.fontSize,e=/px/.test(e)?Lt(e):/em/.test(e)?parseFloat(e)*12:12;var t=e<24?e+4:i(e*1.2),n=i(t*.8);return{h:t,b:n}},label:function(t,n,r,s,o,u,a,f,l){function k(){var e,t,n=p.element.style;v=(b===undefined||w===undefined||h.styles.textAlign)&&p.textStr&&p.getBBox(),h.width=(b||v.width||0)+2*g+y,h.height=(w||v.height||0)+2*g,N=g+c.fontMetrics(n&&n.fontSize).b,C&&(d||(e=i(-m*g),t=f?-N:0,h.box=d=s?c.symbol(s,e,t,h.width,h.height,T):c.rect(e,t,h.width,h.height,0,T[ft]),d.attr("fill",$).add(h)),d.isImg||d.attr(Nt({width:i(h.width),height:i(h.height)},T)),T=null)}function L(){var t=h.styles,n=t&&t.textAlign,r=y+g*(1-m),i;i=f?0:N,Bt(b)&&v&&(n==="center"||n==="right")&&(r+={center:.5,right:1}[n]*(b-v.width));if(r!==p.x||i!==p.y)p.attr("x",r),i!==e&&p.attr("y",i);p.x=r,p.y=i}function A(e,t){d?d.attr(e,t):T[e]=t}var c=this,h=c.g(l),p=c.text("",0,0,a).attr({zIndex:1}),d,v,m=0,g=3,y=0,b,w,E,S,x=0,T={},N,C;h.onAdd=function(){p.add(h),h.attr({text:t||"",x:n,y:r}),d&&Bt(o)&&h.attr({anchorX:o,anchorY:u})},h.widthSetter=function(e){b=e},h.heightSetter=function(e){w=e},h.paddingSetter=function(e){Bt(e)&&e!==g&&(g=e,L())},h.paddingLeftSetter=function(e){Bt(e)&&e!==y&&(y=e,L())},h.alignSetter=function(e){m={left:0,center:.5,right:1}[e]},h.textSetter=function(t){t!==e&&p.textSetter(t),k(),L()},h["stroke-widthSetter"]=function(e,t){e&&(C=!0),x=e%2/2,A(t,e)},h.strokeSetter=h.fillSetter=h.rSetter=function(e,t){t==="fill"&&e&&(C=!0),A(t,e)},h.anchorXSetter=function(e,t){o=e,A(t,e+x-E)},h.anchorYSetter=function(e,t){u=e,A(t,e-S)},h.xSetter=function(e){h.x=e,m&&(e-=m*((b||v.width)+g)),E=i(e),h.attr("translateX",E)},h.ySetter=function(e){S=h.y=i(e),h.attr("translateY",S)};var O=h.css;return Nt(h,{css:function(t){if(t){var n={};t=Ct(t),cn(["fontSize","fontWeight","fontFamily","color","lineHeight","width","textDecoration","textShadow"],function(r){t[r]!==e&&(n[r]=t[r],delete t[r])}),p.css(n)}return O.call(h,t)},getBBox:function(){return{width:v.width+2*g,height:v.height+2*g,x:v.x-g,y:v.y-g}},shadow:function(e){return d&&d.shadow(e),h},destroy:function(){mn(h.element,"mouseenter"),mn(h.element,"mouseleave"),p&&(p=p.destroy()),d&&(d=d.destroy()),Mn.prototype.destroy.call(h),h=c=k=L=A=null}})}},N=_n,Nt(Mn.prototype,{htmlCss:function(e){var t=this,n=t.element,r=e&&n.tagName==="SPAN"&&e.width;return r&&(delete e.width,t.textWidth=r,t.updateTransform()),t.styles=Nt(t.styles,e),qt(t.element,e),t},htmlGetBBox:function(){var e=this,t=e.element,n=e.bBox;return n||(t.nodeName==="text"&&(t.style.position=R),n=e.bBox={x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}),n},htmlUpdateTransform:function(){if(!this.added){this.alignOnAdd=!0;return}var e=this,t=e.renderer,n=e.element,r=e.translateX||0,i=e.translateY||0,s=e.x||0,o=e.y||0,u=e.textAlign||"left",a={left:0,center:.5,right:1}[u],f=e.shadows;qt(n,{marginLeft:r,marginTop:i}),f&&cn(f,function(e){qt(e,{marginLeft:r+1,marginTop:i+1})}),e.inverted&&cn(n.childNodes,function(e){t.invertChild(e,n)});if(n.tagName==="SPAN"){var l,c=e.rotation,h,p=Lt(e.textWidth),d=[c,u,n.innerHTML,e.textWidth].join(",");d!==e.cTT&&(h=t.fontMetrics(n.style.fontSize).b,Bt(c)&&e.setSpanRotation(c,a,h),l=It(e.elemWidth,n.offsetWidth),l>p&&/[ \-]/.test(n.textContent||n.innerText)&&(qt(n,{width:p+V,display:"block",whiteSpace:"normal"}),l=p),e.getSpanCorrection(l,h,a,c,u)),qt(n,{left:s+(e.xCorr||0)+V,top:o+(e.yCorr||0)+V}),y&&(h=n.offsetHeight),e.cTT=d}},setSpanRotation:function(e,t,n){var r={},i=m?"-ms-transform":y?"-webkit-transform":b?"MozTransform":v?"-o-transform":"";r[i]=r.transform="rotate("+e+"deg)",r[i+(b?"Origin":"-origin")]=r.transformOrigin=t*100+"% "+n+"px",qt(this.element,r)},getSpanCorrection:function(e,t,n){this.xCorr=-e*n,this.yCorr=-t}}),Nt(_n.prototype,{html:function(e,t,n){var r=this.createElement("span"),s=r.element,o=r.renderer;return r.textSetter=function(e){e!==s.innerHTML&&delete this.bBox,s.innerHTML=this.textStr=e},r.xSetter=r.ySetter=r.alignSetter=r.rotationSetter=function(e,t){t==="align"&&(t="textAlign"),r[t]=e,r.htmlUpdateTransform()},r.attr({text:e,x:i(t),y:i(n)}).css({position:R,whiteSpace:"nowrap",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),r.css=r.htmlCss,o.isSVG&&(r.add=function(e){var t,n=o.box.parentNode,i,u=[];this.parentGroup=e;if(e){t=e.div;if(!t){i=e;while(i)u.push(i),i=i.parentGroup;cn(u.reverse(),function(e){var r;t=e.div=e.div||Rt(q,{className:jt(e.element,"class")},{position:R,left:(e.translateX||0)+V,top:(e.translateY||0)+V},t||n),r=t.style,Nt(e,{translateXSetter:function(t,n){r.left=t+V,e[n]=t,e.doTransform=!0},translateYSetter:function(t,n){r.top=t+V,e[n]=t,e.doTransform=!0},visibilitySetter:function(e,t){r[t]=e}})})}}else t=n;return t.appendChild(s),r.added=!0,r.alignOnAdd&&r.htmlUpdateTransform(),r}),r}});var Dn,Pn;if(!S&&!T){Tt.VMLElement=Pn={init:function(e,t){var n=this,r=["<",t,' filled="f" stroked="f"'],i=["position: ",R,";"],s=t===q;(t==="shape"||s)&&i.push("left:0;top:0;width:1px;height:1px;"),i.push("visibility: ",s?z:X),r.push(' style="',i.join(""),'"/>'),t&&(r=s||t==="span"||t==="img"?r.join(""):e.prepVML(r),n.element=Rt(r)),n.renderer=e},add:function(e){var t=this,n=t.renderer,r=t.element,i=n.box,s=e&&e.inverted,o=e?e.element||e:i;return s&&n.invertChild(r,o),o.appendChild(r),t.added=!0,t.alignOnAdd&&!t.deferUpdateTransform&&t.updateTransform(),t.onAdd&&t.onAdd(),t},updateTransform:Mn.prototype.htmlUpdateTransform,setSpanRotation:function(){var e=this.rotation,t=l(e*p),n=c(e*p);qt(this.element,{filter:e?["progid:DXImageTransform.Microsoft.Matrix(M11=",t,", M12=",-n,", M21=",n,", M22=",t,", sizingMethod='auto expand')"].join(""):$})},getSpanCorrection:function(e,t,n,r,i){var s=r?l(r*p):1,o=r?c(r*p):0,u=It(this.elemHeight,this.element.offsetHeight),a,f=i&&i!=="left";this.xCorr=s<0&&-e,this.yCorr=o<0&&-u,a=s*o<0,this.xCorr+=o*t*(a?1-n:n),this.yCorr-=s*t*(r?a?n:1-n:1),f&&(this.xCorr-=e*n*(s<0?-1:1),r&&(this.yCorr-=u*n*(o<0?-1:1)),qt(this.element,{textAlign:i}))},pathToVML:function(e){var t=e.length,n=[];while(t--)_t(e[t])?n[t]=i(e[t]*10)-5:e[t]==="Z"?n[t]="x":(n[t]=e[t],e.isArc&&(e[t]==="wa"||e[t]==="at")&&(n[t+5]===n[t+7]&&(n[t+7]+=e[t+7]>e[t+5]?1:-1),n[t+6]===n[t+8]&&(n[t+8]+=e[t+8]>e[t+6]?1:-1)));return n.join(" ")||"x"},clip:function(e){var t=this,n,r;return e?(n=e.members,Ht(n,t),n.push(t),t.destroyClip=function(){Ht(n,t)},r=e.getCSS(t)):(t.destroyClip&&t.destroyClip(),r={clip:g?"inherit":"rect(auto)"}),t.css(r)},css:Mn.prototype.htmlCss,safeRemoveChild:function(e){e.parentNode&&tn(e)},destroy:function(){return this.destroyClip&&this.destroyClip(),Mn.prototype.destroy.apply(this)},on:function(e,t){return this.element["on"+e]=function(){var e=n.event;e.target=e.srcElement,t(e)},this},cutOffPath:function(e,t){var n;e=e.split(/[ ,]/),n=e.length;if(n===9||n===11)e[n-4]=e[n-2]=Lt(e[n-2])-10*t;return e.join(" ")},shadow:function(e,t,n){var r=[],i,s=this.element,o=this.renderer,u,a=s.style,f,l=s.path,c,h,p,d;l&&typeof l.value!="string"&&(l="x"),h=l;if(e){p=It(e.width,3),d=(e.opacity||.15)/p;for(i=1;i<=3;i++)c=p*2+1-2*i,n&&(h=this.cutOffPath(l.value,c+.5)),f=['<shape isShadow="true" strokeweight="',c,'" filled="false" path="',h,'" coordsize="10 10" style="',s.style.cssText,'" />'],u=Rt(o.prepVML(f),null,{left:Lt(a.left)+It(e.offsetX,1),top:Lt(a.top)+It(e.offsetY,1)}),n&&(u.cutOff=c+1),f=['<stroke color="',e.color||"black",'" opacity="',d*i,'"/>'],Rt(o.prepVML(f),null,null,u),t?t.element.appendChild(u):s.parentNode.insertBefore(u,s),r.push(u);this.shadows=r}return this},updateShadows:H,setAttr:function(e,t){g?this.element[e]=t:this.element.setAttribute(e,t)},classSetter:function(e){this.element.className=e},dashstyleSetter:function(e,t,n){var r=n.getElementsByTagName("stroke")[0]||Rt(this.renderer.prepVML(["<stroke/>"]),null,null,n);r[t]=e||"solid",this[t]=e},dSetter:function(e,t,n){var r,i=this.shadows;e=e||[],this.d=e.join(" "),n.path=e=this.pathToVML(e);if(i){r=i.length;while(r--)i[r].path=i[r].cutOff?this.cutOffPath(e,i[r].cutOff):e}this.setAttr(t,e)},fillSetter:function(e,t,n){var r=n.nodeName;r==="SPAN"?n.style.color=e:r!=="IMG"&&(n.filled=e!==$,this.setAttr("fillcolor",this.renderer.color(e,n,t,this)))},opacitySetter:H,rotationSetter:function(e,t,n){var r=n.style;this[t]=r[t]=e,r.left=-i(c(e*p)+1)+V,r.top=i(l(e*p))+V},strokeSetter:function(e,t,n){this.setAttr("strokecolor",this.renderer.color(e,n,t))},"stroke-widthSetter":function(e,t,n){n.stroked=!!e,this[t]=e,_t(e)&&(e+=V),this.setAttr("strokeweight",e)},titleSetter:function(e,t){this.setAttr(t,e)},visibilitySetter:function(e,t,n){e==="inherit"&&(e=X),this.shadows&&cn(this.shadows,function(n){n.style[t]=e}),n.nodeName==="DIV"&&(e=e===z?"-999em":0,g||(n.style[t]=e?X:z),t="top"),n.style[t]=e},xSetter:function(e,t,n){this[t]=e,t==="x"?t="left":t==="y"&&(t="top"),this.updateClipping?(this[t]=e,this.updateClipping()):n.style[t]=e},zIndexSetter:function(e,t,n){n.style[t]=e}},Pn=Ut(Mn,Pn),Pn.prototype.ySetter=Pn.prototype.widthSetter=Pn.prototype.heightSetter=Pn.prototype.xSetter;var Hn={Element:Pn,isIE8:d.indexOf("MSIE 8.0")>-1,init:function(e,n,r,i){var s=this,o,u,a;s.alignedObjects=[],o=s.createElement(q).css(Nt(this.getStyle(i),{position:U})),u=o.element,e.appendChild(o.element),s.isVML=!0,s.box=u,s.boxWrapper=o,s.cache={},s.setSize(n,r,!1);if(!t.namespaces.hcv){t.namespaces.add("hcv","urn:schemas-microsoft-com:vml"),a="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } ";try{t.createStyleSheet().cssText=a}catch(f){t.styleSheets[0].cssText+=a}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(e,t,n,r){var s=this.createElement(),o=Ot(e);return Nt(s,{members:[],left:(o?e.x:e)+1,top:(o?e.y:t)+1,width:(o?e.width:n)-1,height:(o?e.height:r)-1,getCSS:function(e){var t=e.element,n=t.nodeName,r=n==="shape",s=e.inverted,o=this,u=o.top-(r?t.offsetTop:0),a=o.left,f=a+o.width,l=u+o.height,c={clip:"rect("+i(s?a:u)+"px,"+i(s?l:f)+"px,"+i(s?f:l)+"px,"+i(s?u:a)+"px)"};return!s&&g&&n==="DIV"&&Nt(c,{width:f+V,height:l+V}),c},updateClipping:function(){cn(s.members,function(e){e.element&&e.css(s.getCSS(e))})}})},color:function(e,t,n,i){var s=this,o,u=/^rgba/,a,f,l=$;e&&e.linearGradient?f="gradient":e&&e.radialGradient&&(f="pattern");if(f){var c,p,d=e.linearGradient||e.radialGradient,v,m,g,y,b,w,E,S,x="",T=e.stops,N,C,k=[],L=function(){a=['<fill colors="'+k.join(",")+'" opacity="',w,'" o:opacity2="',b,'" type="',f,'" ',x,'focus="100%" method="any" />'],Rt(s.prepVML(a),null,null,t)};N=T[0],C=T[T.length-1],N[0]>0&&T.unshift([0,N[1]]),C[0]<1&&T.push([1,C[1]]),cn(T,function(e,t){u.test(e[1])?(o=On(e[1]),c=o.get("rgb"),p=o.get("a")):(c=e[1],p=1),k.push(e[0]*100+"% "+c),t?(w=p,E=c):(b=p,S=c)});if(n==="fill")if(f==="gradient")v=d.x1||d[0]||0,m=d.y1||d[1]||0,g=d.x2||d[2]||0,y=d.y2||d[3]||0,x='angle="'+(90-r.atan((y-m)/(g-v))*180/h)+'"',L();else{var A=d.r,M=A*2,_=A*2,D=d.cx,P=d.cy,H=t.radialReference,B,j=function(){H&&(B=i.getBBox(),D+=(H[0]-B.x)/B.width-.5,P+=(H[1]-B.y)/B.height-.5,M*=H[2]/B.width,_*=H[2]/B.height),x='src="'+O.global.VMLRadialGradientURL+'" '+'size="'+M+","+_+'" '+'origin="0.5,0.5" '+'position="'+D+","+P+'" '+'color2="'+S+'" ',L()};i.added?j():i.onAdd=j,l=E}else l=c}else if(u.test(e)&&t.tagName!=="IMG")o=On(e),a=["<",n,' opacity="',o.get("a"),'"/>'],Rt(this.prepVML(a),null,null,t),l=o.get("rgb");else{var F=t.getElementsByTagName(n);F.length&&(F[0].opacity=1,F[0].type="solid"),l=e}return l},prepVML:function(e){var t="display:inline-block;behavior:url(#default#VML);",n=this.isIE8;return e=e.join(""),n?(e=e.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),e.indexOf('style="')===-1?e=e.replace("/>",' style="'+t+'" />'):e=e.replace('style="','style="'+t)):e=e.replace("<","<hcv:"),e},text:_n.prototype.html,path:function(e){var t={coordsize:"10 10"};return Mt(e)?t.d=e:Ot(e)&&Nt(t,e),this.createElement("shape").attr(t)},circle:function(e,t,n){var r=this.symbol("circle");return Ot(e)&&(n=e.r,t=e.y,e=e.x),r.isCircle=!0,r.r=n,r.attr({x:e,y:t})},g:function(e){var t,n;return e&&(n={className:W+e,"class":W+e}),t=this.createElement(q).attr(n),t},image:function(e,t,n,r,i){var s=this.createElement("img").attr({src:e});return arguments.length>1&&s.attr({x:t,y:n,width:r,height:i}),s},createElement:function(e){return e==="rect"?this.symbol(e):_n.prototype.createElement.call(this,e)},invertChild:function(e,t){var n=this,r=t.style,i=e.tagName==="IMG"&&e.style;qt(e,{flip:"x",left:Lt(r.width)-(i?Lt(i.top):1),top:Lt(r.height)-(i?Lt(i.left):1),rotation:-90}),cn(e.childNodes,function(t){n.invertChild(t,e)})},symbols:{arc:function(e,t,n,r,i){var s=i.start,o=i.end,u=i.r||n||r,a=i.innerR,f=l(s),h=c(s),p=l(o),d=c(o),v;return o-s===0?["x"]:(v=["wa",e-u,t-u,e+u,t+u,e+u*f,t+u*h,e+u*p,t+u*d],i.open&&!a&&v.push("e",J,e,t),v.push("at",e-a,t-a,e+a,t+a,e+a*p,t+a*d,e+a*f,t+a*h,"x","e"),v.isArc=!0,v)},circle:function(e,t,n,r,i){return i&&(n=r=2*i.r),i&&i.isCircle&&(e-=n/2,t-=r/2),["wa",e,t,e+n,t+r,e+n,t+r/2,e+n,t+r/2,"e"]},rect:function(e,t,n,r,i){return _n.prototype.symbols[!Bt(i)||!i.r?"square":"callout"].call(0,e,t,n,r,i)}}};Tt.VMLRenderer=Dn=function(){this.init.apply(this,arguments)},Dn.prototype=Ct(_n.prototype,Hn),N=Dn}_n.prototype.measureSpanWidth=function(e,n){var r=t.createElement("span"),i,s=t.createTextNode(e);return r.appendChild(s),qt(r,n),this.box.appendChild(r),i=r.offsetWidth,tn(r),i};var Bn,jn;T&&(Tt.CanVGRenderer=Bn=function(){E="http://www.w3.org/1999/xhtml"},Bn.prototype.symbols={},jn=function(){function t(){var t=e.length,n;for(n=0;n<t;n++)e[n]();e=[]}var e=[];return{push:function(n,r){e.length===0&&fn(r,t),e.push(n)}}}(),N=Bn),Fn.prototype={addLabel:function(){var e=this,t=e.axis,n=t.options,r=t.chart,s=t.horiz,o=t.categories,a=t.names,f=e.pos,l=n.labels,c,h=t.tickPositions,p=s&&o&&!l.step&&!l.staggerLines&&!l.rotation&&r.plotWidth/h.length||!s&&(r.margin[3]||r.chartWidth*.33),d=f===h[0],v=f===h[h.length-1],m,g,y=o?It(o[f],a[f],f):f,b=e.label,w=h.info,E;t.isDatetimeAxis&&w&&(E=n.dateTimeLabelFormats[w.higherRanks[f]||w.unitName]),e.isFirst=d,e.isLast=v,c=t.labelFormatter.call({axis:t,chart:r,isFirst:d,isLast:v,dateTimeLabelFormat:E,value:t.isLog?rn(Pt(y)):y}),m=p&&{width:u(1,i(p-2*(l.padding||10)))+V},m=Nt(m,l.style),Bt(b)?b&&b.attr({text:c}).css(m):(g={align:t.labelAlign},_t(l.rotation)&&(g.rotation=l.rotation),p&&l.ellipsis&&(g._clipHeight=t.len/h.length),e.label=Bt(c)&&l.enabled?r.renderer.text(c,0,0,l.useHTML).attr(g).css(m).add(t.labelGroup):null)},getLabelSize:function(){var e=this.label,t=this.axis;return e?e.getBBox()[t.horiz?"height":"width"]:0},getLabelSides:function(){var e=this.label.getBBox(),t=this.axis,n=t.horiz,r=t.options,i=r.labels,s=n?e.width:e.height,o=n?i.x-s*{left:0,center:.5,right:1}[t.labelAlign]:0,u=n?s+o:s;return[o,u]},handleOverflow:function(t,n){var r=!0,i=this.axis,s=this.isFirst,o=this.isLast,u=i.horiz,a=u?n.x:n.y,f=i.reversed,l=i.tickPositions,c=this.getLabelSides(),h=c[0],p=c[1],d,v,m,g,y=this.label.line||0,b=i.labelEdge,w=i.justifyLabels&&(s||o),E;b[y]===e||a+h>b[y]?b[y]=a+p:w||(r=!1);if(w){E=i.justifyToPlot,d=E?i.pos:0,v=E?d+i.len:i.chart.chartWidth;do t+=s?1:-1,m=i.ticks[l[t]];while(l[t]&&(!m||m.label.line!==y));g=m&&m.label.xy&&m.label.xy.x+m.getLabelSides()[s?0:1],s&&!f||o&&f?a+h<d&&(a=d-h,m&&a+p>g&&(r=!1)):a+p>v&&(a=v-p,m&&a+h<g&&(r=!1)),n.x=a}return r},getPosition:function(e,t,n,r){var i=this.axis,s=i.chart,o=r&&s.oldChartHeight||s.chartHeight;return{x:e?i.translate(t+n,null,null,r)+i.transB:i.left+i.offset+(i.opposite?(r&&s.oldChartWidth||s.chartWidth)-i.right-i.left:0),y:e?o-i.bottom+i.offset-(i.opposite?i.height:0):o-i.translate(t+n,null,null,r)-i.transB}},getLabelPosition:function(e,t,n,r,i,s,o,u){var a=this.axis,f=a.transA,c=a.reversed,h=a.staggerLines,d=a.chart.renderer.fontMetrics(i.style.fontSize).b,v=i.rotation;return e=e+i.x-(s&&r?s*f*(c?-1:1):0),t=t+i.y-(s&&!r?s*f*(c?1:-1):0),v&&a.side===2&&(t-=d-d*l(v*p)),!Bt(i.y)&&!v&&(t+=d-n.getBBox().height/2),h&&(n.line=o/(u||1)%h,t+=n.line*(a.labelOffset/h)),{x:e,y:t}},getMarkPath:function(e,t,n,r,i,s){return s.crispLine([J,e,t,K,e+(i?0:-n),t+(i?n:0)],r)},render:function(t,n,r){var i=this,s=i.axis,o=s.options,u=s.chart,a=u.renderer,f=s.horiz,l=i.type,c=i.label,h=i.pos,p=o.labels,d=i.gridLine,v=l?l+"Grid":"grid",m=l?l+"Tick":"tick",g=o[v+"LineWidth"],y=o[v+"LineColor"],b=o[v+"LineDashStyle"],w=o[m+"Length"],E=o[m+"Width"]||0,S=o[m+"Color"],x=o[m+"Position"],T,N=i.mark,C,k=p.step,L,A=!0,O=s.tickmarkOffset,M=i.getPosition(f,h,O,n),_=M.x,D=M.y,P=f&&_===s.pos+s.len||!f&&D===s.pos?-1:1;this.isActive=!0,g&&(T=s.getPlotLinePath(h+O,g*P,n,!0),d===e&&(L={stroke:y,"stroke-width":g},b&&(L.dashstyle=b),l||(L.zIndex=1),n&&(L.opacity=0),i.gridLine=d=g?a.path(T).attr(L).add(s.gridGroup):null),!n&&d&&T&&d[i.isNew?"attr":"animate"]({d:T,opacity:r})),E&&w&&(x==="inside"&&(w=-w),s.opposite&&(w=-w),C=i.getMarkPath(_,D,w,E*P,f,a),N?N.animate({d:C,opacity:r}):i.mark=a.path(C).attr({stroke:S,"stroke-width":E,opacity:r}).add(s.axisGroup)),c&&!isNaN(_)&&(c.xy=M=i.getLabelPosition(_,D,c,f,p,O,t,k),i.isFirst&&!i.isLast&&!It(o.showFirstLabel,1)||i.isLast&&!i.isFirst&&!It(o.showLastLabel,1)?A=!1:!s.isRadial&&!p.step&&!p.rotation&&!n&&r!==0&&(A=i.handleOverflow(t,M)),k&&t%k&&(A=!1),A&&!isNaN(M.y)?(M.opacity=r,c[i.isNew?"attr":"animate"](M),i.isNew=!1):c.attr("y",-9999))},destroy:function(){en(this,this.axis)}},Tt.PlotLineOrBand=function(e,t){this.axis=e,t&&(this.options=t,this.id=t.id)},Tt.PlotLineOrBand.prototype={render:function(){var e=this,t=e.axis,n=t.horiz,r=(t.pointRange||0)/2,i=e.options,s=i.label,o=e.label,f=i.width,l=i.to,c=i.from,h=Bt(c)&&Bt(l),p=i.value,d=i.dashStyle,v=e.svgElem,m=[],g,y,b,w,E,S,x=i.color,T=i.zIndex,N=i.events,C={},k=t.chart.renderer;t.isLog&&(c=Dt(c),l=Dt(l),p=Dt(p));if(f)m=t.getPlotLinePath(p,f),C={stroke:x,"stroke-width":f},d&&(C.dashstyle=d);else{if(!h)return;c=u(c,t.min-r),l=a(l,t.max+r),m=t.getPlotBandPath(c,l,i),x&&(C.fill=x),i.borderWidth&&(C.stroke=i.borderColor,C["stroke-width"]=i.borderWidth)}Bt(T)&&(C.zIndex=T);if(v)m?v.animate({d:m},null,v.onGetPath):(v.hide(),v.onGetPath=function(){v.show()},o&&(e.label=o=o.destroy()));else if(m&&m.length){e.svgElem=v=k.path(m).attr(C).add();if(N){g=function(t){v.on(t,function(n){N[t].apply(e,[n])})};for(y in N)g(y)}}return s&&Bt(s.text)&&m&&m.length&&t.width>0&&t.height>0?(s=Ct({align:n&&h&&"center",x:n?!h&&4:10,verticalAlign:!n&&h&&"middle",y:n?h?16:10:h?6:-4,rotation:n&&!h&&90},s),o||(C={align:s.textAlign||s.align,rotation:s.rotation},Bt(T)&&(C.zIndex=T),e.label=o=k.text(s.text,0,0,s.useHTML).attr(C).css(s.style).add()),b=[m[1],m[4],It(m[6],m[1])],w=[m[2],m[5],It(m[7],m[2])],E=Yt(b),S=Yt(w),o.align(s,!1,{x:E,y:S,width:Zt(b)-E,height:Zt(w)-S}),o.show()):o&&o.hide(),e},destroy:function(){Ht(this.axis.plotLinesAndBands,this),delete this.axis,en(this)}},at={getPlotBandPath:function(e,t){var n=this.getPlotLinePath(t),r=this.getPlotLinePath(e);return r&&n?r.push(n[4],n[5],n[1],n[2]):r=null,r},addPlotBand:function(e){this.addPlotBandOrLine(e,"plotBands")},addPlotLine:function(e){this.addPlotBandOrLine(e,"plotLines")},addPlotBandOrLine:function(e,t){var n=(new Tt.PlotLineOrBand(this,e)).render(),r=this.userOptions;return n&&(t&&(r[t]=r[t]||[],r[t].push(e)),this.plotLinesAndBands.push(n)),n},removePlotBandOrLine:function(e){var t=this.plotLinesAndBands,n=this.options,r=this.userOptions,i=t.length;while(i--)t[i].id===e&&t[i].destroy();cn([n.plotLines||[],r.plotLines||[],n.plotBands||[],r.plotBands||[]],function(t){i=t.length;while(i--)t[i].id===e&&Ht(t,t[i])})}},In.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:En,lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return zt(this.total,-1)},style:En.style}},defaultLeftAxisOptions:{labels:{x:-15,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{x:0,y:20},title:{rotation:0}},defaultTopAxisOptions:{labels:{x:0,y:-15},title:{rotation:0}},init:function(t,n){var r=n.isX,i=this;i.horiz=t.inverted?!r:r,i.isXAxis=r,i.coll=r?"xAxis":"yAxis",i.opposite=n.opposite,i.side=n.side||(i.horiz?i.opposite?0:2:i.opposite?1:3),i.setOptions(n);var s=this.options,o=s.type,u=o==="datetime";i.labelFormatter=s.labels.formatter||i.defaultLabelFormatter,i.userOptions=n,i.minPixelPadding=0,i.chart=t,i.reversed=s.reversed,i.zoomEnabled=s.zoomEnabled!==!1,i.categories=s.categories||o==="category",i.names=[],i.isLog=o==="logarithmic",i.isDatetimeAxis=u,i.isLinked=Bt(s.linkedTo),i.tickmarkOffset=i.categories&&s.tickmarkPlacement==="between"?.5:0,i.ticks={},i.labelEdge=[],i.minorTicks={},i.plotLinesAndBands=[],i.alternateBands={},i.len=0,i.minRange=i.userMinRange=s.minRange||s.maxZoom,i.range=s.range,i.offset=s.offset||0,i.stacks={},i.oldStacks={},i.max=null,i.min=null,i.crosshair=It(s.crosshair,Ft(t.options.tooltip.crosshairs)[r?0:1],!1);var a,f=i.options.events;ln(i,t.axes)===-1&&(r&&!this.isColorAxis?t.axes.splice(t.xAxis.length,0,i):t.axes.push(i),t[i.coll].push(i)),i.series=i.series||[],t.inverted&&r&&i.reversed===e&&(i.reversed=!0),i.removePlotBand=i.removePlotBandOrLine,i.removePlotLine=i.removePlotBandOrLine;for(a in f)vn(i,a,f[a]);i.isLog&&(i.val2lin=Dt,i.lin2val=Pt)},setOptions:function(e){this.options=Ct(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],Ct(O[this.coll],e))},defaultLabelFormatter:function(){var t=this.axis,n=this.value,r=t.categories,i=this.dateTimeLabelFormat,s=O.lang.numericSymbols,o=s&&s.length,u,a,l=t.options.labels.format,c=t.isLog?n:t.tickInterval;if(l)a=$t(l,this);else if(r)a=n;else if(i)a=M(i,n);else if(o&&c>=1e3)while(o--&&a===e)u=Math.pow(1e3,o+1),c>=u&&s[o]!==null&&(a=zt(n/u,-1)+s[o]);return a===e&&(f(n)>=1e4?a=zt(n,0):a=zt(n,-1,e,"")),a},getSeriesExtremes:function(){var e=this,t=e.chart;e.hasVisibleSeries=!1,e.dataMin=e.dataMax=null,e.buildStacks&&e.buildStacks(),cn(e.series,function(n){if(n.visible||!t.options.chart.ignoreHiddenSeries){var r=n.options,i,s=r.threshold,o,f;e.hasVisibleSeries=!0,e.isLog&&s<=0&&(s=null),e.isXAxis?(i=n.xData,i.length&&(e.dataMin=a(It(e.dataMin,i[0]),Yt(i)),e.dataMax=u(It(e.dataMax,i[0]),Zt(i)))):(n.getExtremes(),f=n.dataMax,o=n.dataMin,Bt(o)&&Bt(f)&&(e.dataMin=a(It(e.dataMin,o),o),e.dataMax=u(It(e.dataMax,f),f)),Bt(s)&&(e.dataMin>=s?(e.dataMin=s,e.ignoreMinPadding=!0):e.dataMax<s&&(e.dataMax=s,e.ignoreMaxPadding=!0)))}})},translate:function(e,t,n,r,i,s){var o=this,u=1,a=0,f=r?o.oldTransA:o.transA,l=r?o.oldMin:o.min,c,h=o.minPixelPadding,p=(o.options.ordinal||o.isLog&&i)&&o.lin2val;return f||(f=o.transA),n&&(u*=-1,a=o.len),o.reversed&&(u*=-1,a-=u*(o.sector||o.len)),t?(e=e*u+a,e-=h,c=e/f+l,p&&(c=o.lin2val(c))):(p&&(e=o.val2lin(e)),s==="between"&&(s=.5),c=u*(e-l)*f+a+u*h+(_t(s)?f*s*o.pointRange:0)),c},toPixels:function(e,t){return this.translate(e,!1,!this.horiz,null,!0)+(t?0:this.pos)},toValue:function(e,t){return this.translate(e-(t?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(e,t,n,r,s){var o=this,u=o.chart,a=o.left,f=o.top,l,c,h,p,d=n&&u.oldChartHeight||u.chartHeight,v=n&&u.oldChartWidth||u.chartWidth,m,g=o.transB;s=It(s,o.translate(e,null,null,n)),l=h=i(s+g),c=p=i(d-s-g);if(isNaN(s))m=!0;else if(o.horiz){c=f,p=d-o.bottom;if(l<a||l>a+o.width)m=!0}else{l=a,h=v-o.right;if(c<f||c>f+o.height)m=!0}return m&&!r?null:u.renderer.crispLine([J,l,c,K,h,p],t||1)},getLinearTickPositions:function(e,t,n){var r,i,u=rn(s(t/e)*e),a=rn(o(n/e)*e),f=[];if(t===n&&_t(t))return[t];r=u;while(r<=a){f.push(r),r=rn(r+e);if(r===i)break;i=r}return f},getMinorTickPositions:function(){var e=this,t=e.options,n=e.tickPositions,r=e.minorTickInterval,i=[],s,o,u;if(e.isLog){u=n.length;for(o=1;o<u;o++)i=i.concat(e.getLogTickPositions(r,n[o-1],n[o],!0))}else if(e.isDatetimeAxis&&t.minorTickInterval==="auto")i=i.concat(e.getTimeTicks(e.normalizeTimeTickInterval(r),e.min,e.max,t.startOfWeek)),i[0]<e.min&&i.shift();else for(s=e.min+(n[0]-e.min)%r;s<=e.max;s+=r)i.push(s);return i},adjustForMinRange:function(){var t=this,n=t.options,r=t.min,i=t.max,s,o=t.dataMax-t.dataMin>=t.minRange,u,f,l,c,h,p,d;t.isXAxis&&t.minRange===e&&!t.isLog&&(Bt(n.min)||Bt(n.max)?t.minRange=null:(cn(t.series,function(t){c=t.xData,h=t.xIncrement?1:c.length-1;for(f=h;f>0;f--){l=c[f]-c[f-1];if(u===e||l<u)u=l}}),t.minRange=a(u*5,t.dataMax-t.dataMin)));if(i-r<t.minRange){var v=t.minRange;s=(v-i+r)/2,p=[r-s,It(n.min,r-s)],o&&(p[2]=t.dataMin),r=Zt(p),d=[r+v,It(n.max,r+v)],o&&(d[2]=t.dataMax),i=Yt(d),i-r<v&&(p[0]=i-v,p[1]=It(n.min,i-v),r=Zt(p))}t.min=r,t.max=i},setAxisTranslation:function(e){var t=this,n=t.max-t.min,r=t.axisPointRange||0,i,s=0,o=0,f=t.linkedParent,l,c=!!t.categories,h=t.transA;if(t.isXAxis||c||r)f?(s=f.minPointOffset,o=f.pointRangePadding):cn(t.series,function(e){var f=c?1:t.isXAxis?e.pointRange:t.axisPointRange||0,l=e.options.pointPlacement,h=e.closestPointRange;f>n&&(f=0),r=u(r,f),s=u(s,At(l)?0:f/2),o=u(o,l==="on"?0:f),!e.noSharedTooltip&&Bt(h)&&(i=Bt(i)?a(i,h):h)}),l=t.ordinalSlope&&i?t.ordinalSlope/i:1,t.minPointOffset=s*=l,t.pointRangePadding=o*=l,t.pointRange=a(r,n),t.closestPointRange=i;e&&(t.oldTransA=h),t.translationSlope=t.transA=h=t.len/(n+o||1),t.transB=t.horiz?t.left:t.bottom,t.minPixelPadding=h*s},setTickPositions:function(e){var t=this,n=t.chart,r=t.options,i=t.isLog,s=t.isDatetimeAxis,o=t.isXAxis,l=t.isLinked,c=t.options.tickPositioner,h=r.maxPadding,p=r.minPadding,d,v,m=r.tickInterval,g=r.minTickInterval,y=r.tickPixelInterval,b,w,E=t.categories;l?(t.linkedParent=n[t.coll][r.linkedTo],v=t.linkedParent.getExtremes(),t.min=It(v.min,v.dataMin),t.max=It(v.max,v.dataMax),r.type!==t.linkedParent.options.type&&nn(11,1)):(t.min=It(t.userMin,r.min,t.dataMin),t.max=It(t.userMax,r.max,t.dataMax)),i&&(!e&&a(t.min,It(t.dataMin,t.min))<=0&&nn(10,1),t.min=rn(Dt(t.min)),t.max=rn(Dt(t.max))),t.range&&Bt(t.max)&&(t.userMin=t.min=u(t.min,t.max-t.range),t.userMax=t.max,t.range=null),t.beforePadding&&t.beforePadding(),t.adjustForMinRange(),!E&&!t.axisPointRange&&!t.usePercentage&&!l&&Bt(t.min)&&Bt(t.max)&&(d=t.max-t.min,d&&(!Bt(r.min)&&!Bt(t.userMin)&&p&&(t.dataMin<0||!t.ignoreMinPadding)&&(t.min-=d*p),!Bt(r.max)&&!Bt(t.userMax)&&h&&(t.dataMax>0||!t.ignoreMaxPadding)&&(t.max+=d*h))),_t(r.floor)&&(t.min=u(t.min,r.floor)),_t(r.ceiling)&&(t.max=a(t.max,r.ceiling)),t.min===t.max||t.min===undefined||t.max===undefined?t.tickInterval=1:l&&!m&&y===t.linkedParent.options.tickPixelInterval?t.tickInterval=t.linkedParent.tickInterval:(t.tickInterval=It(m,E?1:(t.max-t.min)*y/u(t.len,y)),!Bt(m)&&t.len<y&&!this.isRadial&&!this.isLog&&!E&&r.startOnTick&&r.endOnTick&&(w=!0,t.tickInterval/=4)),o&&!e&&cn(t.series,function(e){e.processData(t.min!==t.oldMin||t.max!==t.oldMax)}),t.setAxisTranslation(!0),t.beforeSetTickPositions&&t.beforeSetTickPositions(),t.postProcessTickInterval&&(t.tickInterval=t.postProcessTickInterval(t.tickInterval)),t.pointRange&&(t.tickInterval=u(t.pointRange,t.tickInterval)),!m&&t.tickInterval<g&&(t.tickInterval=g),!s&&!i&&(m||(t.tickInterval=Kt(t.tickInterval,null,Jt(t.tickInterval),r))),t.minorTickInterval=r.minorTickInterval==="auto"&&t.tickInterval?t.tickInterval/5:r.minorTickInterval,t.tickPositions=b=r.tickPositions?[].concat(r.tickPositions):c&&c.apply(t,[t.min,t.max]),b||(!t.ordinalPositions&&(t.max-t.min)/t.tickInterval>u(2*t.len,200)&&nn(19,!0),s?b=t.getTimeTicks(t.normalizeTimeTickInterval(t.tickInterval,r.units),t.min,t.max,r.startOfWeek,t.ordinalPositions,t.closestPointRange,!0):i?b=t.getLogTickPositions(t.tickInterval,t.min,t.max):b=t.getLinearTickPositions(t.tickInterval,t.min,t.max),w&&b.splice(1,b.length-2),t.tickPositions=b);if(!l){var S=b[0],x=b[b.length-1],T=t.minPointOffset||0,N;r.startOnTick?t.min=S:t.min-T>S&&b.shift(),r.endOnTick?t.max=x:t.max+T<x&&b.pop(),b.length===1&&(N=f(t.max)>1e13?1:.001,t.min-=N,t.max+=N)}},setMaxTicks:function(){var e=this.chart,t=e.maxTicks||{},n=this.tickPositions,r=this._maxTicksKey=[this.coll,this.pos,this.len].join("-");!this.isLinked&&!this.isDatetimeAxis&&n&&n.length>(t[r]||0)&&this.options.alignTicks!==!1&&(t[r]=n.length),e.maxTicks=t},adjustTickAmount:function(){var t=this,n=t.chart,r=t._maxTicksKey,i=t.tickPositions,s=n.maxTicks;if(s&&s[r]&&!t.isDatetimeAxis&&!t.categories&&!t.isLinked&&t.options.alignTicks!==!1&&this.min!==e){var o=t.tickAmount,u=i.length,a;t.tickAmount=a=s[r];if(u<a){while(i.length<a)i.push(rn(i[i.length-1]+t.tickInterval));t.transA*=(u-1)/(a-1),t.max=i[i.length-1]}Bt(o)&&a!==o&&(t.isDirty=!0)}},setScale:function(){var e=this,t=e.stacks,n,r,i,s;e.oldMin=e.min,e.oldMax=e.max,e.oldAxisLength=e.len,e.setAxisSize(),s=e.len!==e.oldAxisLength,cn(e.series,function(e){if(e.isDirtyData||e.isDirty||e.xAxis.isDirty)i=!0});if(s||i||e.isLinked||e.forceRedraw||e.userMin!==e.oldUserMin||e.userMax!==e.oldUserMax){if(!e.isXAxis)for(n in t)for(r in t[n])t[n][r].total=null,t[n][r].cum=0;e.forceRedraw=!1,e.getSeriesExtremes(),e.setTickPositions(),e.oldUserMin=e.userMin,e.oldUserMax=e.userMax,e.isDirty||(e.isDirty=s||e.min!==e.oldMin||e.max!==e.oldMax)}else if(!e.isXAxis){e.oldStacks&&(t=e.stacks=e.oldStacks);for(n in t)for(r in t[n])t[n][r].cum=t[n][r].total}e.setMaxTicks()},setExtremes:function(e,t,n,r,i){var s=this,o=s.chart;n=It(n,!0),i=Nt(i,{min:e,max:t}),gn(s,"setExtremes",i,function(){s.userMin=e,s.userMax=t,s.eventArgs=i,s.isDirtyExtremes=!0,n&&o.redraw(r)})},zoom:function(t,n){var r=this.dataMin,i=this.dataMax,s=this.options;return this.allowZoomOutside||(Bt(r)&&t<=a(r,It(s.min,r))&&(t=e),Bt(i)&&n>=u(i,It(s.max,i))&&(n=e)),this.displayBtn=t!==e||n!==e,this.setExtremes(t,n,!1,e,{trigger:"zoom"}),!0},setAxisSize:function(){var e=this.chart,t=this.options,n=t.offsetLeft||0,r=t.offsetRight||0,i=this.horiz,s=It(t.width,e.plotWidth-n+r),o=It(t.height,e.plotHeight),a=It(t.top,e.plotTop),f=It(t.left,e.plotLeft+n),l=/%$/;l.test(o)&&(o=parseInt(o,10)/100*e.plotHeight),l.test(a)&&(a=parseInt(a,10)/100*e.plotHeight+e.plotTop),this.left=f,this.top=a,this.width=s,this.height=o,this.bottom=e.chartHeight-o-a,this.right=e.chartWidth-s-f,this.len=u(i?s:o,0),this.pos=i?f:a},getExtremes:function(){var e=this,t=e.isLog;return{min:t?rn(Pt(e.min)):e.min,max:t?rn(Pt(e.max)):e.max,dataMin:e.dataMin,dataMax:e.dataMax,userMin:e.userMin,userMax:e.userMax}},getThreshold:function(e){var t=this,n=t.isLog,r=n?Pt(t.min):t.min,i=n?Pt(t.max):t.max;return r>e||e===null?e=r:i<e&&(e=i),t.translate(e,0,1,0,1)},autoLabelAlign:function(e){var t,n=(It(e,0)-this.side*90+720)%360;return n>15&&n<165?t="right":n>195&&n<345?t="left":t="center",t},getOffset:function(){var t=this,n=t.chart,r=n.renderer,i=t.options,o=t.tickPositions,a=t.ticks,f=t.horiz,l=t.side,c=n.inverted?[1,0,3,2][l]:l,h,p,d=0,v,m=0,g=i.title,y=i.labels,b=0,w=n.axisOffset,E=n.clipOffset,S=[-1,1,1,-1][l],x,T,N=1,C=It(y.maxStaggerLines,5),k,L,A,O,M,_,D,P,H=l===2?r.fontMetrics(y.style.fontSize).b:0;t.hasData=h=t.hasVisibleSeries||Bt(t.min)&&Bt(t.max)&&!!o,t.showAxis=p=h||It(i.showEmpty,!0),t.staggerLines=t.horiz&&y.staggerLines,t.axisGroup||(t.gridGroup=r.g("grid").attr({zIndex:i.gridZIndex||1}).add(),t.axisGroup=r.g("axis").attr({zIndex:i.zIndex||2}).add(),t.labelGroup=r.g("axis-labels").attr({zIndex:y.zIndex||7}).addClass(W+t.coll.toLowerCase()+"-labels").add());if(h||t.isLinked){t.labelAlign=It(y.align||t.autoLabelAlign(y.rotation)),cn(o,function(e){a[e]?a[e].addLabel():a[e]=new Fn(t,e)});if(t.horiz&&!t.staggerLines&&C&&!y.rotation){k=t.reversed?[].concat(o).reverse():o;while(N<C){L=[],A=!1;for(T=0;T<k.length;T++)O=k[T],M=a[O].label&&a[O].label.getBBox(),D=M?M.width:0,P=T%N,D&&(_=t.translate(O),L[P]!==e&&_<L[P]&&(A=!0),L[P]=_+D);if(!A)break;N++}N>1&&(t.staggerLines=N)}cn(o,function(e){if(l===0||l===2||{1:"left",3:"right"}[l]===t.labelAlign)b=u(a[e].getLabelSize(),b)}),t.staggerLines&&(b*=t.staggerLines,t.labelOffset=b)}else for(x in a)a[x].destroy(),delete a[x];g&&g.text&&g.enabled!==!1&&(t.axisTitle||(t.axisTitle=r.text(g.text,0,0,g.useHTML).attr({zIndex:7,rotation:g.rotation||0,align:g.textAlign||{low:"left",middle:"center",high:"right"}[g.align]}).addClass(W+this.coll.toLowerCase()+"-title").css(g.style).add(t.axisGroup),t.axisTitle.isNew=!0),p&&(d=t.axisTitle.getBBox()[f?"height":"width"],m=It(g.margin,f?5:10),v=g.offset),t.axisTitle[p?"show":"hide"]()),t.offset=S*It(i.offset,w[l]),t.axisTitleMargin=It(v,b+m+(b&&S*i.labels[f?"y":"x"]-H)),w[l]=u(w[l],t.axisTitleMargin+d+S*t.offset),E[c]=u(E[c],s(i.lineWidth/2)*2)},getLinePath:function(e){var t=this.chart,n=this.opposite,r=this.offset,i=this.horiz,s=this.left+(n?this.width:0)+r,o=t.chartHeight-this.bottom-(n?this.height:0)+r;return n&&(e*=-1),t.renderer.crispLine([J,i?this.left:s,i?o:this.top,K,i?t.chartWidth-this.right:s,i?o:t.chartHeight-this.bottom],e)},getTitlePosition:function(){var e=this.horiz,t=this.left,n=this.top,r=this.len,i=this.options.title,s=e?t:n,o=this.opposite,u=this.offset,a=Lt(i.style.fontSize||12),f={low:s+(e?0:r),middle:s+r/2,high:s+(e?r:0)}[i.align],l=(e?n+this.height:t)+(e?1:-1)*(o?-1:1)*this.axisTitleMargin+(this.side===2?a:0);return{x:e?f:l+(o?this.width:0)+u+(i.x||0),y:e?l-(o?this.height:0)+u:f+(i.y||0)}},render:function(){var t=this,n=t.horiz,r=t.reversed,i=t.chart,s=i.renderer,o=t.options,u=t.isLog,a=t.isLinked,f=t.tickPositions,l,c=t.axisTitle,h=t.ticks,p=t.minorTicks,d=t.alternateBands,v=o.stackLabels,m=o.alternateGridColor,g=t.tickmarkOffset,y=o.lineWidth,b,w=i.hasRendered,E=w&&Bt(t.oldMin)&&!isNaN(t.oldMin),S=t.hasData,x=t.showAxis,T,N=o.labels.overflow,C=t.justifyLabels=n&&N!==!1,k;t.labelEdge.length=0,t.justifyToPlot=N==="justify",cn([h,p,d],function(e){var t;for(t in e)e[t].isActive=!1});if(S||a)t.minorTickInterval&&!t.categories&&cn(t.getMinorTickPositions(),function(e){p[e]||(p[e]=new Fn(t,e,"minor")),E&&p[e].isNew&&p[e].render(null,!0),p[e].render(null,!1,1)}),f.length&&(l=f.slice(),(n&&r||!n&&!r)&&l.reverse(),C&&(l=l.slice(1).concat([l[0]])),cn(l,function(e,n){C&&(n=n===l.length-1?0:n+1);if(!a||e>=t.min&&e<=t.max)h[e]||(h[e]=new Fn(t,e)),E&&h[e].isNew&&h[e].render(n,!0,.1),h[e].render(n,!1,1)}),g&&t.min===0&&(h[-1]||(h[-1]=new Fn(t,-1,null,!0)),h[-1].render(-1))),m&&cn(f,function(n,r){r%2===0&&n<t.max&&(d[n]||(d[n]=new Tt.PlotLineOrBand(t)),T=n+g,k=f[r+1]!==e?f[r+1]+g:t.max,d[n].options={from:u?Pt(T):T,to:u?Pt(k):k,color:m},d[n].render(),d[n].isActive=!0)}),t._addedPlotLB||(cn((o.plotLines||[]).concat(o.plotBands||[]),function(e){t.addPlotBandOrLine(e)}),t._addedPlotLB=!0);cn([h,p,d],function(e){var t,n,r=[],s=_?_.duration||500:0,o=function(){n=r.length;while(n--)e[r[n]]&&!e[r[n]].isActive&&(e[r[n]].destroy(),delete e[r[n]])};for(t in e)e[t].isActive||(e[t].render(t,!1,0),e[t].isActive=!1,r.push(t));e===d||!i.hasRendered||!s?o():s&&setTimeout(o,s)}),y&&(b=t.getLinePath(y),t.axisLine?t.axisLine.animate({d:b}):t.axisLine=s.path(b).attr({stroke:o.lineColor,"stroke-width":y,zIndex:7}).add(t.axisGroup),t.axisLine[x?"show":"hide"]()),c&&x&&(c[c.isNew?"attr":"animate"](t.getTitlePosition()),c.isNew=!1),v&&v.enabled&&t.renderStackTotals(),t.isDirty=!1},redraw:function(){var e=this,t=e.chart,n=t.pointer;n&&n.reset(!0),e.render(),cn(e.plotLinesAndBands,function(e){e.render()}),cn(e.series,function(e){e.isDirty=!0})},destroy:function(e){var t=this,n=t.stacks,r,i=t.plotLinesAndBands,s;e||mn(t);for(r in n)en(n[r]),n[r]=null;cn([t.ticks,t.minorTicks,t.alternateBands],function(e){en(e)}),s=i.length;while(s--)i[s].destroy();cn(["stackTotalGroup","axisLine","axisTitle","axisGroup","cross","gridGroup","labelGroup"],function(e){t[e]&&(t[e]=t[e].destroy())}),this.cross&&this.cross.destroy()},drawCrosshair:function(e,t){if(!this.crosshair)return;if((Bt(t)||!It(this.crosshair.snap,!0))===!1){this.hideCrosshair();return}var n,r=this.crosshair,i=r.animation,s;It(r.snap,!0)?Bt(t)&&(s=this.chart.inverted!=this.horiz?t.plotX:this.len-t.plotY):s=this.horiz?e.chartX-this.pos:this.len-e.chartY+this.pos,this.isRadial?n=this.getPlotLinePath(this.isXAxis?t.x:It(t.stackY,t.y)):n=this.getPlotLinePath(null,null,null,null,s);if(n===null){this.hideCrosshair();return}if(this.cross)this.cross.attr({visibility:X})[i?"animate":"attr"]({d:n},i);else{var o={"stroke-width":r.width||1,stroke:r.color||"#C0C0C0",zIndex:r.zIndex||2};r.dashStyle&&(o.dashstyle=r.dashStyle),this.cross=this.chart.renderer.path(n).attr(o).add()}},hideCrosshair:function(){this.cross&&this.cross.hide()}},Nt(In.prototype,at),In.prototype.getTimeTicks=function(e,t,n,r){var i=[],o,u={},a=O.global.useUTC,f,l=new Date(t-ct),c=e.unitRange,h=e.count;if(Bt(t)){c>=P[tt]&&(l.setMilliseconds(0),l.setSeconds(c>=P[nt]?0:h*s(l.getSeconds()/h))),c>=P[nt]&&l[yt](c>=P[rt]?0:h*s(l[ht]()/h)),c>=P[rt]&&l[bt](c>=P[it]?0:h*s(l[pt]()/h)),c>=P[it]&&l[wt](c>=P[ot]?1:h*s(l[vt]()/h)),c>=P[ot]&&(l[Et](c>=P[ut]?0:h*s(l[mt]()/h)),f=l[gt]()),c>=P[ut]&&(f-=f%h,l[St](f)),c===P[st]&&l[wt](l[vt]()-l[dt]()+It(r,1)),o=1,ct&&(l=new Date(l.getTime()+ct)),f=l[gt]();var p=l.getTime(),d=l[mt](),v=l[vt](),m=a?ct:(864e5+l.getTimezoneOffset()*60*1e3)%864e5;while(p<n)i.push(p),c===P[ut]?p=lt(f+o*h,0):c===P[ot]?p=lt(f,d+o*h):!!a||c!==P[it]&&c!==P[st]?p+=c*h:p=lt(f,d,v+o*h*(c===P[it]?1:7)),o++;i.push(p),cn(hn(i,function(e){return c<=P[rt]&&e%P[it]===m}),function(e){u[e]=it})}return i.info=Nt(e,{higherRanks:u,totalRange:c*h}),i},In.prototype.normalizeTimeTickInterval=function(e,t){var n=t||[[et,[1,2,5,10,20,25,50,100,200,500]],[tt,[1,2,5,10,15,30]],[nt,[1,2,5,10,15,30]],[rt,[1,2,3,4,6,8,12]],[it,[1,2]],[st,[1,2]],[ot,[1,2,3,4,6]],[ut,null]],r=n[n.length-1],i=P[r[0]],s=r[1],o,a;for(a=0;a<n.length;a++){r=n[a],i=P[r[0]],s=r[1];if(n[a+1]){var f=(i*s[s.length-1]+P[n[a+1][0]])/2;if(e<=f)break}}return i===P[ut]&&e<5*i&&(s=[1,2,5]),o=Kt(e/i,s,r[0]===ut?u(Jt(e/i),1):1),{unitRange:i,count:o,unitName:r[0]}},In.prototype.getLogTickPositions=function(e,t,n,r){var o=this,u=o.options,a=o.len,f=[];r||(o._minorAutoInterval=null);if(e>=.5)e=i(e),f=o.getLinearTickPositions(e,t,n);else if(e>=.08){var l=s(t),c,h,p,d,v,m,g;e>.3?c=[1,2,4]:e>.15?c=[1,2,4,6,8]:c=[1,2,3,4,5,6,7,8,9];for(h=l;h<n+1&&!g;h++){d=c.length;for(p=0;p<d&&!g;p++)v=Dt(Pt(h)*c[p]),v>t&&(!r||m<=n)&&f.push(m),m>n&&(g=!0),m=v}}else{var y=Pt(t),b=Pt(n),w=u[r?"minorTickInterval":"tickInterval"],E=w==="auto"?null:w,S=u.tickPixelInterval/(r?5:1),x=r?a/o.tickPositions.length:a;e=It(E,o._minorAutoInterval,(b-y)*S/(x||1)),e=Kt(e,null,Jt(e)),f=dn(o.getLinearTickPositions(e,y,b),Dt),r||(o._minorAutoInterval=e/5)}return r||(o.tickInterval=e),f};var qn=Tt.Tooltip=function(){this.init.apply(this,arguments)};qn.prototype={init:function(e,t){var n=t.borderWidth,r=t.style,i=Lt(r.padding);this.chart=e,this.options=t,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.label=e.renderer.label("",0,0,t.shape||"callout",null,null,t.useHTML,null,"tooltip").attr({padding:i,fill:t.backgroundColor,"stroke-width":n,r:t.borderRadius,zIndex:8}).css(r).css({padding:0}).add().attr({y:-9999}),T||this.label.shadow(t.shadow),this.shared=t.shared},destroy:function(){this.label&&(this.label=this.label.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(t,n,r,i){var s=this,o=s.now,u=s.options.animation!==!1&&!s.isHidden,a=s.followPointer||s.len>1;Nt(o,{x:u?(2*o.x+t)/3:t,y:u?(o.y+n)/2:n,anchorX:a?e:u?(2*o.anchorX+r)/3:r,anchorY:a?e:u?(o.anchorY+i)/2:i}),s.label.attr(o),u&&(f(t-o.x)>1||f(n-o.y)>1)&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){s&&s.move(t,n,r,i)},32))},hide:function(){var e=this,t;clearTimeout(this.hideTimer),this.isHidden||(t=this.chart.hoverPoints,this.hideTimer=setTimeout(function(){e.label.fadeOut(),e.isHidden=!0},It(this.options.hideDelay,500)),t&&cn(t,function(e){e.setState()}),this.chart.hoverPoints=null)},getAnchor:function(t,n){var r,s=this.chart,o=s.inverted,u=s.plotTop,a=0,f=0,l;return t=Ft(t),r=t[0].tooltipPos,this.followPointer&&n&&(n.chartX===e&&(n=s.pointer.normalize(n)),r=[n.chartX-s.plotLeft,n.chartY-u]),r||(cn(t,function(e){l=e.series.yAxis,a+=e.plotX,f+=(e.plotLow?(e.plotLow+e.plotHigh)/2:e.plotY)+(!o&&l?l.top-u:0)}),a/=t.length,f/=t.length,r=[o?s.plotWidth-f:a,this.shared&&!o&&t.length>1&&n?n.chartY-u:o?s.plotHeight-a:f]),dn(r,i)},getPosition:function(e,t,n){var r=this.chart,i=this.distance,s={},o,u=["y",r.chartHeight,t,n.plotY+r.plotTop],a=["x",r.chartWidth,e,n.plotX+r.plotLeft],f=n.ttBelow||r.inverted&&!n.negative||!r.inverted&&n.negative,l=function(e,t,n,r){var o=n<r-i,u=r+i+n<t,a=r-i-n,l=r+i;if(f&&u)s[e]=l;else if(!f&&o)s[e]=a;else if(o)s[e]=a;else{if(!u)return!1;s[e]=l}},c=function(e,t,n,r){if(r<i||r>t-i)return!1;r<n/2?s[e]=1:r>t-n/2?s[e]=t-n-2:s[e]=r-n/2},h=function(e){var t=u;u=a,a=t,o=e},p=function(){l.apply(0,u)!==!1?c.apply(0,a)===!1&&!o&&(h(!0),p()):o?s.x=s.y=0:(h(!0),p())};return(r.inverted||this.len>1)&&h(),p(),s},defaultFormatter:function(e){var t=this.points||Ft(this),n=t[0].series,r;return r=[e.tooltipHeaderFormatter(t[0])],cn(t,function(e){n=e.series,r.push(n.tooltipFormatter&&n.tooltipFormatter(e)||e.point.tooltipFormatter(n.tooltipOptions.pointFormat))}),r.push(e.options.footerFormat||""),r.join("")},refresh:function(e,t){var n=this,r=n.chart,i=n.label,s=n.options,o,u,a,f={},l,c=[],h=s.formatter||n.defaultFormatter,p=r.hoverPoints,d,v=n.shared,m;clearTimeout(this.hideTimer),n.followPointer=Ft(e)[0].series.tooltipOptions.followPointer,a=n.getAnchor(e,t),o=a[0],u=a[1],v&&(!e.series||!e.series.noSharedTooltip)?(r.hoverPoints=e,p&&cn(p,function(e){e.setState()}),cn(e,function(e){e.setState(Y),c.push(e.getLabelConfig())}),f={x:e[0].category,y:e[0].y},f.points=c,this.len=c.length,e=e[0]):f=e.getLabelConfig(),l=h.call(f,n),m=e.series,this.distance=It(m.tooltipOptions.distance,16),l===!1?this.hide():(n.isHidden&&(wn(i),i.attr("opacity",1).show()),i.attr({text:l}),d=s.borderColor||e.color||m.color||"#606060",i.attr({stroke:d}),n.updatePosition({plotX:o,plotY:u,negative:e.negative,ttBelow:e.ttBelow}),this.isHidden=!1),gn(r,"tooltipRefresh",{text:l,x:o+r.plotLeft,y:u+r.plotTop,borderColor:d})},updatePosition:function(e){var t=this.chart,n=this.label,r=(this.options.positioner||this.getPosition).call(this,n.width,n.height,e);this.move(i(r.x),i(r.y),e.plotX+t.plotLeft,e.plotY+t.plotTop)},tooltipHeaderFormatter:function(e){var t=e.series,n=t.tooltipOptions,r=n.dateTimeLabelFormats,i=n.xDateFormat,s=t.xAxis,o=s&&s.options.type==="datetime"&&_t(e.key),u=n.headerFormat,a=s&&s.closestPointRange,f;if(o&&!i){if(a){for(f in P)if(P[f]>=a||P[f]<=P[it]&&e.key%P[f]>0){i=r[f];break}}else i=r.day;i=i||r.year}return o&&i&&(u=u.replace("{point.key}","{point.key:"+i+"}")),$t(u,{point:e,series:t})}};var Rn;C=t.documentElement.ontouchstart!==e;var Un=Tt.Pointer=function(e,t){this.init(e,t)};Un.prototype={init:function(e,t){var n=t.chart,r=n.events,i=T?"":n.zoomType,s=e.inverted,o,u;this.options=t,this.chart=e,this.zoomX=o=/x/.test(i),this.zoomY=u=/y/.test(i),this.zoomHor=o&&!s||u&&s,this.zoomVert=u&&!s||o&&s,this.hasZoom=o||u,this.runChartClick=r&&!!r.click,this.pinchDown=[],this.lastValidTouch={},Tt.Tooltip&&t.tooltip.enabled&&(e.tooltip=new qn(e,t.tooltip),this.followTouchMove=t.tooltip.followTouchMove),this.setDOMEvents()},normalize:function(t,n){var r,s,o;return t=t||window.event,t=yn(t),t.target||(t.target=t.srcElement),o=t.touches?t.touches.length?t.touches.item(0):t.changedTouches[0]:t,n||(this.chartPosition=n=pn(this.chart.container)),o.pageX===e?(r=u(t.x,t.clientX-n.left),s=t.y):(r=o.pageX-n.left,s=o.pageY-n.top),Nt(t,{chartX:i(r),chartY:i(s)})},getCoordinates:function(e){var t={xAxis:[],yAxis:[]};return cn(this.chart.axes,function(n){t[n.isXAxis?"xAxis":"yAxis"].push({axis:n,value:n.toValue(e[n.horiz?"chartX":"chartY"])})}),t},getIndex:function(e){var t=this.chart;return t.inverted?t.plotHeight+t.plotTop-e.chartY:e.chartX-t.plotLeft},runPointActions:function(e){var n=this,r=n.chart,i=r.series,s=r.tooltip,o,u,l,c=r.hoverPoint,h=r.hoverSeries,p,d,v=r.chartWidth,m=n.getIndex(e),g;if(s&&n.options.tooltip.shared&&(!h||!h.noSharedTooltip)){l=[],p=i.length;for(d=0;d<p;d++)i[d].visible&&i[d].options.enableMouseTracking!==!1&&!i[d].noSharedTooltip&&i[d].singularTooltips!==!0&&i[d].tooltipPoints.length&&(u=i[d].tooltipPoints[m],u&&u.series&&(u._dist=f(m-u.clientX),v=a(v,u._dist),l.push(u)));p=l.length;while(p--)l[p]._dist>v&&l.splice(p,1);l.length&&l[0].clientX!==n.hoverX&&(s.refresh(l,e),n.hoverX=l[0].clientX)}o=h&&h.tooltipOptions.followPointer,h&&h.tracker&&!o?(u=h.tooltipPoints[m],u&&u!==c&&u.onMouseOver(e)):s&&o&&!s.isHidden&&(g=s.getAnchor([{}],e),s.updatePosition({plotX:g[0],plotY:g[1]})),s&&!n._onDocumentMouseMove&&(n._onDocumentMouseMove=function(e){B[Rn]&&B[Rn].pointer.onDocumentMouseMove(e)},vn(t,"mousemove",n._onDocumentMouseMove)),cn(r.axes,function(t){t.drawCrosshair(e,It(u,c))})},reset:function(n){var r=this,i=r.chart,s=i.hoverSeries,o=i.hoverPoint,u=i.tooltip,a=u&&u.shared?i.hoverPoints:o;n=n&&u&&a,n&&Ft(a)[0].plotX===e&&(n=!1),n?(u.refresh(a),o&&o.setState(o.state,!0)):(o&&o.onMouseOut(),s&&s.onMouseOut(),u&&u.hide(),r._onDocumentMouseMove&&(mn(t,"mousemove",r._onDocumentMouseMove),r._onDocumentMouseMove=null),cn(i.axes,function(e){e.hideCrosshair()}),r.hoverX=null)},scaleGroups:function(e,t){var n=this.chart,r;cn(n.series,function(i){r=e||i.getPlotBox(),i.xAxis&&i.xAxis.zoomEnabled&&(i.group.attr(r),i.markerGroup&&(i.markerGroup.attr(r),i.markerGroup.clip(t?n.clipRect:null)),i.dataLabelsGroup&&i.dataLabelsGroup.attr(r))}),n.clipRect.attr(t||n.clipBox)},dragStart:function(e){var t=this.chart;t.mouseIsDown=e.type,t.cancelClick=!1,t.mouseDownX=this.mouseDownX=e.chartX,t.mouseDownY=this.mouseDownY=e.chartY},drag:function(e){var t=this.chart,n=t.options.chart,r=e.chartX,i=e.chartY,s=this.zoomHor,o=this.zoomVert,u=t.plotLeft,a=t.plotTop,l=t.plotWidth,c=t.plotHeight,h,p,d=this.mouseDownX,v=this.mouseDownY;r<u?r=u:r>u+l&&(r=u+l),i<a?i=a:i>a+c&&(i=a+c),this.hasDragged=Math.sqrt(Math.pow(d-r,2)+Math.pow(v-i,2)),this.hasDragged>10&&(h=t.isInsidePlot(d-u,v-a),t.hasCartesianSeries&&(this.zoomX||this.zoomY)&&h&&(this.selectionMarker||(this.selectionMarker=t.renderer.rect(u,a,s?1:l,o?1:c,0).attr({fill:n.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add())),this.selectionMarker&&s&&(p=r-d,this.selectionMarker.attr({width:f(p),x:(p>0?0:p)+d})),this.selectionMarker&&o&&(p=i-v,this.selectionMarker.attr({height:f(p),y:(p>0?0:p)+v})),h&&!this.selectionMarker&&n.panning&&t.pan(e,n.panning))},drop:function(e){var t=this.chart,n=this.hasPinched;if(this.selectionMarker){var r={xAxis:[],yAxis:[],originalEvent:e.originalEvent||e},i=this.selectionMarker,s=i.attr?i.attr("x"):i.x,o=i.attr?i.attr("y"):i.y,f=i.attr?i.attr("width"):i.width,l=i.attr?i.attr("height"):i.height,c;if(this.hasDragged||n)cn(t.axes,function(e){if(e.zoomEnabled){var t=e.horiz,n=e.toValue(t?s:o),i=e.toValue(t?s+f:o+l);!isNaN(n)&&!isNaN(i)&&(r[e.coll].push({axis:e,min:a(n,i),max:u(n,i)}),c=!0)}}),c&&gn(t,"selection",r,function(e){t.zoom(Nt(e,n?{animation:!1}:null))});this.selectionMarker=this.selectionMarker.destroy(),n&&this.scaleGroups()}t&&(qt(t.container,{cursor:t._cursor}),t.cancelClick=this.hasDragged>10,t.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(e){e=this.normalize(e),e.preventDefault&&e.preventDefault(),this.dragStart(e)},onDocumentMouseUp:function(e){B[Rn]&&B[Rn].pointer.drop(e)},onDocumentMouseMove:function(e){var t=this.chart,n=this.chartPosition,r=t.hoverSeries;e=this.normalize(e,n),n&&r&&!this.inClass(e.target,"highcharts-tracker")&&!t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)&&this.reset()},onContainerMouseLeave:function(){var e=B[Rn];e&&(e.pointer.reset(),e.pointer.chartPosition=null)},onContainerMouseMove:function(e){var t=this.chart;Rn=t.index,e=this.normalize(e),t.mouseIsDown==="mousedown"&&this.drag(e),(this.inClass(e.target,"highcharts-tracker")||t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop))&&!t.openMenu&&this.runPointActions(e)},inClass:function(e,t){var n;while(e){n=jt(e,"class");if(n){if(n.indexOf(t)!==-1)return!0;if(n.indexOf(W+"container")!==-1)return!1}e=e.parentNode}},onTrackerMouseOut:function(e){var t=this.chart.hoverSeries,n=e.relatedTarget||e.toElement,r=n&&n.point&&n.point.series;t&&!t.options.stickyTracking&&!this.inClass(n,W+"tooltip")&&r!==t&&t.onMouseOut()},onContainerClick:function(e){var t=this.chart,n=t.hoverPoint,r=t.plotLeft,i=t.plotTop;e=this.normalize(e),e.cancelBubble=!0,t.cancelClick||(n&&this.inClass(e.target,W+"tracker")?(gn(n.series,"click",Nt(e,{point:n})),t.hoverPoint&&n.firePointEvent("click",e)):(Nt(e,this.getCoordinates(e)),t.isInsidePlot(e.chartX-r,e.chartY-i)&&gn(t,"click",e)))},setDOMEvents:function(){var e=this,n=e.chart.container;n.onmousedown=function(t){e.onContainerMouseDown(t)},n.onmousemove=function(t){e.onContainerMouseMove(t)},n.onclick=function(t){e.onContainerClick(t)},vn(n,"mouseleave",e.onContainerMouseLeave),j===1&&vn(t,"mouseup",e.onDocumentMouseUp),C&&(n.ontouchstart=function(t){e.onContainerTouchStart(t)},n.ontouchmove=function(t){e.onContainerTouchMove(t)},j===1&&vn(t,"touchend",e.onDocumentTouchEnd))},destroy:function(){var e;mn(this.chart.container,"mouseleave",this.onContainerMouseLeave),j||(mn(t,"mouseup",this.onDocumentMouseUp),mn(t,"touchend",this.onDocumentTouchEnd)),clearInterval(this.tooltipTimeout);for(e in this)this[e]=null}},Nt(Tt.Pointer.prototype,{pinchTranslate:function(e,t,n,r,i,s){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,e,t,n,r,i,s),(this.zoomVert||this.pinchVert)&&this.pinchTranslateDirection(!1,e,t,n,r,i,s)},pinchTranslateDirection:function(e,t,n,r,i,s,o,u){var a=this.chart,l=e?"x":"y",c=e?"X":"Y",h="chart"+c,p=e?"width":"height",d=a["plot"+(e?"Left":"Top")],v,m,g,y=u||1,b=a.inverted,w=a.bounds[e?"h":"v"],E=t.length===1,S=t[0][h],x=n[0][h],T=!E&&t[1][h],N=!E&&n[1][h],C,k,L,A=function(){!E&&f(S-T)>20&&(y=u||f(x-N)/f(S-T)),g=(d-x)/y+S,v=a["plot"+(e?"Width":"Height")]/y};A(),m=g,m<w.min?(m=w.min,C=!0):m+v>w.max&&(m=w.max-v,C=!0),C?(x-=.8*(x-o[l][0]),E||(N-=.8*(N-o[l][1])),A()):o[l]=[x,N],b||(s[l]=g-d,s[p]=v),L=b?e?"scaleY":"scaleX":"scale"+c,k=b?1/y:y,i[p]=v,i[l]=m,r[L]=y,r["translate"+c]=k*d+(x-k*S)},pinch:function(e){var t=this,n=t.chart,r=t.pinchDown,i=t.followTouchMove,s=e.touches,o=s.length,f=t.lastValidTouch,l=t.hasZoom,c=t.selectionMarker,h={},p=o===1&&(t.inClass(e.target,W+"tracker")&&n.runTrackerClick||n.runChartClick),d={};(l||i)&&!p&&e.preventDefault(),dn(s,function(e){return t.normalize(e)}),e.type==="touchstart"?(cn(s,function(e,t){r[t]={chartX:e.chartX,chartY:e.chartY}}),f.x=[r[0].chartX,r[1]&&r[1].chartX],f.y=[r[0].chartY,r[1]&&r[1].chartY],cn(n.axes,function(e){if(e.zoomEnabled){var t=n.bounds[e.horiz?"h":"v"],r=e.minPixelPadding,i=e.toPixels(e.dataMin),s=e.toPixels(e.dataMax),o=a(i,s),f=u(i,s);t.min=a(e.pos,o-r),t.max=u(e.pos+e.len,f+r)}})):r.length&&(c||(t.selectionMarker=c=Nt({destroy:H},n.plotBox)),t.pinchTranslate(r,s,h,c,d,f),t.hasPinched=l,t.scaleGroups(h,d),!l&&i&&o===1&&this.runPointActions(t.normalize(e)))},onContainerTouchStart:function(e){var t=this.chart;Rn=t.index,e.touches.length===1?(e=this.normalize(e),t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)?(this.runPointActions(e),this.pinch(e)):this.reset()):e.touches.length===2&&this.pinch(e)},onContainerTouchMove:function(e){(e.touches.length===1||e.touches.length===2)&&this.pinch(e)},onDocumentTouchEnd:function(e){B[Rn]&&B[Rn].pointer.drop(e)}});if(n.PointerEvent||n.MSPointerEvent){var zn={},Wn=!!n.PointerEvent,Xn=function(){var e,t=[];t.item=function(e){return this[e]};for(e in zn)zn.hasOwnProperty(e)&&t.push({pageX:zn[e].pageX,pageY:zn[e].pageY,target:zn[e].target});return t},Vn=function(e,t,n,r){var i;e=e.originalEvent||e,(e.pointerType==="touch"||e.pointerType===e.MSPOINTER_TYPE_TOUCH)&&B[Rn]&&(r(e),i=B[Rn].pointer,i[t]({type:n,target:e.currentTarget,preventDefault:H,touches:Xn()}))};Nt(Un.prototype,{onContainerPointerDown:function(e){Vn(e,"onContainerTouchStart","touchstart",function(e){zn[e.pointerId]={pageX:e.pageX,pageY:e.pageY,target:e.currentTarget}})},onContainerPointerMove:function(e){Vn(e,"onContainerTouchMove","touchmove",function(e){zn[e.pointerId]={pageX:e.pageX,pageY:e.pageY},zn[e.pointerId].target||(zn[e.pointerId].target=e.currentTarget)})},onDocumentPointerUp:function(e){Vn(e,"onContainerTouchEnd","touchend",function(e){delete zn[e.pointerId]})},batchMSEvents:function(e){e(this.chart.container,Wn?"pointerdown":"MSPointerDown",this.onContainerPointerDown),e(this.chart.container,Wn?"pointermove":"MSPointerMove",this.onContainerPointerMove),e(t,Wn?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),Xt(Un.prototype,"init",function(e,t,n){e.call(this,t,n),(this.hasZoom||this.followTouchMove)&&qt(t.container,{"-ms-touch-action":$,"touch-action":$})}),Xt(Un.prototype,"setDOMEvents",function(e){e.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(vn)}),Xt(Un.prototype,"destroy",function(e){this.batchMSEvents(mn),e.call(this)})}var $n=Tt.Legend=function(e,t){this.init(e,t)};$n.prototype={init:function(e,t){var n=this,r=t.itemStyle,i=It(t.padding,8),s=t.itemMarginTop||0;this.options=t;if(!t.enabled)return;n.baseline=Lt(r.fontSize)+3+s,n.itemStyle=r,n.itemHiddenStyle=Ct(r,t.itemHiddenStyle),n.itemMarginTop=s,n.padding=i,n.initialItemX=i,n.initialItemY=i-5,n.maxItemWidth=0,n.chart=e,n.itemHeight=0,n.lastLineHeight=0,n.symbolWidth=It(t.symbolWidth,16),n.pages=[],n.render(),vn(n.chart,"endResize",function(){n.positionCheckboxes()})},colorizeItem:function(t,n){var r=this,i=r.options,s=t.legendItem,o=t.legendLine,u=t.legendSymbol,a=r.itemHiddenStyle.color,f=n?i.itemStyle.color:a,l=n?t.legendColor||t.color||"#CCC":a,c=t.options&&t.options.marker,h={fill:l},p,d;s&&s.css({fill:f,color:f}),o&&o.attr({stroke:l});if(u){if(c&&u.isMarker){h.stroke=l,c=t.convertAttribs(c);for(p in c)d=c[p],d!==e&&(h[p]=d)}u.attr(h)}},positionItem:function(e){var t=this,n=t.options,r=n.symbolPadding,i=!n.rtl,s=e._legendItemPos,o=s[0],u=s[1],a=e.checkbox;e.legendGroup&&e.legendGroup.translate(i?o:t.legendWidth-o-2*r-4,u),a&&(a.x=o,a.y=u)},destroyItem:function(e){var t=e.checkbox;cn(["legendItem","legendLine","legendSymbol","legendGroup"],function(t){e[t]&&(e[t]=e[t].destroy())}),t&&tn(e.checkbox)},destroy:function(){var e=this,t=e.group,n=e.box;n&&(e.box=n.destroy()),t&&(e.group=t.destroy())},positionCheckboxes:function(e){var t=this.group.alignAttr,n,r=this.clipHeight||this.legendHeight;t&&(n=t.translateY,cn(this.allItems,function(i){var s=i.checkbox,o;s&&(o=n+s.y+(e||0)+3,qt(s,{left:t.translateX+i.checkboxOffset+s.x-20+V,top:o+V,display:o>n-6&&o<n+r-6?"":$}))}))},renderTitle:function(){var e=this.options,t=this.padding,n=e.title,r=0,i;n.text&&(this.title||(this.title=this.chart.renderer.label(n.text,t-3,t-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(n.style).add(this.group)),i=this.title.getBBox(),r=i.height,this.offsetWidth=i.width,this.contentGroup.attr({translateY:r})),this.titleHeight=r},renderItem:function(e){var t=this,n=t.chart,r=n.renderer,s=t.options,o=s.layout==="horizontal",a=t.symbolWidth,f=s.symbolPadding,l=t.itemStyle,c=t.itemHiddenStyle,h=t.padding,p=o?It(s.itemDistance,20):0,d=!s.rtl,v,m=s.width,g=s.itemMarginBottom||0,y=t.itemMarginTop,b=t.initialItemX,w,E,S=e.legendItem,x=e.series&&e.series.drawLegendSymbol?e.series:e,T=x.options,N=t.createCheckboxForItem&&T&&T.showCheckbox,C=s.useHTML;S||(e.legendGroup=r.g("legend-item").attr({zIndex:1}).add(t.scrollGroup),x.drawLegendSymbol(t,e),e.legendItem=S=r.text(s.labelFormat?$t(s.labelFormat,e):s.labelFormatter.call(e),d?a+f:-f,t.baseline,C).css(Ct(e.visible?l:c)).attr({align:d?"left":"right",zIndex:2}).add(e.legendGroup),t.setItemEvents&&t.setItemEvents(e,S,C,l,c),t.colorizeItem(e,e.visible),N&&t.createCheckboxForItem(e)),w=S.getBBox(),E=e.checkboxOffset=s.itemWidth||e.legendItemWidth||a+f+w.width+p+(N?20:0),t.itemHeight=v=i(e.legendItemHeight||w.height),o&&t.itemX-b+E>(m||n.chartWidth-2*h-b-s.x)&&(t.itemX=b,t.itemY+=y+t.lastLineHeight+g,t.lastLineHeight=0),t.maxItemWidth=u(t.maxItemWidth,E),t.lastItemY=y+t.itemY+g,t.lastLineHeight=u(v,t.lastLineHeight),e._legendItemPos=[t.itemX,t.itemY],o?t.itemX+=E:(t.itemY+=y+v+g,t.lastLineHeight=v),t.offsetWidth=m||u((o?t.itemX-b-p:E)+h,t.offsetWidth)},getAllItems:function(){var t=[];return cn(this.chart.series,function(n){var r=n.options;if(!It(r.showInLegend,Bt(r.linkedTo)?!1:e,!0))return;t=t.concat(n.legendItems||(r.legendType==="point"?n.data:n))}),t},render:function(){var e=this,t=e.chart,n=t.renderer,r=e.group,i,s,o,u,a=e.box,f=e.options,l=e.padding,c=f.borderWidth,h=f.backgroundColor;e.itemX=e.initialItemX,e.itemY=e.initialItemY,e.offsetWidth=0,e.lastItemY=0,r||(e.group=r=n.g("legend").attr({zIndex:7}).add(),e.contentGroup=n.g().attr({zIndex:1}).add(r),e.scrollGroup=n.g().add(e.contentGroup)),e.renderTitle(),i=e.getAllItems(),Gt(i,function(e,t){return(e.options&&e.options.legendIndex||0)-(t.options&&t.options.legendIndex||0)}),f.reversed&&i.reverse(),e.allItems=i,e.display=s=!!i.length,cn(i,function(t){e.renderItem(t)}),o=f.width||e.offsetWidth,u=e.lastItemY+e.lastLineHeight+e.titleHeight,u=e.handleOverflow(u);if(c||h)o+=l,u+=l,a?o>0&&u>0&&(a[a.isNew?"attr":"animate"](a.crisp({width:o,height:u})),a.isNew=!1):(e.box=a=n.rect(0,0,o,u,f.borderRadius,c||0).attr({stroke:f.borderColor,"stroke-width":c||0,fill:h||$}).add(r).shadow(f.shadow),a.isNew=!0),a[s?"show":"hide"]();e.legendWidth=o,e.legendHeight=u,cn(i,function(t){e.positionItem(t)}),s&&r.align(Nt({width:o,height:u},f),!0,"spacingBox"),t.isResizing||this.positionCheckboxes()},handleOverflow:function(e){var t=this,n=this.chart,r=n.renderer,s=this.options,o=s.y,u=s.verticalAlign==="top",f=n.spacingBox.height+(u?-o:o)-this.padding,l=s.maxHeight,c,h=this.clipRect,p=s.navigation,d=It(p.animation,!0),v=p.arrowSize||12,m=this.nav,g=this.pages,y,b=this.allItems;return s.layout==="horizontal"&&(f/=2),l&&(f=a(f,l)),g.length=0,e>f&&!s.useHTML?(this.clipHeight=c=f-20-this.titleHeight-this.padding,this.currentPage=It(this.currentPage,1),this.fullHeight=e,cn(b,function(e,t){var n=e._legendItemPos[1],r=i(e.legendItem.getBBox().height),s=g.length;if(!s||n-g[s-1]>c&&(y||n)!==g[s-1])g.push(y||n),s++;t===b.length-1&&n+r-g[s-1]>c&&g.push(n),n!==y&&(y=n)}),h||(h=t.clipRect=r.clipRect(0,this.padding,9999,0),t.contentGroup.clip(h)),h.attr({height:c}),m||(this.nav=m=r.g().attr({zIndex:1}).add(this.group),this.up=r.symbol("triangle",0,0,v,v).on("click",function(){t.scroll(-1,d)}).add(m),this.pager=r.text("",15,10).css(p.style).add(m),this.down=r.symbol("triangle-down",0,0,v,v).on("click",function(){t.scroll(1,d)}).add(m)),t.scroll(0),e=f):m&&(h.attr({height:n.chartHeight}),m.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),e},scroll:function(t,n){var r=this.pages,i=r.length,s=this.currentPage+t,o=this.clipHeight,u=this.options.navigation,a=u.activeColor,f=u.inactiveColor,l=this.pager,c=this.padding,h;s>i&&(s=i),s>0&&(n!==e&&sn(n,this.chart),this.nav.attr({translateX:c,translateY:o+this.padding+7+this.titleHeight,visibility:X}),this.up.attr({fill:s===1?f:a}).css({cursor:s===1?"default":"pointer"}),l.attr({text:s+"/"+i}),this.down.attr({x:18+this.pager.getBBox().width,fill:s===i?f:a}).css({cursor:s===i?"default":"pointer"}),h=-r[s-1]+this.initialItemY,this.scrollGroup.animate({translateY:h}),this.currentPage=s,this.positionCheckboxes(h))}};var Jn=Tt.LegendSymbolMixin={drawRectangle:function(e,t){var n=e.options.symbolHeight||12;t.legendSymbol=this.chart.renderer.rect(0,e.baseline-5-n/2,e.symbolWidth,n,e.options.symbolRadius||0).attr({zIndex:3}).add(t.legendGroup)},drawLineMarker:function(e){var t=this.options,n=t.marker,r,s=e.options,o,u=e.symbolWidth,a=this.chart.renderer,f=this.legendGroup,l=e.baseline-i(a.fontMetrics(s.itemStyle.fontSize).b*.3),c;t.lineWidth&&(c={"stroke-width":t.lineWidth},t.dashStyle&&(c.dashstyle=t.dashStyle),this.legendLine=a.path([J,0,l,K,u,l]).attr(c).add(f)),n&&n.enabled!==!1&&(r=n.radius,this.legendSymbol=o=a.symbol(this.symbol,u/2-r,l-r,2*r,2*r).add(f),o.isMarker=!0)}};(/Trident\/7\.0/.test(d)||b)&&Xt($n.prototype,"positionItem",function(e,t){var n=this,r=function(){t._legendItemPos&&e.call(n,t)};r(),setTimeout(r)}),Kn.prototype={init:function(e,t){var n,r=e.series;e.series=null,n=Ct(O,e),n.series=e.series=r,this.userOptions=e;var i=n.chart;this.margin=this.splashArray("margin",i),this.spacing=this.splashArray("spacing",i);var s=i.events;this.bounds={h:{},v:{}},this.callback=t,this.isResizing=0,this.options=n,this.axes=[],this.series=[],this.hasCartesianSeries=i.showAxes;var o=this,u;o.index=B.length,B.push(o),j++,i.reflow!==!1&&vn(o,"load",function(){o.initReflow()});if(s)for(u in s)vn(o,u,s[u]);o.xAxis=[],o.yAxis=[],o.animation=T?!1:It(i.animation,!0),o.pointCount=0,o.counters=new Qt,o.firstRender()},initSeries:function(e){var t=this,n=t.options.chart,r=e.type||n.type||n.defaultSeriesType,i,s=xt[r];return s||nn(17,!0),i=new s,i.init(this,e),i},isInsidePlot:function(e,t,n){var r=n?t:e,i=n?e:t;return r>=0&&r<=this.plotWidth&&i>=0&&i<=this.plotHeight},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&cn(this.axes,function(e){e.adjustTickAmount()}),this.maxTicks=null},redraw:function(e){var t=this,n=t.axes,r=t.series,i=t.pointer,s=t.legend,o=t.isDirtyLegend,u,a,f=t.isDirtyBox,l=r.length,c=l,h,p=t.renderer,d=p.isHidden(),v=[];sn(e,t),d&&t.cloneRenderTo(),t.layOutTitles();while(c--){h=r[c];if(h.options.stacking){u=!0;if(h.isDirty){a=!0;break}}}if(a){c=l;while(c--)h=r[c],h.options.stacking&&(h.isDirty=!0)}cn(r,function(e){e.isDirty&&e.options.legendType==="point"&&(o=!0)}),o&&s.options.enabled&&(s.render(),t.isDirtyLegend=!1),u&&t.getStacks(),t.hasCartesianSeries&&(t.isResizing||(t.maxTicks=null,cn(n,function(e){e.setScale()})),t.adjustTickAmounts(),t.getMargins(),cn(n,function(e){e.isDirty&&(f=!0)}),cn(n,function(e){e.isDirtyExtremes&&(e.isDirtyExtremes=!1,v.push(function(){gn(e,"afterSetExtremes",Nt(e.eventArgs,e.getExtremes())),delete e.eventArgs})),(f||u)&&e.redraw()})),f&&t.drawChartBox(),cn(r,function(e){e.isDirty&&e.visible&&(!e.isCartesian||e.xAxis)&&e.redraw()}),i&&i.reset(!0),p.draw(),gn(t,"redraw"),d&&t.cloneRenderTo(!0),cn(v,function(e){e.call()})},get:function(e){var t=this,n=t.axes,r=t.series,i,s,o;for(i=0;i<n.length;i++)if(n[i].options.id===e)return n[i];for(i=0;i<r.length;i++)if(r[i].options.id===e)return r[i];for(i=0;i<r.length;i++){o=r[i].points||[];for(s=0;s<o.length;s++)if(o[s].id===e)return o[s]}return null},getAxes:function(){var e=this,t=this.options,n=t.xAxis=Ft(t.xAxis||{}),r=t.yAxis=Ft(t.yAxis||{}),i,s;cn(n,function(e,t){e.index=t,e.isX=!0}),cn(r,function(e,t){e.index=t}),i=n.concat(r),cn(i,function(t){s=new In(e,t)}),e.adjustTickAmounts()},getSelectedPoints:function(){var e=[];return cn(this.series,function(t){e=e.concat(hn(t.points||[],function(e){return e.selected}))}),e},getSelectedSeries:function(){return hn(this.series,function(e){return e.selected})},getStacks:function(){var e=this;cn(e.yAxis,function(e){e.stacks&&e.hasVisibleSeries&&(e.oldStacks=e.stacks)}),cn(e.series,function(t){t.options.stacking&&(t.visible===!0||e.options.chart.ignoreHiddenSeries===!1)&&(t.stackKey=t.type+It(t.options.stack,""))})},setTitle:function(e,t,n){var r=this,i=r.options,s,o;s=i.title=Ct(i.title,e),o=i.subtitle=Ct(i.subtitle,t),cn([["title",e,s],["subtitle",t,o]],function(e){var t=e[0],n=r[t],i=e[1],s=e[2];n&&i&&(r[t]=n=n.destroy()),s&&s.text&&!n&&(r[t]=r.renderer.text(s.text,0,0,s.useHTML).attr({align:s.align,"class":W+t,zIndex:s.zIndex||4}).css(s.style).add())}),r.layOutTitles(n)},layOutTitles:function(e){var t=0,n=this.title,r=this.subtitle,i=this.options,s=i.title,u=i.subtitle,a,f=this.spacingBox.width-44;n&&(n.css({width:(s.width||f)+V}).align(Nt({y:15},s),!1,"spacingBox"),!s.floating&&!s.verticalAlign&&(t=n.getBBox().height)),r&&(r.css({width:(u.width||f)+V}).align(Nt({y:t+s.margin},u),!1,"spacingBox"),!u.floating&&!u.verticalAlign&&(t=o(t+r.getBBox().height))),a=this.titleOffset!==t,this.titleOffset=t,!this.isDirtyBox&&a&&(this.isDirtyBox=a,this.hasRendered&&It(e,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var e=this,t=e.options.chart,n=t.width,r=t.height,i=e.renderToClone||e.renderTo;Bt(n)||(e.containerWidth=an(i,"width")),Bt(r)||(e.containerHeight=an(i,"height")),e.chartWidth=u(0,n||e.containerWidth||600),e.chartHeight=u(0,It(r,e.containerHeight>19?e.containerHeight:400))},cloneRenderTo:function(e){var n=this.renderToClone,r=this.container;e?n&&(this.renderTo.appendChild(r),tn(n),delete this.renderToClone):(r&&r.parentNode===this.renderTo&&this.renderTo.removeChild(r),this.renderToClone=n=this.renderTo.cloneNode(0),qt(n,{position:R,top:"-9999px",display:"block"}),n.style.setProperty&&n.style.setProperty("display","block","important"),t.body.appendChild(n),r&&n.appendChild(r))},getContainer:function(){var e=this,n,r=e.options.chart,i,s,o,u="data-highcharts-chart",a,f;e.renderTo=o=r.renderTo,f=W+L++,At(o)&&(e.renderTo=o=t.getElementById(o)),o||nn(13,!0),a=Lt(jt(o,u)),!isNaN(a)&&B[a]&&B[a].hasRendered&&B[a].destroy(),jt(o,u,e.index),o.innerHTML="",!r.skipClone&&!o.offsetWidth&&e.cloneRenderTo(),e.getChartSize(),i=e.chartWidth,s=e.chartHeight,e.container=n=Rt(q,{className:W+"container"+(r.className?" "+r.className:""),id:f},Nt({position:U,overflow:z,width:i+V,height:s+V,textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},r.style),e.renderToClone||o),e._cursor=n.style.cursor,e.renderer=r.forExport?new _n(n,i,s,r.style,!0):new N(n,i,s,r.style),T&&e.renderer.create(e,n,i,s)},getMargins:function(){var e=this,t=e.spacing,n,r=e.legend,i=e.margin,s=e.options.legend,o=It(s.margin,20),a=s.x,f=s.y,l=s.align,c=s.verticalAlign,h=e.titleOffset;e.resetMargins(),n=e.axisOffset,h&&!Bt(i[0])&&(e.plotTop=u(e.plotTop,h+e.options.title.margin+t[0])),r.display&&!s.floating&&(l==="right"?Bt(i[1])||(e.marginRight=u(e.marginRight,r.legendWidth-a+o+t[1])):l==="left"?Bt(i[3])||(e.plotLeft=u(e.plotLeft,r.legendWidth+a+o+t[3])):c==="top"?Bt(i[0])||(e.plotTop=u(e.plotTop,r.legendHeight+f+o+t[0])):c==="bottom"&&(Bt(i[2])||(e.marginBottom=u(e.marginBottom,r.legendHeight-f+o+t[2])))),e.extraBottomMargin&&(e.marginBottom+=e.extraBottomMargin),e.extraTopMargin&&(e.plotTop+=e.extraTopMargin),e.hasCartesianSeries&&cn(e.axes,function(e){e.getOffset()}),Bt(i[3])||(e.plotLeft+=n[3]),Bt(i[0])||(e.plotTop+=n[0]),Bt(i[2])||(e.marginBottom+=n[2]),Bt(i[1])||(e.marginRight+=n[1]),e.setChartSize()},reflow:function(e){var r=this,i=r.options.chart,s=r.renderTo,o=i.width||an(s,"width"),u=i.height||an(s,"height"),a=e?e.target:n,f=function(){r.container&&(r.setSize(o,u,!1),r.hasUserSize=null)};if(!r.hasUserSize&&o&&u&&(a===n||a===t)){if(o!==r.containerWidth||u!==r.containerHeight)clearTimeout(r.reflowTimeout),e?r.reflowTimeout=setTimeout(f,100):f();r.containerWidth=o,r.containerHeight=u}},initReflow:function(){var e=this,t=function(t){e.reflow(t)};vn(n,"resize",t),vn(e,"destroy",function(){mn(n,"resize",t)})},setSize:function(e,t,n){var r=this,s,o,a;r.isResizing+=1,a=function(){r&&gn(r,"endResize",null,function(){r.isResizing-=1})},sn(n,r),r.oldChartHeight=r.chartHeight,r.oldChartWidth=r.chartWidth,Bt(e)&&(r.chartWidth=s=u(0,i(e)),r.hasUserSize=!!s),Bt(t)&&(r.chartHeight=o=u(0,i(t))),(_?bn:qt)(r.container,{width:s+V,height:o+V},_),r.setChartSize(!0),r.renderer.setSize(s,o,n),r.maxTicks=null,cn(r.axes,function(e){e.isDirty=!0,e.setScale()}),cn(r.series,function(e){e.isDirty=!0}),r.isDirtyLegend=!0,r.isDirtyBox=!0,r.layOutTitles(),r.getMargins(),r.redraw(n),r.oldChartHeight=null,gn(r,"resize"),_===!1?a():setTimeout(a,_&&_.duration||500)},setChartSize:function(e){var t=this,n=t.inverted,r=t.renderer,a=t.chartWidth,f=t.chartHeight,l=t.options.chart,c=t.spacing,h=t.clipOffset,p,d,v,m,g,y,b;t.plotLeft=v=i(t.plotLeft),t.plotTop=m=i(t.plotTop),t.plotWidth=g=u(0,i(a-v-t.marginRight)),t.plotHeight=y=u(0,i(f-m-t.marginBottom)),t.plotSizeX=n?y:g,t.plotSizeY=n?g:y,t.plotBorderWidth=l.plotBorderWidth||0,t.spacingBox=r.spacingBox={x:c[3],y:c[0],width:a-c[3]-c[1],height:f-c[0]-c[2]},t.plotBox=r.plotBox={x:v,y:m,width:g,height:y},b=2*s(t.plotBorderWidth/2),p=o(u(b,h[3])/2),d=o(u(b,h[0])/2),t.clipBox={x:p,y:d,width:s(t.plotSizeX-u(b,h[1])/2-p),height:s(t.plotSizeY-u(b,h[2])/2-d)},e||cn(t.axes,function(e){e.setAxisSize(),e.setAxisTranslation()})},resetMargins:function(){var e=this,t=e.spacing,n=e.margin;e.plotTop=It(n[0],t[0]),e.marginRight=It(n[1],t[1]),e.marginBottom=It(n[2],t[2]),e.plotLeft=It(n[3],t[3]),e.axisOffset=[0,0,0,0],e.clipOffset=[0,0,0,0]},drawChartBox:function(){var e=this,t=e.options.chart,n=e.renderer,r=e.chartWidth,i=e.chartHeight,s=e.chartBackground,o=e.plotBackground,u=e.plotBorder,a=e.plotBGImage,f=t.borderWidth||0,l=t.backgroundColor,c=t.plotBackgroundColor,h=t.plotBackgroundImage,p=t.plotBorderWidth||0,d,v,m=e.plotLeft,g=e.plotTop,y=e.plotWidth,b=e.plotHeight,w=e.plotBox,E=e.clipRect,S=e.clipBox;d=f+(t.shadow?8:0);if(f||l)s?s.animate(s.crisp({width:r-d,height:i-d})):(v={fill:l||$},f&&(v.stroke=t.borderColor,v["stroke-width"]=f),e.chartBackground=n.rect(d/2,d/2,r-d,i-d,t.borderRadius,f).attr(v).addClass(W+"background").add().shadow(t.shadow));c&&(o?o.animate(w):e.plotBackground=n.rect(m,g,y,b,0).attr({fill:c}).add().shadow(t.plotShadow)),h&&(a?a.animate(w):e.plotBGImage=n.image(h,m,g,y,b).add()),E?E.animate({width:S.width,height:S.height}):e.clipRect=n.clipRect(S),p&&(u?u.animate(u.crisp({x:m,y:g,width:y,height:b})):e.plotBorder=n.rect(m,g,y,b,0,-p).attr({stroke:t.plotBorderColor,"stroke-width":p,fill:$,zIndex:1}).add()),e.isDirtyBox=!1},propFromSeries:function(){var e=this,t=e.options.chart,n,r=e.options.series,i,s;cn(["inverted","angular","polar"],function(o){n=xt[t.type||t.defaultSeriesType],s=e[o]||t[o]||n&&n.prototype[o],i=r&&r.length;while(!s&&i--)n=xt[r[i].type],n&&n.prototype[o]&&(s=!0);e[o]=s})},linkSeries:function(){var e=this,t=e.series;cn(t,function(e){e.linkedSeries.length=0}),cn(t,function(t){var n=t.options.linkedTo;At(n)&&(n===":previous"?n=e.series[t.index-1]:n=e.get(n),n&&(n.linkedSeries.push(t),t.linkedParent=n))})},renderSeries:function(){cn(this.series,function(e){e.translate(),e.setTooltipPoints&&e.setTooltipPoints(),e.render()})},render:function(){var e=this,t=e.axes,n=e.renderer,r=e.options,i=r.labels,s=r.credits,o;e.setTitle(),e.legend=new $n(e,r.legend),e.getStacks(),cn(t,function(e){e.setScale()}),e.getMargins(),e.maxTicks=null,cn(t,function(e){e.setTickPositions(!0),e.setMaxTicks()}),e.adjustTickAmounts(),e.getMargins(),e.drawChartBox(),e.hasCartesianSeries&&cn(t,function(e){e.render()}),e.seriesGroup||(e.seriesGroup=n.g("series-group").attr({zIndex:3}).add()),e.renderSeries(),i.items&&cn(i.items,function(t){var r=Nt(i.style,t.style),s=Lt(r.left)+e.plotLeft,o=Lt(r.top)+e.plotTop+12;delete r.left,delete r.top,n.text(t.html,s,o).attr({zIndex:2}).css(r).add()}),s.enabled&&!e.credits&&(o=s.href,e.credits=n.text(s.text,0,0).on("click",function(){o&&(location.href=o)}).attr({align:s.position.align,zIndex:8}).css(s.style).add().align(s.position)),e.hasRendered=!0},destroy:function(){var t=this,n=t.axes,r=t.series,i=t.container,s,o=i&&i.parentNode;gn(t,"destroy"),B[t.index]=e,j--,t.renderTo.removeAttribute("data-highcharts-chart"),mn(t),s=n.length;while(s--)n[s]=n[s].destroy();s=r.length;while(s--)r[s]=r[s].destroy();cn(["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","scroller","rangeSelector","legend","resetZoomButton","tooltip","renderer"],function(e){var n=t[e];n&&n.destroy&&(t[e]=n.destroy())}),i&&(i.innerHTML="",mn(i),o&&tn(i));for(s in t)delete t[s]},isReadyToRender:function(){var e=this;return!S&&n==n.top&&t.readyState!=="complete"||T&&!n.canvg?(T?jn.push(function(){e.firstRender()},e.options.global.canvasToolsURL):t.attachEvent("onreadystatechange",function(){t.detachEvent("onreadystatechange",e.firstRender),t.readyState==="complete"&&e.firstRender()}),!1):!0},firstRender:function(){var e=this,t=e.options,n=e.callback;if(!e.isReadyToRender())return;e.getContainer(),gn(e,"init"),e.resetMargins(),e.setChartSize(),e.propFromSeries(),e.getAxes(),cn(t.series||[],function(t){e.initSeries(t)}),e.linkSeries(),gn(e,"beforeRender"),Tt.Pointer&&(e.pointer=new Un(e,t)),e.render(),e.renderer.draw(),n&&n.apply(e,[e]),cn(e.callbacks,function(t){t.apply(e,[e])}),e.cloneRenderTo(!0),gn(e,"load")},splashArray:function(e,t){var n=t[e],r=Ot(n)?n:[n,n,n,n];return[It(t[e+"Top"],r[0]),It(t[e+"Right"],r[1]),It(t[e+"Bottom"],r[2]),It(t[e+"Left"],r[3])]}},Kn.prototype.callbacks=[];var Qn=Tt.CenteredSeriesMixin={getCenter:function(){var e=this.options,t=this.chart,n=2*(e.slicedOffset||0),r,i=t.plotWidth-2*n,s=t.plotHeight-2*n,o=e.center,u=[It(o[0],"50%"),It(o[1],"50%"),e.size||"100%",e.innerSize||0],f=a(i,s),l;return dn(u,function(e,t){return l=/%$/.test(e),r=t<2||t===2&&l,(l?[i,s,f,f][t]*Lt(e)/100:e)+(r?n:0)})}},Gn=function(){};Gn.prototype={init:function(e,t,n){var r=this,i;return r.series=e,r.applyOptions(t,n),r.pointAttr={},e.options.colorByPoint&&(i=e.options.colors||e.chart.options.colors,r.color=r.color||i[e.colorCounter++],e.colorCounter===i.length&&(e.colorCounter=0)),e.chart.pointCount++,r},applyOptions:function(t,n){var r=this,i=r.series,s=i.pointValKey;return t=Gn.prototype.optionsToObject.call(this,t),Nt(r,t),r.options=r.options?Nt(r.options,t):t,s&&(r.y=r[s]),r.x===e&&i&&(r.x=n===e?i.autoIncrement():n),r},optionsToObject:function(e){var t={},n=this.series,r=n.pointArrayMap||["y"],i=r.length,s,o=0,u=0;if(typeof e=="number"||e===null)t[r[0]]=e;else if(Mt(e)){e.length>i&&(s=typeof e[0],s==="string"?t.name=e[0]:s==="number"&&(t.x=e[0]),o++);while(u<i)t[r[u++]]=e[o++]}else typeof e=="object"&&(t=e,e.dataLabels&&(n._hasPointLabels=!0),e.marker&&(n._hasPointMarkers=!0));return t},destroy:function(){var e=this,t=e.series,n=t.chart,r=n.hoverPoints,i;n.pointCount--,r&&(e.setState(),Ht(r,e),r.length||(n.hoverPoints=null)),e===n.hoverPoint&&e.onMouseOut();if(e.graphic||e.dataLabel)mn(e),e.destroyElements();e.legendItem&&n.legend.destroyItem(e);for(i in e)e[i]=null},destroyElements:function(){var e=this,t=["graphic","dataLabel","dataLabelUpper","group","connector","shadowGroup"],n,r=6;while(r--)n=t[r],e[n]&&(e[n]=e[n].destroy())},getLabelConfig:function(){var e=this;return{x:e.category,y:e.y,key:e.name||e.category,series:e.series,point:e,percentage:e.percentage,total:e.total||e.stackTotal}},tooltipFormatter:function(e){var t=this.series,n=t.tooltipOptions,r=It(n.valueDecimals,""),i=n.valuePrefix||"",s=n.valueSuffix||"";return cn(t.pointArrayMap||["y"],function(t){t="{point."+t;if(i||s)e=e.replace(t+"}",i+t+"}"+s);e=e.replace(t+"}",t+":,."+r+"f}")}),$t(e,{point:this,series:this.series})},firePointEvent:function(e,t,n){var r=this,i=this.series,s=i.options;(s.point.events[e]||r.options&&r.options.events&&r.options.events[e])&&this.importEvents(),e==="click"&&s.allowPointSelect&&(n=function(e){r.select(null,e.ctrlKey||e.metaKey||e.shiftKey)}),gn(this,e,t,n)}};var Yn=function(){};Yn.prototype={isCartesian:!0,type:"line",pointClass:Gn,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(e,t){var n=this,r,i,s=e.series,o=function(e,t){return It(e.options.index,e._i)-It(t.options.index,t._i)};n.chart=e,n.options=t=n.setOptions(t),n.linkedSeries=[],n.bindAxes(),Nt(n,{name:t.name,state:G,pointAttr:{},visible:t.visible!==!1,selected:t.selected===!0}),T&&(t.animation=!1),i=t.events;for(r in i)vn(n,r,i[r]);if(i&&i.click||t.point&&t.point.events&&t.point.events.click||t.allowPointSelect)e.runTrackerClick=!0;n.getColor(),n.getSymbol(),cn(n.parallelArrays,function(e){n[e+"Data"]=[]}),n.setData(t.data,!1),n.isCartesian&&(e.hasCartesianSeries=!0),s.push(n),n._i=s.length-1,Gt(s,o),this.yAxis&&Gt(this.yAxis.series,o),cn(s,function(e,t){e.index=t,e.name=e.name||"Series "+(t+1)})},bindAxes:function(){var t=this,n=t.options,r=t.chart,i;cn(t.axisTypes||[],function(s){cn(r[s],function(r){i=r.options;if(n[s]===i.index||n[s]!==e&&n[s]===i.id||n[s]===e&&i.index===0)r.series.push(t),t[s]=r,r.isDirty=!0}),!t[s]&&t.optionalAxis!==s&&nn(18,!0)})},updateParallelArrays:function(e,t){var n=e.series,r=arguments,i=typeof t=="number"?function(r){var i=r==="y"&&n.toYData?n.toYData(e):e[r];n[r+"Data"][t]=i}:function(e){Array.prototype[t].apply(n[e+"Data"],Array.prototype.slice.call(r,2))};cn(n.parallelArrays,i)},autoIncrement:function(){var e=this,t=e.options,n=e.xIncrement;return n=It(n,t.pointStart,0),e.pointInterval=It(e.pointInterval,t.pointInterval,1),e.xIncrement=n+e.pointInterval,n},getSegments:function(){var e=this,t=-1,n=[],r,i=e.points,s=i.length;if(s)if(e.options.connectNulls){r=s;while(r--)i[r].y===null&&i.splice(r,1);i.length&&(n=[i])}else cn(i,function(e,r){e.y===null?(r>t+1&&n.push(i.slice(t+1,r)),t=r):r===s-1&&n.push(i.slice(t+1,r+1))});e.segments=n},setOptions:function(e){var t=this.chart,n=t.options,r=n.plotOptions,i=t.userOptions||{},s=i.plotOptions||{},o=r[this.type],u;return this.userOptions=e,u=Ct(o,r.series,e),this.tooltipOptions=Ct(O.tooltip,O.plotOptions[this.type].tooltip,i.tooltip,s.series&&s.series.tooltip,s[this.type]&&s[this.type].tooltip,e.tooltip),o.marker===null&&delete u.marker,u},getColor:function(){var e=this.options,t=this.userOptions,n=this.chart.options.colors,r=this.chart.counters,i,s;i=e.color||Sn[this.type].color,!i&&!e.colorByPoint&&(Bt(t._colorIndex)?s=t._colorIndex:(t._colorIndex=r.color,s=r.color++),i=n[s]),this.color=i,r.wrapColor(n.length)},getSymbol:function(){var e=this,t=e.userOptions,n=e.options.marker,r=e.chart,i=r.options.symbols,s=r.counters,o;e.symbol=n.symbol,e.symbol||(Bt(t._symbolIndex)?o=t._symbolIndex:(t._symbolIndex=s.symbol,o=s.symbol++),e.symbol=i[o]),/^url/.test(e.symbol)&&(n.radius=0),s.wrapSymbol(i.length)},drawLegendSymbol:Jn.drawLineMarker,setData:function(t,n,r,i){var s=this,o=s.points,u=o&&o.length||0,a,f=s.options,l=s.chart,c=null,h=s.xAxis,p=h&&!!h.categories,d=s.tooltipPoints,v,m=f.turboThreshold,g,y=this.xData,b=this.yData,w=s.pointArrayMap,E=w&&w.length;t=t||[],a=t.length,n=It(n,!0);if(i!==!1&&a&&u===a&&!s.cropped&&!s.hasGroupedData)cn(t,function(e,t){o[t].update(e,!1)});else{s.xIncrement=null,s.pointRange=p?1:f.pointRange,s.colorCounter=0,cn(this.parallelArrays,function(e){s[e+"Data"].length=0});if(m&&a>m){v=0;while(c===null&&v<a)c=t[v],v++;if(_t(c)){var S=It(f.pointStart,0),x=It(f.pointInterval,1);for(v=0;v<a;v++)y[v]=S,b[v]=t[v],S+=x;s.xIncrement=S}else if(Mt(c))if(E)for(v=0;v<a;v++)g=t[v],y[v]=g[0],b[v]=g.slice(1,E+1);else for(v=0;v<a;v++)g=t[v],y[v]=g[0],b[v]=g[1];else nn(12)}else for(v=0;v<a;v++)t[v]!==e&&(g={series:s},s.pointClass.prototype.applyOptions.apply(g,[t[v]]),s.updateParallelArrays(g,v),p&&g.name&&(h.names[g.x]=g.name));At(b[0])&&nn(14,!0),s.data=[],s.options.data=t,v=u;while(v--)o[v]&&o[v].destroy&&o[v].destroy();d&&(d.length=0),h&&(h.minRange=h.userMinRange),s.isDirty=s.isDirtyData=l.isDirtyBox=!0,r=!1}n&&l.redraw(r)},processData:function(t){var n=this,r=n.xData,i=n.yData,s=r.length,o,u=0,a,f,l,c=n.xAxis,h,p=n.options,d=p.cropThreshold,v=0,m=n.isCartesian,g,y;if(m&&!n.isDirty&&!c.isDirty&&!n.yAxis.isDirty&&!t)return!1;if(m&&n.sorted&&(!d||s>d||n.forceCrop)){g=c.min,y=c.max;if(r[s-1]<g||r[0]>y)r=[],i=[];else if(r[0]<g||r[s-1]>y)o=this.cropData(n.xData,n.yData,g,y),r=o.xData,i=o.yData,u=o.start,a=!0,v=r.length}for(h=r.length-1;h>=0;h--)f=r[h]-r[h-1],!a&&r[h]>g&&r[h]<y&&v++,f>0&&(l===e||f<l)?l=f:f<0&&n.requireSorting&&nn(15);n.cropped=a,n.cropStart=u,n.processedXData=r,n.processedYData=i,n.activePointCount=v,p.pointRange===null&&(n.pointRange=l||1),n.closestPointRange=l},cropData:function(e,t,n,r){var i=e.length,s=0,o=i,a=It(this.cropShoulder,1),f;for(f=0;f<i;f++)if(e[f]>=n){s=u(0,f-a);break}for(;f<i;f++)if(e[f]>r){o=f+a;break}return{xData:e.slice(s,o),yData:t.slice(s,o),start:s,end:o}},generatePoints:function(){var t=this,n=t.options,r=n.data,i=t.data,s,o=t.processedXData,u=t.processedYData,a=t.pointClass,f=o.length,l=t.cropStart||0,c,h=t.hasGroupedData,p,d=[],v;if(!i&&!h){var m=[];m.length=r.length,i=t.data=m}for(v=0;v<f;v++)c=l+v,h?d[v]=(new a).init(t,[o[v]].concat(Ft(u[v]))):(i[c]?p=i[c]:r[c]!==e&&(i[c]=p=(new a).init(t,r[c],o[v])),d[v]=p);if(i&&(f!==(s=i.length)||h))for(v=0;v<s;v++)v===l&&!h&&(v+=f),i[v]&&(i[v].destroyElements(),i[v].plotX=e);t.data=i,t.points=d},getExtremes:function(t){var n=this.xAxis,r=this.yAxis,i=this.processedXData,s,o=[],u=0,a=n.getExtremes(),f=a.min,l=a.max,c,h,p,d,v,m,g,y;t=t||this.stackedYData||this.processedYData,s=t.length;for(g=0;g<s;g++){v=i[g],m=t[g],c=m!==null&&m!==e&&(!r.isLog||m.length||m>0),h=this.getExtremesFromAll||this.cropped||(i[g+1]||v)>=f&&(i[g-1]||v)<=l;if(c&&h){y=m.length;if(y)while(y--)m[y]!==null&&(o[u++]=m[y]);else o[u++]=m}}this.dataMin=It(p,Yt(o)),this.dataMax=It(d,Zt(o))},translate:function(){this.processedXData||this.processData(),this.generatePoints();var t=this,n=t.options,r=n.stacking,i=t.xAxis,s=i.categories,o=t.yAxis,u=t.points,a=u.length,f=!!t.modifyValue,l,c=n.pointPlacement,h=c==="between"||_t(c),p=n.threshold;for(l=0;l<a;l++){var d=u[l],v=d.x,m=d.y,g=d.low,y=r&&o.stacks[(t.negStacks&&m<p?"-":"")+t.stackKey],b,w;o.isLog&&m<=0&&(d.y=m=null),d.plotX=i.translate(v,0,0,0,1,c,this.type==="flags"),r&&t.visible&&y&&y[v]&&(b=y[v],w=b.points[t.index+","+l],g=w[0],m=w[1],g===0&&(g=It(p,o.min)),o.isLog&&g<=0&&(g=null),d.total=d.stackTotal=b.total,d.percentage=b.total&&d.y/b.total*100,d.stackY=m,b.setOffset(t.pointXOffset||0,t.barW||0)),d.yBottom=Bt(g)?o.translate(g,0,1,0,1):null,f&&(m=t.modifyValue(m,d)),d.plotY=typeof m=="number"&&m!==Infinity?o.translate(m,0,1,0,1):e,d.clientX=h?i.translate(v,0,0,0,1):d.plotX,d.negative=d.y<(p||0),d.category=s&&s[d.x]!==e?s[d.x]:d.x}t.getSegments()},animate:function(e){var t=this,n=t.chart,r=n.renderer,i,s,o=t.options.animation,u=t.clipBox||n.clipBox,a=n.inverted,f;o&&!Ot(o)&&(o=Sn[t.type].animation),f=["_sharedClip",o.duration,o.easing,u.height].join(","),e?(i=n[f],s=n[f+"m"],i||(n[f]=i=r.clipRect(Nt(u,{width:0})),n[f+"m"]=s=r.clipRect(-99,a?-n.plotLeft:-n.plotTop,99,a?n.chartWidth:n.chartHeight)),t.group.clip(i),t.markerGroup.clip(s),t.sharedClipKey=f):(i=n[f],i&&i.animate({width:n.plotSizeX},o),n[f+"m"]&&n[f+"m"].animate({width:n.plotSizeX+99},o),t.animate=null)},afterAnimate:function(){var e=this.chart,t=this.sharedClipKey,n=this.group,r=this.clipBox;n&&this.options.clip!==!1&&((!t||!r)&&n.clip(r?e.renderer.clipRect(r):e.clipRect),this.markerGroup.clip()),gn(this,"afterAnimate"),setTimeout(function(){t&&e[t]&&(r||(e[t]=e[t].destroy()),e[t+"m"]&&(e[t+"m"]=e[t+"m"].destroy()))},100)},drawPoints:function(){var t=this,n,r=t.points,o=t.chart,u,a,f,l,c,h,p,d,v=t.options,m=v.marker,g=t.pointAttr[""],y,b,w,E=t.markerGroup,S=It(m.enabled,t.activePointCount<.5*t.xAxis.len/m.radius);if(m.enabled!==!1||t._hasPointMarkers){f=r.length;while(f--)l=r[f],u=s(l.plotX),a=l.plotY,d=l.graphic,y=l.marker||{},b=S&&y.enabled===e||y.enabled,w=o.isInsidePlot(i(u),a,o.inverted),b&&a!==e&&!isNaN(a)&&l.y!==null?(n=l.pointAttr[l.selected?Z:G]||g,c=n.r,h=It(y.symbol,t.symbol),p=h.indexOf("url")===0,d?d[w?"show":"hide"](!0).animate(Nt({x:u-c,y:a-c},d.symbolName?{width:2*c,height:2*c}:{})):w&&(c>0||p)&&(l.graphic=d=o.renderer.symbol(h,u-c,a-c,2*c,2*c).attr(n).add(E))):d&&(l.graphic=d.destroy())}},convertAttribs:function(e,t,n,r){var i=this.pointAttrToOptions,s,o,u={};e=e||{},t=t||{},n=n||{},r=r||{};for(s in i)o=i[s],u[s]=It(e[o],t[s],n[s],r[s]);return u},getAttribs:function(){var e=this,t=e.options,n=Sn[e.type].marker?t.marker:t,r=n.states,i=r[Y],s,o=e.color,u={stroke:o,fill:o},a=e.points||[],f,l,c=[],h,p=e.pointAttrToOptions,d=e.hasPointSpecificOptions,v=t.negativeColor,m=n.lineColor,g=n.fillColor,y=t.turboThreshold,b,w;t.marker?(i.radius=i.radius||n.radius+2,i.lineWidth=i.lineWidth||n.lineWidth+1):i.color=i.color||On(i.color||o).brighten(i.brightness).get(),c[G]=e.convertAttribs(n,u),cn([Y,Z],function(t){c[t]=e.convertAttribs(r[t],c[G])}),e.pointAttr=c,f=a.length;if(!y||f<y||d)while(f--){l=a[f],n=l.options&&l.options.marker||l.options,n&&n.enabled===!1&&(n.radius=0),l.negative&&v&&(l.color=l.fillColor=v),d=t.colorByPoint||l.color;if(l.options)for(w in p)Bt(n[p[w]])&&(d=!0);d?(n=n||{},h=[],r=n.states||{},s=r[Y]=r[Y]||{},t.marker||(s.color=s.color||!l.options.color&&i.color||On(l.color).brighten(s.brightness||i.brightness).get()),b={color:l.color},g||(b.fillColor=l.color),m||(b.lineColor=l.color),h[G]=e.convertAttribs(Nt(b,n),c[G]),h[Y]=e.convertAttribs(r[Y],c[Y],h[G]),h[Z]=e.convertAttribs(r[Z],c[Z],h[G])):h=c,l.pointAttr=h}},destroy:function(){var e=this,t=e.chart,n=/AppleWebKit\/533/.test(d),r,i,s=e.data||[],o,u,a;gn(e,"destroy"),mn(e),cn(e.axisTypes||[],function(t){a=e[t],a&&(Ht(a.series,e),a.isDirty=a.forceRedraw=!0)}),e.legendItem&&e.chart.legend.destroyItem(e),i=s.length;while(i--)o=s[i],o&&o.destroy&&o.destroy();e.points=null,clearTimeout(e.animationTimeout),cn(["area","graph","dataLabelsGroup","group","markerGroup","tracker","graphNeg","areaNeg","posClip","negClip"],function(t){e[t]&&(r=n&&t==="group"?"hide":"destroy",e[t][r]())}),t.hoverSeries===e&&(t.hoverSeries=null),Ht(t.series,e);for(u in e)delete e[u]},getSegmentPath:function(e){var t=this,n=[],r=t.options.step;return cn(e,function(i,s){var o=i.plotX,u=i.plotY,a;t.getPointSpline?n.push.apply(n,t.getPointSpline(e,i,s)):(n.push(s?K:J),r&&s&&(a=e[s-1],r==="right"?n.push(a.plotX,u):r==="center"?n.push((a.plotX+o)/2,a.plotY,(a.plotX+o)/2,u):n.push(o,a.plotY)),n.push(i.plotX,i.plotY))}),n},getGraphPath:function(){var e=this,t=[],n,r=[];return cn(e.segments,function(i){n=e.getSegmentPath(i),i.length>1?t=t.concat(n):r.push(i[0])}),e.singlePoints=r,e.graphPath=t,t},drawGraph:function(){var e=this,t=this.options,n=[["graph",t.lineColor||this.color]],r=t.lineWidth,i=t.dashStyle,s=t.linecap!=="square",o=this.getGraphPath(),u=t.negativeColor;u&&n.push(["graphNeg",u]),cn(n,function(n,u){var a=n[0],f=e[a],l;f?(wn(f),f.animate({d:o})):r&&o.length&&(l={stroke:n[1],"stroke-width":r,fill:$,zIndex:1},i?l.dashstyle=i:s&&(l["stroke-linecap"]=l["stroke-linejoin"]="round"),e[a]=e.chart.renderer.path(o).attr(l).add(e.group).shadow(!u&&t.shadow))})},clipNeg:function(){var e=this.options,t=this.chart,n=t.renderer,r=e.negativeColor||e.negativeFillColor,s,o,a,f=this.graph,l=this.area,c=this.posClip,h=this.negClip,p=t.chartWidth,d=t.chartHeight,v=u(p,d),m=this.yAxis,g,y;r&&(f||l)&&(s=i(m.toPixels(e.threshold||0,!0)),s<0&&(v-=s),g={x:0,y:0,width:v,height:s},y={x:0,y:s,width:v,height:v},t.inverted&&(g.height=y.y=t.plotWidth-s,n.isVML&&(g={x:t.plotWidth-s-t.plotLeft,y:0,width:p,height:d},y={x:s+t.plotLeft-p,y:0,width:t.plotLeft+s,height:p})),m.reversed?(o=y,a=g):(o=g,a=y),c?(c.animate(o),h.animate(a)):(this.posClip=c=n.clipRect(o),this.negClip=h=n.clipRect(a),f&&this.graphNeg&&(f.clip(c),this.graphNeg.clip(h)),l&&(l.clip(c),this.areaNeg.clip(h))))},invertGroups:function(){function n(){var t={width:e.yAxis.len,height:e.xAxis.len};cn(["group","markerGroup"],function(n){e[n]&&e[n].attr(t).invert()})}var e=this,t=e.chart;if(!e.xAxis)return;vn(t,"resize",n),vn(e,"destroy",function(){mn(t,"resize",n)}),n(),e.invertGroups=n},plotGroup:function(e,t,n,r,i){var s=this[e],o=!s;return o&&(this[e]=s=this.chart.renderer.g(t).attr({visibility:n,zIndex:r||.1}).add(i)),s[o?"attr":"animate"](this.getPlotBox()),s},getPlotBox:function(){var e=this.chart,t=this.xAxis,n=this.yAxis;return e.inverted&&(t=n,n=this.xAxis),{translateX:t?t.left:e.plotLeft,translateY:n?n.top:e.plotTop,scaleX:1,scaleY:1}},render:function(){var e=this,t=e.chart,n,r=e.options,i=r.animation,s=i&&!!e.animate&&t.renderer.isSVG&&It(i.duration,500)||0,o=e.visible?X:z,u=r.zIndex,a=e.hasRendered,f=t.seriesGroup;n=e.plotGroup("group","series",o,u,f),e.markerGroup=e.plotGroup("markerGroup","markers",o,u,f),s&&e.animate(!0),e.getAttribs(),n.inverted=e.isCartesian?t.inverted:!1,e.drawGraph&&(e.drawGraph(),e.clipNeg()),e.drawDataLabels&&e.drawDataLabels(),e.visible&&e.drawPoints(),e.drawTracker&&e.options.enableMouseTracking!==!1&&e.drawTracker(),t.inverted&&e.invertGroups(),r.clip!==!1&&!e.sharedClipKey&&!a&&n.clip(t.clipRect),s&&e.animate(),a||(s?e.animationTimeout=setTimeout(function(){e.afterAnimate()},s):e.afterAnimate()),e.isDirty=e.isDirtyData=!1,e.hasRendered=!0},redraw:function(){var e=this,t=e.chart,n=e.isDirtyData,r=e.group,i=e.xAxis,s=e.yAxis;r&&(t.inverted&&r.attr({width:t.plotWidth,height:t.plotHeight}),r.animate({translateX:It(i&&i.left,t.plotLeft),translateY:It(s&&s.top,t.plotTop)})),e.translate(),e.setTooltipPoints&&e.setTooltipPoints(!0),e.render(),n&&gn(e,"updatedData")}},Zn.prototype={destroy:function(){en(this,this.axis)},render:function(e){var t=this.options,n=t.format,r=n?$t(n,this):t.formatter.call(this);this.label?this.label.attr({text:r,visibility:z}):this.label=this.axis.chart.renderer.text(r,null,null,t.useHTML).css(t.style).attr({align:this.textAlign,rotation:t.rotation,visibility:z}).add(e)},setOffset:function(e,t){var n=this,r=n.axis,i=r.chart,s=i.inverted,o=this.isNegative,u=r.translate(r.usePercentage?100:this.total,0,0,0,1),a=r.translate(0),l=f(u-a),c=i.xAxis[0].translate(this.x)+e,h=i.plotHeight,p={x:s?o?u:u-l:c,y:s?h-c-t:o?h-u-l:h-u,width:s?l:t,height:s?t:l},d=this.label,v;d&&(d.align(this.alignOptions,null,p),v=d.alignAttr,d[this.options.crop===!1||i.isInsidePlot(v.x,v.y)?"show":"hide"](!0))}},In.prototype.buildStacks=function(){var e=this.series,t=It(this.options.reversedStacks,!0),n=e.length;if(!this.isXAxis){this.usePercentage=!1;while(n--)e[t?n:e.length-n-1].setStackedPoints();if(this.usePercentage)for(n=0;n<e.length;n++)e[n].setPercentStacks()}},In.prototype.renderStackTotals=function(){var e=this,t=e.chart,n=t.renderer,r=e.stacks,i,s,o,u=e.stackTotalGroup;u||(e.stackTotalGroup=u=n.g("stack-labels").attr({visibility:X,zIndex:6}).add()),u.translate(t.plotLeft,t.plotTop);for(i in r){s=r[i];for(o in s)s[o].render(u)}},Yn.prototype.setStackedPoints=function(){if(!this.options.stacking||this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)return;var e=this,t=e.processedXData,n=e.processedYData,r=[],i=n.length,s=e.options,o=s.threshold,a=s.stack,l=s.stacking,c=e.stackKey,h="-"+c,p=e.negStacks,d=e.yAxis,v=d.stacks,m=d.oldStacks,g,y,b,w,E,S,x,T;for(S=0;S<i;S++)x=t[S],T=n[S],E=e.index+","+S,g=p&&T<o,w=g?h:c,v[w]||(v[w]={}),v[w][x]||(m[w]&&m[w][x]?(v[w][x]=m[w][x],v[w][x].total=null):v[w][x]=new Zn(d,d.options.stackLabels,g,x,a)),y=v[w][x],y.points[E]=[y.cum||0],l==="percent"?(b=g?c:h,p&&v[b]&&v[b][x]?(b=v[b][x],y.total=b.total=u(b.total,y.total)+f(T)||0):y.total=rn(y.total+(f(T)||0))):y.total=rn(y.total+(T||0)),y.cum=(y.cum||0)+(T||0),y.points[E].push(y.cum),r[S]=y.cum;l==="percent"&&(d.usePercentage=!0),this.stackedYData=r,d.oldStacks={}},Yn.prototype.setPercentStacks=function(){var e=this,t=e.stackKey,n=e.yAxis.stacks,r=e.processedXData;cn([t,"-"+t],function(t){var i=r.length,s,o,u,a;while(i--)s=r[i],o=n[t]&&n[t][s],u=o&&o.points[e.index+","+i],u&&(a=o.total?100/o.total:0,u[0]=rn(u[0]*a),u[1]=rn(u[1]*a),e.stackedYData[i]=u[1])})},Nt(Kn.prototype,{addSeries:function(e,t,n){var r,i=this;return e&&(t=It(t,!0),gn(i,"addSeries",{options:e},function(){r=i.initSeries(e),i.isDirtyLegend=!0,i.linkSeries(),t&&i.redraw(n)})),r},addAxis:function(e,t,n,r){var i=t?"xAxis":"yAxis",s=this.options,o;o=new In(this,Ct(e,{index:this[i].length,isX:t})),s[i]=Ft(s[i]||{}),s[i].push(e),It(n,!0)&&this.redraw(r)},showLoading:function(e){var t=this,n=t.options,r=t.loadingDiv,i=n.loading;r||(t.loadingDiv=r=Rt(q,{className:W+"loading"},Nt(i.style,{zIndex:10,display:$}),t.container),t.loadingSpan=Rt("span",null,i.labelStyle,r)),t.loadingSpan.innerHTML=e||n.lang.loading,t.loadingShown||(qt(r,{opacity:0,display:"",left:t.plotLeft+V,top:t.plotTop+V,width:t.plotWidth+V,height:t.plotHeight+V}),bn(r,{opacity:i.style.opacity},{duration:i.showDuration||0}),t.loadingShown=!0)},hideLoading:function(){var e=this.options,t=this.loadingDiv;t&&bn(t,{opacity:0},{duration:e.loading.hideDuration||100,complete:function(){qt(t,{display:$})}}),this.loadingShown=!1}}),Nt(Gn.prototype,{update:function(e,t,n){var r=this,i=r.series,s=r.graphic,o,u=i.data,a=i.chart,f=i.options;t=It(t,!0),r.firePointEvent("update",{options:e},function(){r.applyOptions(e),Ot(e)&&(i.getAttribs(),s&&(e&&e.marker&&e.marker.symbol?r.graphic=s.destroy():s.attr(r.pointAttr[r.state||""])),e&&e.dataLabels&&r.dataLabel&&(r.dataLabel=r.dataLabel.destroy())),o=ln(r,u),i.updateParallelArrays(r,o),f.data[o]=r.options,i.isDirty=i.isDirtyData=!0,!i.fixedBox&&i.hasCartesianSeries&&(a.isDirtyBox=!0),f.legendType==="point"&&a.legend.destroyItem(r),t&&a.redraw(n)})},remove:function(e,t){var n=this,r=n.series,i=r.points,s=r.chart,o,u=r.data;sn(t,s),e=It(e,!0),n.firePointEvent("remove",null,function(){o=ln(n,u),u.length===i.length&&i.splice(o,1),u.splice(o,1),r.options.data.splice(o,1),r.updateParallelArrays(n,"splice",o,1),n.destroy(),r.isDirty=!0,r.isDirtyData=!0,e&&s.redraw()})}}),Nt(Yn.prototype,{addPoint:function(e,t,n,r){var i=this,s=i.options,o=i.data,u=i.graph,a=i.area,f=i.chart,l=i.xAxis&&i.xAxis.names,c=u&&u.shift||0,h=s.data,p,d,v=i.xData,m,g;sn(r,f),n&&cn([u,a,i.graphNeg,i.areaNeg],function(e){e&&(e.shift=c+1)}),a&&(a.isArea=!0),t=It(t,!0),p={series:i},i.pointClass.prototype.applyOptions.apply(p,[e]),m=p.x,g=v.length;if(i.requireSorting&&m<v[g-1]){d=!0;while(g&&v[g-1]>m)g--}i.updateParallelArrays(p,"splice",g,0,0),i.updateParallelArrays(p,g),l&&(l[m]=p.name),h.splice(g,0,e),d&&(i.data.splice(g,0,null),i.processData()),s.legendType==="point"&&i.generatePoints(),n&&(o[0]&&o[0].remove?o[0].remove(!1):(o.shift(),i.updateParallelArrays(p,"shift"),h.shift())),i.isDirty=!0,i.isDirtyData=!0,t&&(i.getAttribs(),f.redraw())},remove:function(e,t){var n=this,r=n.chart;e=It(e,!0),n.isRemoving||(n.isRemoving=!0,gn(n,"remove",null,function(){n.destroy(),r.isDirtyLegend=r.isDirtyBox=!0,r.linkSeries(),e&&r.redraw(t)})),n.isRemoving=!1},update:function(t,n){var r=this.chart,i=this.userOptions,s=this.type,o=xt[s].prototype,u;t=Ct(i,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},t),this.remove(!1);for(u in o)o.hasOwnProperty(u)&&(this[u]=e);Nt(this,xt[t.type||s].prototype),this.init(r,t),It(n,!0)&&r.redraw(!1)}}),Nt(In.prototype,{update:function(t,n){var r=this.chart;t=r.options[this.coll][this.options.index]=Ct(this.userOptions,t),this.destroy(!0),this._addedPlotLB=e,this.init(r,Nt(t,{events:e})),r.isDirtyBox=!0,It(n,!0)&&r.redraw()},remove:function(e){var t=this.chart,n=this.coll,r=this.series,i=r.length;while(i--)r[i]&&r[i].remove(!1);Ht(t.axes,this),Ht(t[n],this),t.options[n].splice(this.options.index,1),cn(t[n],function(e,t){e.options.index=t}),this.destroy(),t.isDirtyBox=!0,It(e,!0)&&t.redraw()},setTitle:function(e,t){this.update({title:e},t)},setCategories:function(e,t){this.update({categories:e},t)}});var er=Ut(Yn);xt.line=er,Sn.area=Ct(xn,{threshold:0});var tr=Ut(Yn,{type:"area",getSegments:function(){var e=[],t=[],n=[],r=this.xAxis,i=this.yAxis,s=i.stacks[this.stackKey],o={},u,a,f=this.points,l=this.options.connectNulls,c,h,p;if(this.options.stacking&&!this.cropped){for(h=0;h<f.length;h++)o[f[h].x]=f[h];for(p in s)s[p].total!==null&&n.push(+p);n.sort(function(e,t){return e-t}),cn(n,function(e){if(l&&(!o[e]||o[e].y===null))return;o[e]?t.push(o[e]):(u=r.translate(e),c=s[e].percent?s[e].total?s[e].cum*100/s[e].total:0:s[e].cum,a=i.toPixels(c,!0),t.push({y:null,plotX:u,clientX:u,plotY:a,yBottom:a,onMouseOver:H}))}),t.length&&e.push(t)}else Yn.prototype.getSegments.call(this),e=this.segments;this.segments=e},getSegmentPath:function(e){var t=Yn.prototype.getSegmentPath.call(this,e),n=[].concat(t),r,i=this.options,s=t.length,o=this.yAxis.getThreshold(i.threshold),u;s===3&&n.push(K,t[1],t[2]);if(i.stacking&&!this.closedStacks)for(r=e.length-1;r>=0;r--)u=It(e[r].yBottom,o),r<e.length-1&&i.step&&n.push(e[r+1].plotX,u),n.push(e[r].plotX,u);else this.closeSegment(n,e,o);return this.areaPath=this.areaPath.concat(n),t},closeSegment:function(e,t,n){e.push(K,t[t.length-1].plotX,n,K,t[0].plotX,n)},drawGraph:function(){this.areaPath=[],Yn.prototype.drawGraph.apply(this);var e=this,t=this.areaPath,n=this.options,r=n.negativeColor,i=n.negativeFillColor,s=[["area",this.color,n.fillColor]];(r||i)&&s.push(["areaNeg",r,i]),cn(s,function(r){var i=r[0],s=e[i];s?s.animate({d:t}):e[i]=e.chart.renderer.path(t).attr({fill:It(r[2],On(r[1]).setOpacity(It(n.fillOpacity,.75)).get()),zIndex:0}).add(e.group)})},drawLegendSymbol:Jn.drawRectangle});xt.area=tr,Sn.spline=Ct(xn);var nr=Ut(Yn,{type:"spline",getPointSpline:function(e,t,n){var r=1.5,i=r+1,s=t.plotX,o=t.plotY,f=e[n-1],l=e[n+1],c,h,p,d,v;if(f&&l){var m=f.plotX,g=f.plotY,y=l.plotX,b=l.plotY,w;c=(r*s+m)/i,h=(r*o+g)/i,p=(r*s+y)/i,d=(r*o+b)/i,w=(d-h)*(p-s)/(p-c)+o-d,h+=w,d+=w,h>g&&h>o?(h=u(g,o),d=2*o-h):h<g&&h<o&&(h=a(g,o),d=2*o-h),d>b&&d>o?(d=u(b,o),h=2*o-d):d<b&&d<o&&(d=a(b,o),h=2*o-d),t.rightContX=p,t.rightContY=d}return n?(v=["C",f.rightContX||f.plotX,f.rightContY||f.plotY,c||s,h||o,s,o],f.rightContX=f.rightContY=null):v=[J,s,o],v}});xt.spline=nr,Sn.areaspline=Ct(Sn.area);var rr=tr.prototype,ir=Ut(nr,{type:"areaspline",closedStacks:!0,getSegmentPath:rr.getSegmentPath,closeSegment:rr.closeSegment,drawGraph:rr.drawGraph,drawLegendSymbol:Jn.drawRectangle});xt.areaspline=ir,Sn.column=Ct(xn,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},stickyTracking:!1,tooltip:{distance:6},threshold:0});var sr=Ut(Yn,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},cropShoulder:0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){Yn.prototype.init.apply(this,arguments);var e=this,t=e.chart;t.hasRendered&&cn(t.series,function(t){t.type===e.type&&(t.isDirty=!0)})},getColumnMetrics:function(){var t=this,n=t.options,r=t.xAxis,i=t.yAxis,s=r.reversed,o,u={},l,c=0;n.grouping===!1?c=1:cn(t.chart.series,function(n){var r=n.options,s=n.yAxis;n.type===t.type&&n.visible&&i.len===s.len&&i.pos===s.pos&&(r.stacking?(o=n.stackKey,u[o]===e&&(u[o]=c++),l=u[o]):r.grouping!==!1&&(l=c++),n.columnIndex=l)});var h=a(f(r.transA)*(r.ordinalSlope||n.pointRange||r.closestPointRange||r.tickInterval||1),r.len),p=h*n.groupPadding,d=h-2*p,v=d/c,m=n.pointWidth,g=Bt(m)?(v-m)/2:v*n.pointPadding,y=It(m,v-2*g),b=(s?c-(t.columnIndex||0):t.columnIndex)||0,w=g+(p+b*v-h/2)*(s?-1:1);return t.columnMetrics={width:y,offset:w}},translate:function(){var e=this,t=e.chart,n=e.options,r=e.borderWidth=It(n.borderWidth,e.activePointCount>.5*e.xAxis.len?0:1),s=e.yAxis,l=n.threshold,c=e.translatedThreshold=s.getThreshold(l),h=It(n.minPointLength,5),p=e.getColumnMetrics(),d=p.width,v=e.barW=o(u(d,1+2*r)),m=e.pointXOffset=p.offset,g=-(r%2?.5:0),y=r%2?.5:1;t.renderer.isVML&&t.inverted&&(y+=1),Yn.prototype.translate.apply(e),cn(e.points,function(n){var r=It(n.yBottom,c),o=a(u(-999-r,n.plotY),s.len+999+r),l=n.plotX+m,p=v,b=a(o,r),w,E,S,x,T=u(o,r)-b;f(T)<h&&h&&(T=h,b=i(f(b-c)>h?r-h:c-(s.translate(n.y,0,1,0,1)<=c?h:0))),n.barX=l,n.pointWidth=d,n.tooltipPos=t.inverted?[s.len-o,e.xAxis.len-l-p/2]:[l+p/2,o],x=f(l)<.5,w=i(l+p)+g,l=i(l)+g,p=w-l,S=f(b)<.5,E=i(b+T)+y,b=i(b)+y,T=E-b,x&&(l+=1,p-=1),S&&(b-=1,T+=1),n.shapeType="rect",n.shapeArgs={x:l,y:b,width:p,height:T}})},getSymbol:H,drawLegendSymbol:Jn.drawRectangle,drawGraph:H,drawPoints:function(){var t=this,n=this.chart,r=t.options,i=n.renderer,s=r.animationLimit||250,o,u,a;cn(t.points,function(f){var l=f.plotY,c=f.graphic;l!==e&&!isNaN(l)&&f.y!==null?(o=f.shapeArgs,a=Bt(t.borderWidth)?{"stroke-width":t.borderWidth}:{},u=f.pointAttr[f.selected?Z:G]||t.pointAttr[G],c?(wn(c),c.attr(a)[n.pointCount<s?"animate":"attr"](Ct(o))):f.graphic=c=i[f.shapeType](o).attr(u).attr(a).add(t.group).shadow(r.shadow,null,r.stacking&&!r.borderRadius)):c&&(f.graphic=c.destroy())})},animate:function(e){var t=this,n=this.yAxis,r=t.options,i=this.chart.inverted,s={},o;S&&(e?(s.scaleY=.001,o=a(n.pos+n.len,u(n.pos,n.toPixels(r.threshold))),i?s.translateX=o-n.len:s.translateY=o,t.group.attr(s)):(s.scaleY=1,s[i?"translateX":"translateY"]=n.pos,t.group.animate(s,t.options.animation),t.animate=null))},remove:function(){var e=this,t=e.chart;t.hasRendered&&cn(t.series,function(t){t.type===e.type&&(t.isDirty=!0)}),Yn.prototype.remove.apply(e,arguments)}});xt.column=sr,Sn.bar=Ct(Sn.column);var or=Ut(sr,{type:"bar",inverted:!0});xt.bar=or,Sn.scatter=Ct(xn,{lineWidth:0,tooltip:{headerFormat:'<span style="color:{series.color}"></span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"},stickyTracking:!1});var ur=Ut(Yn,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["markerGroup"],takeOrdinalPosition:!1,singularTooltips:!0,drawGraph:function(){this.options.lineWidth&&Yn.prototype.drawGraph.call(this)}});xt.scatter=ur,Sn.pie=Ct(xn,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});var ar=Ut(Gn,{init:function(){Gn.prototype.init.apply(this,arguments);var e=this,t;return e.y<0&&(e.y=null),Nt(e,{visible:e.visible!==!1,name:It(e.name,"Slice")}),t=function(t){e.slice(t.type==="select")},vn(e,"select",t),vn(e,"unselect",t),e},setVisible:function(t){var n=this,r=n.series,i=r.chart;n.visible=n.options.visible=t=t===e?!n.visible:t,r.options.data[ln(n,r.data)]=n.options,cn(["graphic","dataLabel","connector","shadowGroup"],function(e){n[e]&&n[e][t?"show":"hide"](!0)}),n.legendItem&&i.legend.colorizeItem(n,t),!r.isDirty&&r.options.ignoreHiddenPoint&&(r.isDirty=!0,i.redraw())},slice:function(e,t,n){var r=this,i=r.series,s=i.chart,o;sn(n,s),t=It(t,!0),r.sliced=r.options.sliced=e=Bt(e)?e:!r.sliced,i.options.data[ln(r,i.data)]=r.options,o=e?r.slicedTranslation:{translateX:0,translateY:0},r.graphic.animate(o),r.shadowGroup&&r.shadowGroup.animate(o)},haloPath:function(e){var t=this.shapeArgs,n=this.series.chart;return this.series.chart.renderer.symbols.arc(n.plotLeft+t.x,n.plotTop+t.y,t.r+e,t.r+e,{innerR:this.shapeArgs.r,start:t.start,end:t.end})}}),fr={type:"pie",isCartesian:!1,pointClass:ar,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},singularTooltips:!0,getColor:H,animate:function(e){var t=this,n=t.points,r=t.startAngleRad;e||(cn(n,function(e){var n=e.graphic,i=e.shapeArgs;n&&(n.attr({r:t.center[3]/2,start:r,end:r}),n.animate({r:i.r,start:i.start,end:i.end},t.options.animation))}),t.animate=null)},setData:function(e,t,n,r){Yn.prototype.setData.call(this,e,!1,n,r),this.processData(),this.generatePoints(),It(t,!0)&&this.chart.redraw(n)},generatePoints:function(){var e,t=0,n,r,i,s=this.options.ignoreHiddenPoint;Yn.prototype.generatePoints.call(this),n=this.points,r=n.length;for(e=0;e<r;e++)i=n[e],t+=s&&!i.visible?0:i.y;this.total=t;for(e=0;e<r;e++)i=n[e],i.percentage=t>0?i.y/t*100:0,i.total=t},translate:function(e){this.generatePoints();var t=this,n=0,s=1e3,o=t.options,u=o.slicedOffset,f=u+o.borderWidth,p,d,v,m=o.startAngle||0,g=t.startAngleRad=h/180*(m-90),y=t.endAngleRad=h/180*(It(o.endAngle,m+360)-90),b=y-g,w=t.points,E,S,x=o.dataLabels.distance,T=o.ignoreHiddenPoint,N,C=w.length,k;e||(t.center=e=t.getCenter()),t.getX=function(t,n){return v=r.asin(a((t-e[1])/(e[2]/2+x),1)),e[0]+(n?-1:1)*l(v)*(e[2]/2+x)};for(N=0;N<C;N++){k=w[N],p=g+n*b;if(!T||k.visible)n+=k.percentage/100;d=g+n*b,k.shapeType="arc",k.shapeArgs={x:e[0],y:e[1],r:e[2]/2,innerR:e[3]/2,start:i(p*s)/s,end:i(d*s)/s},v=(d+p)/2,v>1.5*h?v-=2*h:v<-h/2&&(v+=2*h),k.slicedTranslation={translateX:i(l(v)*u),translateY:i(c(v)*u)},E=l(v)*e[2]/2,S=c(v)*e[2]/2,k.tooltipPos=[e[0]+E*.7,e[1]+S*.7],k.half=v<-h/2||v>h/2?1:0,k.angle=v,f=a(f,x/2),k.labelPos=[e[0]+E+l(v)*x,e[1]+S+c(v)*x,e[0]+E+l(v)*f,e[1]+S+c(v)*f,e[0]+E,e[1]+S,x<0?"center":k.half?"right":"left",v]}},drawGraph:null,drawPoints:function(){var e=this,t=e.chart,n=t.renderer,r,i,s=e.options.shadow,o,u;s&&!e.shadowGroup&&(e.shadowGroup=n.g("shadow").add(e.group)),cn(e.points,function(t){i=t.graphic,u=t.shapeArgs,o=t.shadowGroup,s&&!o&&(o=t.shadowGroup=n.g("shadow").add(e.shadowGroup)),r=t.sliced?t.slicedTranslation:{translateX:0,translateY:0},o&&o.attr(r),i?i.animate(Nt(u,r)):t.graphic=i=n[t.shapeType](u).setRadialReference(e.center).attr(t.pointAttr[t.selected?Z:G]).attr({"stroke-linejoin":"round"}).attr(r).add(e.group).shadow(s,o),t.visible!==undefined&&t.setVisible(t.visible)})},sortByAngle:function(e,t){e.sort(function(e,n){return e.angle!==undefined&&(n.angle-e.angle)*t})},drawLegendSymbol:Jn.drawRectangle,getCenter:Qn.getCenter,getSymbol:H};fr=Ut(Yn,fr),xt.pie=fr,Yn.prototype.drawDataLabels=function(){var t=this,n=t.options,r=n.cursor,i=n.dataLabels,s=t.points,o,u,a,f;if(i.enabled||t._hasPointLabels)t.dlProcessOptions&&t.dlProcessOptions(i),f=t.plotGroup("dataLabelsGroup","data-labels",z,i.zIndex||6),!t.hasRendered&&It(i.defer,!0)&&(f.attr({opacity:0}),vn(t,"afterAnimate",function(){t.dataLabelsGroup.show()[n.animation?"animate":"attr"]({opacity:1},{duration:200})})),u=i,cn(s,function(n){var s,l=n.dataLabel,c,h,p,d,v=n.connector,m=!0;o=n.options&&n.options.dataLabels,s=It(o&&o.enabled,u.enabled);if(l&&!s)n.dataLabel=l.destroy();else if(s){i=Ct(u,o),d=i.rotation,c=n.getLabelConfig(),a=i.format?$t(i.format,c):i.formatter.call(c,i),i.style.color=It(i.color,i.style.color,t.color,"black");if(l)Bt(a)?(l.attr({text:a}),m=!1):(n.dataLabel=l=l.destroy(),v&&(n.connector=v.destroy()));else if(Bt(a)){h={fill:i.backgroundColor,stroke:i.borderColor,"stroke-width":i.borderWidth,r:i.borderRadius||0,rotation:d,padding:i.padding,zIndex:1};for(p in h)h[p]===e&&delete h[p];l=n.dataLabel=t.chart.renderer[d?"text":"label"](a,0,-999,null,null,null,i.useHTML).attr(h).css(Nt(i.style,r&&{cursor:r})).add(f).shadow(i.shadow)}l&&t.alignDataLabel(n,l,i,null,m)}})},Yn.prototype.alignDataLabel=function(e,t,n,r,s){var o=this.chart,u=o.inverted,a=It(e.plotX,-999),f=It(e.plotY,-999),l=t.getBBox(),c=this.visible&&(e.series.forceDL||o.isInsidePlot(a,i(f),u)||r&&o.isInsidePlot(a,u?r.x+1:r.y+r.height-1,u)),h;c&&(r=Nt({x:u?o.plotWidth-f:a,y:i(u?o.plotHeight-a:f),width:0,height:0},r),Nt(n,{width:l.width,height:l.height}),n.rotation?(h={align:n.align,x:r.x+n.x+r.width/2,y:r.y+n.y+r.height/2},t[s?"attr":"animate"](h)):(t.align(n,null,r),h=t.alignAttr,It(n.overflow,"justify")==="justify"?this.justifyDataLabel(t,n,h,l,r,s):It(n.crop,!0)&&(c=o.isInsidePlot(h.x,h.y)&&o.isInsidePlot(h.x+l.width,h.y+l.height)))),c||(t.attr({y:-999}),t.placed=!1)},Yn.prototype.justifyDataLabel=function(e,t,n,r,i,s){var o=this.chart,u=t.align,a=t.verticalAlign,f,l;f=n.x,f<0&&(u==="right"?t.align="left":t.x=-f,l=!0),f=n.x+r.width,f>o.plotWidth&&(u==="left"?t.align="right":t.x=o.plotWidth-f,l=!0),f=n.y,f<0&&(a==="bottom"?t.verticalAlign="top":t.y=-f,l=!0),f=n.y+r.height,f>o.plotHeight&&(a==="top"?t.verticalAlign="bottom":t.y=o.plotHeight-f,l=!0),l&&(e.placed=!s,e.align(t,null,i))},xt.pie&&(xt.pie.prototype.drawDataLabels=function(){var e=this,t=e.data,n,r=e.chart,s=e.options.dataLabels,o=It(s.connectorPadding,10),a=It(s.connectorWidth,1),l=r.plotWidth,c=r.plotHeight,h,p,d=It(s.softConnector,!0),v=s.distance,m=e.center,g=m[2]/2,y=m[1],b=v>0,w,E,S,x,T=[[],[]],N,C,k,L,A,O,M=[0,0,0,0],_=function(e,t){return t.y-e.y};if(!e.visible||!s.enabled&&!e._hasPointLabels)return;Yn.prototype.drawDataLabels.apply(e),cn(t,function(e){e.dataLabel&&e.visible&&T[e.half].push(e)}),A=0;while(!x&&t[A])x=t[A]&&t[A].dataLabel&&(t[A].dataLabel.getBBox().height||21),A++;A=2;while(A--){var D=[],P,H=[],B=T[A],j,F=B.length,I;e.sortByAngle(B,A-.5);if(v>0){for(j=y-g-v;j<=y+g+v;j+=x)D.push(j);P=D.length;if(F>P){L=[].concat(B),L.sort(_),O=F;while(O--)L[O].rank=O;O=F;while(O--)B[O].rank>=P&&B.splice(O,1);F=B.length}for(O=0;O<F;O++){n=B[O],S=n.labelPos;var q=9999,R,U;for(U=0;U<P;U++)R=f(D[U]-S[1]),R<q&&(q=R,I=U);if(I<O&&D[O]!==null)I=O;else if(P<F-O+I&&D[O]!==null){I=P-F+O;while(D[I]===null)I++}else while(D[I]===null)I++;H.push({i:I,y:D[I]}),D[I]=null}H.sort(_)}for(O=0;O<F;O++){var W,V;n=B[O],S=n.labelPos,w=n.dataLabel,k=n.visible===!1?z:X,V=S[1];if(v>0){W=H.pop(),I=W.i,C=W.y;if(V>C&&D[I+1]!==null||V<C&&D[I-1]!==null)C=V}else C=V;N=s.justify?m[0]+(A?-1:1)*(g+v):e.getX(I===0||I===D.length-1?V:C,A),w._attr={visibility:k,align:S[6]},w._pos={x:N+s.x+({left:o,right:-o}[S[6]]||0),y:C+s.y-10},w.connX=N,w.connY=C,this.options.size===null&&(E=w.width,N-E<o?M[3]=u(i(E-N+o),M[3]):N+E>l-o&&(M[1]=u(i(N+E-l+o),M[1])),C-x/2<0?M[0]=u(i(-C+x/2),M[0]):C+x/2>c&&(M[2]=u(i(C+x/2-c),M[2])))}}if(Zt(M)===0||this.verifyDataLabelOverflow(M))this.placeDataLabels(),b&&a&&cn(this.points,function(t){h=t.connector,S=t.labelPos,w=t.dataLabel,w&&w._pos?(k=w._attr.visibility,N=w.connX,C=w.connY,p=d?[J,N+(S[6]==="left"?5:-5),C,"C",N,C,2*S[2]-S[4],2*S[3]-S[5],S[2],S[3],K,S[4],S[5]]:[J,N+(S[6]==="left"?5:-5),C,K,S[2],S[3],K,S[4],S[5]],h?(h.animate({d:p}),h.attr("visibility",k)):t.connector=h=e.chart.renderer.path(p).attr({"stroke-width":a,stroke:s.connectorColor||t.color||"#606060",visibility:k}).add(e.dataLabelsGroup)):h&&(t.connector=h.destroy())})},xt.pie.prototype.placeDataLabels=function(){cn(this.points,function(e){var t=e.dataLabel,n;t&&(n=t._pos,n?(t.attr(t._attr),t[t.moved?"animate":"attr"](n),t.moved=!0):t&&t.attr({y:-999}))})},xt.pie.prototype.alignDataLabel=H,xt.pie.prototype.verifyDataLabelOverflow=function(e){var t=this.center,n=this.options,r=n.center,i=n.minSize||80,s=i,o;return r[0]!==null?s=u(t[2]-u(e[1],e[3]),i):(s=u(t[2]-e[1]-e[3],i),t[0]+=(e[3]-e[1])/2),r[1]!==null?s=u(a(s,t[2]-u(e[0],e[2])),i):(s=u(a(s,t[2]-e[0]-e[2]),i),t[1]+=(e[0]-e[2])/2),s<t[2]?(t[2]=s,this.translate(t),cn(this.points,function(e){e.dataLabel&&(e.dataLabel._pos=null)}),this.drawDataLabels&&this.drawDataLabels()):o=!0,o}),xt.column&&(xt.column.prototype.alignDataLabel=function(e,t,n,r,i){var s=this.chart,o=s.inverted,u=e.dlBox||e.shapeArgs,a=e.below||e.plotY>It(this.translatedThreshold,s.plotSizeY),f=It(n.inside,!!this.options.stacking);u&&(r=Ct(u),o&&(r={x:s.plotWidth-r.y-r.height,y:s.plotHeight-r.x-r.width,width:r.height,height:r.width}),f||(o?(r.x+=a?0:r.width,r.width=0):(r.y+=a?r.height:0,r.height=0))),n.align=It(n.align,!o||f?"center":a?"right":"left"),n.verticalAlign=It(n.verticalAlign,o||f?"middle":a?"top":"bottom"),Yn.prototype.alignDataLabel.call(this,e,t,n,r,i)});var lr=Tt.TrackerMixin={drawTrackerPoint:function(){var t=this,n=t.chart,r=n.pointer,i=t.options.cursor,s=i&&{cursor:i},o=function(r){var i=r.target,s;n.hoverSeries!==t&&t.onMouseOver();while(i&&!s)s=i.point,i=i.parentNode;s!==e&&s!==n.hoverPoint&&s.onMouseOver(r)};cn(t.points,function(e){e.graphic&&(e.graphic.element.point=e),e.dataLabel&&(e.dataLabel.element.point=e)}),t._hasTracking||(cn(t.trackerGroups,function(e){t[e]&&(t[e].addClass(W+"tracker").on("mouseover",o).on("mouseout",function(e){r.onTrackerMouseOut(e)}).css(s),C&&t[e].on("touchstart",o))}),t._hasTracking=!0)},drawTrackerGraph:function(){var e=this,t=e.options,n=t.trackByArea,r=[].concat(n?e.areaPath:e.graphPath),i=r.length,s=e.chart,o=s.pointer,u=s.renderer,a=s.options.tooltip.snap,f=e.tracker,l=t.cursor,c=l&&{cursor:l},h=e.singlePoints,p,d,v=function(){s.hoverSeries!==e&&e.onMouseOver()},m="rgba(192,192,192,"+(S?1e-4:.002)+")";if(i&&!n){d=i+1;while(d--)r[d]===J&&r.splice(d+1,0,r[d+1]-a,r[d+2],K),(d&&r[d]===J||d===i)&&r.splice(d,0,K,r[d-2]+a,r[d-1])}for(d=0;d<h.length;d++)p=h[d],r.push(J,p.plotX-a,p.plotY,K,p.plotX+a,p.plotY);f?f.attr({d:r}):(e.tracker=u.path(r).attr({"stroke-linejoin":"round",visibility:e.visible?X:z,stroke:m,fill:n?m:$,"stroke-width":t.lineWidth+(n?0:2*a),zIndex:2}).add(e.group),cn([e.tracker,e.markerGroup],function(e){e.addClass(W+"tracker").on("mouseover",v).on("mouseout",function(e){o.onTrackerMouseOut(e)}).css(c),C&&e.on("touchstart",v)}))}};xt.column&&(sr.prototype.drawTracker=lr.drawTrackerPoint),xt.pie&&(xt.pie.prototype.drawTracker=lr.drawTrackerPoint),xt.scatter&&(ur.prototype.drawTracker=lr.drawTrackerPoint),Nt($n.prototype,{setItemEvents:function(e,t,n,r,i){var s=this;(n?t:e.legendGroup).on("mouseover",function(){e.setState(Y),t.css(s.options.itemHoverStyle)}).on("mouseout",function(){t.css(e.visible?r:i),e.setState()}).on("click",function(t){var n="legendItemClick",r=function(){e.setVisible()};t={browserEvent:t},e.firePointEvent?e.firePointEvent(n,t,r):gn(e,n,t,r)})},createCheckboxForItem:function(e){var t=this;e.checkbox=Rt("input",{type:"checkbox",checked:e.selected,defaultChecked:e.selected},t.options.itemCheckboxStyle,t.chart.container),vn(e.checkbox,"click",function(t){var n=t.target;gn(e,"checkboxClick",{checked:n.checked},function(){e.select()})})}}),O.legend.itemStyle.cursor="pointer",Nt(Kn.prototype,{showResetZoom:function(){var e=this,t=O.lang,n=e.options.chart.resetZoomButton,r=n.theme,i=r.states,s=n.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=e.renderer.button(t.resetZoom,null,null,function(){e.zoomOut()},r,i&&i.hover).attr({align:n.position.align,title:t.resetZoomTitle}).add().align(n.position,!1,s)},zoomOut:function(){var e=this;gn(e,"selection",{resetSelection:!0},function(){e.zoom()})},zoom:function(e){var t=this,n,r=t.pointer,i=!1,s;!e||e.resetSelection?cn(t.axes,function(e){n=e.zoom()}):cn(e.xAxis.concat(e.yAxis),function(e){var t=e.axis,s=t.isXAxis;if(r[s?"zoomX":"zoomY"]||r[s?"pinchX":"pinchY"])n=t.zoom(e.min,e.max),t.displayBtn&&(i=!0)}),s=t.resetZoomButton,i&&!s?t.showResetZoom():!i&&Ot(s)&&(t.resetZoomButton=s.destroy()),n&&t.redraw(It(t.options.chart.animation,e&&e.animation,t.pointCount<100))},pan:function(e,t){var n=this,r=n.hoverPoints,i;r&&cn(r,function(e){e.setState()}),cn(t==="xy"?[1,0]:[1],function(t){var r=e[t?"chartX":"chartY"],s=n[t?"xAxis":"yAxis"][0],o=n[t?"mouseDownX":"mouseDownY"],f=(s.pointRange||0)/2,l=s.getExtremes(),c=s.toValue(o-r,!0)+f,h=s.toValue(o+n[t?"plotWidth":"plotHeight"]-r,!0)-f;s.series.length&&c>a(l.dataMin,l.min)&&h<u(l.dataMax,l.max)&&(s.setExtremes(c,h,!1,!1,{trigger:"pan"}),i=!0),n[t?"mouseDownX":"mouseDownY"]=r}),i&&n.redraw(!1),qt(n.container,{cursor:"move"})}}),Nt(Gn.prototype,{select:function(e,t){var n=this,r=n.series,i=r.chart;e=It(e,!n.selected),n.firePointEvent(e?"select":"unselect",{accumulate:t},function(){n.selected=n.options.selected=e,r.options.data[ln(n,r.data)]=n.options,n.setState(e&&Z),t||cn(i.getSelectedPoints(),function(e){e.selected&&e!==n&&(e.selected=e.options.selected=!1,r.options.data[ln(e,r.data)]=e.options,e.setState(G),e.firePointEvent("unselect"))})})},onMouseOver:function(e){var t=this,n=t.series,r=n.chart,i=r.tooltip,s=r.hoverPoint;s&&s!==t&&s.onMouseOut(),t.firePointEvent("mouseOver"),i&&(!i.shared||n.noSharedTooltip)&&i.refresh(t,e),t.setState(Y),r.hoverPoint=t},onMouseOut:function(){var e=this.series.chart,t=e.hoverPoints;if(!t||ln(this,t)===-1)this.firePointEvent("mouseOut"),this.setState(),e.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var e=this,t=Ct(e.series.options.point,e.options),n=t.events,r;e.events=n;for(r in n)vn(e,r,n[r]);this.hasImportedEvents=!0}},setState:function(e,t){var n=this,r=n.plotX,i=n.plotY,s=n.series,o=s.options.states,u=Sn[s.type].marker&&s.options.marker,a=u&&!u.enabled,f=u&&u.states[e],l=f&&f.enabled===!1,c=s.stateMarkerGraphic,h=n.marker||{},p=s.chart,d,v=s.halo,m,g,y;e=e||G,y=n.pointAttr[e]||s.pointAttr[e];if(e===n.state&&!t||n.selected&&e!==Z||o[e]&&o[e].enabled===!1||e&&(l||a&&f.enabled===!1)||e&&h.states&&h.states[e]&&h.states[e].enabled===!1)return;n.graphic?(d=u&&n.graphic.symbolName&&y.r,n.graphic.attr(Ct(y,d?{x:r-d,y:i-d,width:2*d,height:2*d}:{})),c&&c.hide()):(e&&f&&(d=f.radius,g=h.symbol||s.symbol,c&&c.currentSymbol!==g&&(c=c.destroy()),c?c[t?"animate":"attr"]({x:r-d,y:i-d}):g&&(s.stateMarkerGraphic=c=p.renderer.symbol(g,r-d,i-d,2*d,2*d).attr(y).add(s.markerGroup),c.currentSymbol=g)),c&&c[e&&p.isInsidePlot(r,i,p.inverted)?"show":"hide"]()),m=o[e]&&o[e].halo,m&&m.size?(v||(s.halo=v=p.renderer.path().add(s.seriesGroup)),v.attr(Nt({fill:On(n.color||s.color).setOpacity(m.opacity).get()},m.attributes))[t?"animate":"attr"]({d:n.haloPath(m.size)})):v&&v.attr({d:[]}),n.state=e},haloPath:function(e){var t=this.series,n=t.chart,r=t.getPlotBox(),i=n.inverted;return n.renderer.symbols.circle(r.translateX+(i?t.yAxis.len-this.plotY:this.plotX)-e,r.translateY+(i?t.xAxis.len-this.plotX:this.plotY)-e,e*2,e*2)}}),Nt(Yn.prototype,{onMouseOver:function(){var e=this,t=e.chart,n=t.hoverSeries;n&&n!==e&&n.onMouseOut(),e.options.events.mouseOver&&gn(e,"mouseOver"),e.setState(Y),t.hoverSeries=e},onMouseOut:function(){var e=this,t=e.options,n=e.chart,r=n.tooltip,i=n.hoverPoint;i&&i.onMouseOut(),e&&t.events.mouseOut&&gn(e,"mouseOut"),r&&!t.stickyTracking&&(!r.shared||e.noSharedTooltip)&&r.hide(),e.setState(),n.hoverSeries=null},setState:function(e){var t=this,n=t.options,r=t.graph,i=t.graphNeg,s=n.states,o=n.lineWidth,u;e=e||G;if(t.state!==e){t.state=e;if(s[e]&&s[e].enabled===!1)return;e&&(o=s[e].lineWidth||o+1),r&&!r.dashstyle&&(u={"stroke-width":o},r.attr(u),i&&i.attr(u))}},setVisible:function(t,n){var r=this,i=r.chart,s=r.legendItem,o,u=i.options.chart.ignoreHiddenSeries,a=r.visible;r.visible=t=r.userOptions.visible=t===e?!a:t,o=t?"show":"hide",cn(["group","dataLabelsGroup","markerGroup","tracker"],function(e){r[e]&&r[e][o]()}),i.hoverSeries===r&&r.onMouseOut(),s&&i.legend.colorizeItem(r,t),r.isDirty=!0,r.options.stacking&&cn(i.series,function(e){e.options.stacking&&e.visible&&(e.isDirty=!0)}),cn(r.linkedSeries,function(e){e.setVisible(t,!1)}),u&&(i.isDirtyBox=!0),n!==!1&&i.redraw(),gn(r,o)},setTooltipPoints:function(t){var n=this,r=[],i,o,f,l=n.xAxis,c=l&&l.getExtremes(),h=l?l.tooltipLen||l.len:n.chart.plotSizeX,p,d,v,m,g=[];if(n.options.enableMouseTracking===!1||n.singularTooltips)return;t&&(n.tooltipPoints=null),cn(n.segments||n.points,function(e){r=r.concat(e)}),l&&l.reversed&&(r=r.reverse()),n.orderTooltipPoints&&n.orderTooltipPoints(r),i=r.length;for(m=0;m<i;m++){p=r[m],d=p.x;if(d>=c.min&&d<=c.max){v=r[m+1],o=f===e?0:f+1,f=r[m+1]?a(u(0,s((p.clientX+(v?v.wrappedClientX||v.clientX:h))/2)),h):h;while(o>=0&&o<=f)g[o++]=p}}n.tooltipPoints=g},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(t){var n=this;n.selected=t=t===e?!n.selected:t,n.checkbox&&(n.checkbox.checked=t),gn(n,t?"select":"unselect")},drawTracker:lr.drawTrackerGraph}),Nt(Tt,{Axis:In,Chart:Kn,Color:On,Point:Gn,Tick:Fn,Renderer:N,Series:Yn,SVGElement:Mn,SVGRenderer:_n,arrayMin:Yt,arrayMax:Zt,charts:B,dateFormat:M,format:$t,pathAnim:D,getOptions:Cn,hasBidiBug:x,isTouchDevice:w,numberFormat:zt,seriesTypes:xt,setOptions:Nn,addEvent:vn,removeEvent:mn,createElement:Rt,discardElement:tn,css:qt,each:cn,extend:Nt,map:dn,merge:Ct,pick:It,splat:Ft,extendClass:Ut,pInt:Lt,wrap:Xt,svg:S,canvas:T,vml:!S&&!T,product:F,version:I})}(),e.Highcharts=Highcharts}.apply(e,arguments)})}(this),define("app/plugins/jquery.circleLoader",["jquery","underscore"],function(e,t){var n="circleLoader",r={pulse:t.template('<div class="circle-loader-root"><div class="circle loader-body"></div><div class="circle loader-body"></div></div>'),spinner:t.template('<% var strokeColor = obj.spinnerColor ? obj.spinnerColor : obj.calculatedColor ? "#fff" : (((obj.loaderRootCls || "") + " " + (obj.class || "")).search(/(white|light)/) !== -1 ? "#0070dc" : "#fff"); %><div class="spinner-loader-root"><div class="spinner-loader" style="width: <%- obj.spinnerSize %>px; height: <%- obj.spinnerSize %>px; margin-top: <%- (-obj.spinnerSize / 2).toFixed(2) %>px; margin-left: <%- (-obj.spinnerSize / 2).toFixed(2) %>px"><div class="spinner-body loader-body"><svg class="loader-svg" viewBox="25 25 50 50"><circle class="loader-path" stroke="<%- strokeColor %>" cx="50" cy="50" r="20" fill="none" stroke-width="<%- obj.spinnerStrokeWidth || 4 %>" stroke-miterlimit="10"/></svg></div></div></div>')},i=function(t,r){this.element=t,this.$el=e(t),this.options=e.extend({},e.fn.circleLoader.defaults,r),this._defaults=e.fn.circleLoader.defaults,this._name=n,this.init()};i.prototype.show=function(n){n=e.extend({},this.options,n),n.template=n.template||r[n.type],this._activityCount++;if(!this._isShown){var i=this.options.color||(this.options.autoColor?this.$el.css("background"):undefined);n.calculatedColor=i;var s=e.isFunction(n.template)?n.template.call(this,n):n.template;this._$loader=e(s).addClass(n.loaderRootCls).css(e.extend({zIndex:n.zIndex},n.css)),n.class&&this._$loader.addClass(n.class),n.maskBg&&(this._$loader.addClass("bg-masked"),i&&this._$loader.css("background",i)),this.$el.append(this._$loader),this._$loader.data("parentCls",this.options.parentCls).parent().addClass(this.options.parentCls),this._isShown=!0,this.$el.trigger("loader:show"),this.$el.trigger("loader:change",!0),setTimeout(t.bind(function(){this._isShown&&this._$loader.addClass(n.onCls)},this),0)}return this},i.prototype.hide=function(e){e=e||{};if(this._isShown){e.force?this._activityCount=0:this._activityCount--;if(this._activityCount<=0){this._$loader.removeClass(this.options.onCls),this._isShown=!1;var n=this._$loader.parent();this.$el.trigger("loader:hide"),this.$el.trigger("loader:change",!1),this._activityCount=0,setTimeout(t.bind(function(){if(!this._isShown&&this._$loader){var e=this._$loader.data("parentCls");e&&(n.removeClass(e),this._$loader.parent().removeClass(e)),this._$loader.remove(),this._$loader=null}},this),200)}}return this},i.prototype.toggle=function(e){this._isShown?this.hide(e):this.show(e)},i.prototype.isPending=function(){return!!this._isShown},i.prototype.init=function(){this._activityCount=0},i.prototype.instance=function(){return this},e.fn.circleLoader=function(t,r){if(t==="isPending"&&this.length===1){var s=e.data(this[0],"plugin_"+n);return s?s.isPending():!1}return this.each(function(){t===undefined?t="toggle":t===!0?t="show":t===!1?t="hide":typeof t!="string"&&(r=t,t=null);var s=e.data(this,"plugin_"+n)||e.data(this,"plugin_"+n,new i(this,r));if(t)return s[t].call(s,r)})},e.fn.circleLoader.defaults={maskBg:!0,type:"pulse",template:undefined,loaderRootCls:"loader-root",onCls:"on",zIndex:999999,parentCls:"loading-masked",color:undefined,autoColor:!1,spinnerStrokeWidth:4,spinnerSize:50,spinnerColor:undefined}}),define("app/modules/dashboard/views/tabsPanel",["underscore","jquery","backbone","marionette","radio","notifier","app/helpers/trace","app/plugins/jquery.circleLoader"],function(e,t,n,r,i,s,o){var u=n.Model.extend({defaults:{lazyRendering:!1,selected:!0}}),a=e.keys(u.prototype.defaults);return n.Marionette.LayoutView.extend({BodyView:n.Marionette.LayoutView.extend({className:"panel-body-view"}),initialize:function(){o.hookInto(this,["render"],!0),this.tabsModel=this.tabsModel||new u(e.pick(this.options,a)),this.listenTo(this.tabsModel,"change:selected",this._syncFromTabsModel),this.$el.one("mouseEnter.collapsible-panel",e.bind(this.refreshMaxHeight)),this.toggle=e.bind(this.toggle,this),this.on("render",function(){this._syncFromTabsModel(!0),this.bodyView&&(this.tabsModel.get("lazyRendering")?this.on("show",function(){!this.tabsModel.get("selected")&&!this.body.hasView()?this.bodyView&&this.body.show(this.bodyView):this.once("tabview:bodyExpand:before",function(){this.body.hasView()||this.bodyView&&this.body.show(this.bodyView)}),this.on("render",function(){this.bodyView&&!this.tabsModel.get("selected")&&!this.body.hasView()&&this.body.show(this.bodyView)})}):this.body.show(this.bodyView)),this.listenTo(this.bodyView,"render",this.refreshMaxHeight)}),this.on("destroy",function(){this.$el.off(".collapsible-panel"),this.bodyView&&(this.bodyView.destroy(),this.bodyView=null)})},regions:{body:".body"},template:e.template('<div class="body body-container" role="tabpanel"></div>'),onBeforeRender:function(){var n=(e.isFunction(this.bodyViewOptions)?this.bodyViewOptions.call(this):this.bodyViewOptions)||{};this.bodyView=new this.BodyView(t.extend({model:this.model,collection:this.collection},n))},className:"collapsible-panel",disableToggle:function(){this.tabsModel.set("disabled",!0)},enableToggle:function(){this.tabsModel.set("disabled",!1)},toggle:function(e){this.tabsModel.get("disabled")!==!0?(this.tabsModel.set("selected",!this.tabsModel.get("selected")),this.trigger("tabview:toggle",e,this)):this.trigger("tabview:toggleSuppressed",e,this)},_syncFromTabsModel:function(e){var t=this.tabsModel.get("selected");this.tabsModel.changed.selected!==undefined&&(this.trigger(t?"select":"deselect"),this.bodyView&&this.bodyView.trigger(t?"tabview:collapse:before":"tabview:expand:before",this),this.trigger(t?"tabview:bodyCollapse:before":"tabview:bodyExpand:before",this)),this.refreshMaxHeight();if(e||this.tabsModel.changed.selected)this.$el[t?"addClass":"removeClass"]("collapsed")[t?"removeClass":"addClass"]("expanded").onTransitionEnd(function(){this.bodyView&&this.bodyView.trigger(t?"tabview:collapse:end":"tabview:expand:end",this),this.trigger(t?"tabview:bodyCollapse:end":"tabview:bodyExpand:end",this)},this,150,!0),this.bodyView&&this.bodyView.trigger(t?"tabview:collapse":"tabview:expand",this),this.trigger(t?"tabview:bodyCollapse":"tabview:bodyExpand",this);this.refreshSelectedTab(t)},refreshSelectedTab:function(e){var n=this.options.dataType,r=t(".discovery-pane").find(".tabs-bar");r.find("div[data-type='"+n+"']")[e?"removeClass":"addClass"]("selected"),e||r.find(".title-menu-bar").text(this.options.title)},expand:function(){this.tabsModel.set("selected",!1)},collapse:function(){this.tabsModel.set("selected",!0)},setMaxBodyHeight:function(e){this._bodyMaxHeight=e,this.body.$el.css("max-height",e)},refreshMaxHeight:function(){if(this.options.collapseAnimation&&this.bodyView){var e=t(".tabs-bar"),n=e.height()+parseInt(e.css("border-top"))+parseInt(e.css("border-bottom")),r=t(".panel-group")[0].scrollHeight-n;r&&this.getRegion("body").$el.css("max-height",r)}}})}),define("app/modules/dashboard/views/discoveryPane/panels/base",["underscore","jquery","backbone","marionette","radio","notifier","../../tabsPanel","app/plugins/jquery.circleLoader"],function(e,t,n,r,i,s,o){return o.extend({BodyView:o.prototype.BodyView.extend({className:"panel-body-view"}),className:"collapsible-panel pane-info-panel",initialize:function(){o.prototype.initialize.apply(this,arguments),this.$el.addClass("non-animated")},appendClass:function(e){this.$el.addClass(e+"-pane")},onBeforeRender:function(){var n=this,r=(e.isFunction(this.bodyViewOptions)?this.bodyViewOptions.call(this):this.bodyViewOptions)||{};this.bodyView=new this.BodyView(t.extend({model:this.model,parent:this},r));var i=function(t,r){e.each(r.split(" "),function(e){n.listenTo(t,e,function(){var t=["child:"+e].concat(Array.prototype.slice.call(arguments));n.trigger.apply(this,t)})})};i(this.bodyView,"requestPin requestUnpin")},onRender:function(){this.$el.removeClass("hidden non-animated")},initBadge:function(e,n){var r=setInterval(function(){var i=t("div[data-type='"+e+"']").find("i");i.length>0&&(clearInterval(r),i.append("<div class='badge'>"+n+"</div>"))},100)}})}),define("app/collections/groupedCollection",["underscore","jquery","backbone"],function(e,t,n){return n.Collection.extend({model:n.Model.extend({idAttribute:"key",defaults:{key:"",items:null}}),constructor:function(t,r){this.sourceCollection=t,this.groupingAttribute=typeof r=="string"?r:r.groupingAttribute,this.groupingFn=e.isFunction(r)?r:r.groupingFn,this.groupsComparator=r.groupsComparator,this.itemsComparator=r.itemsComparator,this.listenTo(t,"sync",function(e,t,n){this._fetched=!0,this._buildGroups(),this.trigger("sync",this,this.models,n)}),n.Collection.prototype.constructor.call(this,null),this._buildGroups()},groupBy:function(t,n,r){return e.isFunction(t)?(this.groupingFn=t,this.groupingAttribute=undefined):(this.groupingAttribute=t,this.groupingFn=undefined),this.groupsComparator=n,this.itemsComparator=r,this._buildGroups(),this},_buildGroups:function(){var t=this,n=this.groupingAttribute,r=this.groupingFn,i;r?i=this.sourceCollection.groupBy(r):i=this.sourceCollection.groupBy(function(e){return e.get(n)});var s=e.map(i,function(n,r){return{key:r,items:t.itemsComparator?e.sortBy(n,t.itemsComparator,t):n}});this.reset(t.groupsComparator?e.sortBy(s,t.groupsComparator,t):s)}})}),define("app/modules/dashboard/models/websiteDiscovery/siteInfo",["underscore","jquery","backbone","generated/countries","app/instances/collections/technologiesList","app/collections/groupedCollection","app/models/technology"],function(e,t,n,r,i,s){var o=n.Collection.extend({model:n.Model.extend({idAttribute:"country",defaults:{countryCode:undefined,country:undefined},parse:function(e){return e&&e.countryCode&&(e.country=r.byCode(e.countryCode)),e}})});return n.Model.extend({idAttribute:"site",urlRoot:"/api/websites/info",parse:function(e){e.visitsPerCountry=new o(e.visitsPerCountry,{parse:!0});if(e.category){var n=t.trim(e.category).split(">");n.length>1&&(e.parentCategory=t.trim(n[0]),e.subCategory=t.trim(n[1]))}return e.country&&(e.country=r.byCode(e.country)),e},isEmpty:function(){var e=this.attributes;return!e.category&&!e.country&&(!e.technologies||!e.technologies.length)&&(!e.visitsPerCountry||!e.visitsPerCountry.length)&&(!e.technologies||!e.technologies.length)}})}),define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!app/modules/dashboard/templates/discoveryPanel/websiteInfo.ejs",[],function(){return'<div class="site-container">\n    <div class="info-block site-title-block">\n\n        <div class="site-title-content">\n          <div class="any-text site-title-wrap">\n            <a class="title-label" title="<%- obj.title || obj.site %>" rel="nofollow noopener noreferrer" target="_blank" href="<%- formatters.url.goto(obj.site) %>"><span class="title-elip"><%- obj.title || obj.site %></span><i class="linkout icon-link-ext"></i></a>\n          </div>\n          <% if (obj.description) { %><div class="any-text site-desc-wrap">\n          <div class="site-description"><%- formatters.string.truncate(obj.description, 200).text %></div>\n          </div>\n          <% } %>\n            <ul class="info-bullets">\n                <% if (obj.category) { %>\n                <li class="site-category">\n                    <div class="bullet-icon-ph"><i class="icon-local_offer tooltipped" title="Industry vertical"></i></div>\n                    <div class="bullet-text">\n               <span class="site-category-text<%- obj.subCategory ? \' multi-level-category\'  : \'\'%>" title="<%- obj.category %>">\n                   <% if (obj.subCategory) { %>\n                   <span class="parent-category-name"><%- obj.parentCategory %></span> <span class="category-name"><%- obj.subCategory %></span>\n                   <% } else { %>\n                   <%- obj.category %>\n                   <% } %>\n               </span>\n                    </div>\n                </li>\n                <% } %>\n                <% if (obj.technologiesBudgetScore !== undefined) { %>\n                <li class="site-techns-budget-score">\n                    <div class="bullet-icon-ph"><i class="icon-tech-hex tooltipped" title="Technologies expense"></i></div>\n                    <div class="bullet-text"><a class="panel-trigger" data-panel="siteTechnologies" href="javascript:">Tech Expense</a>: <span class="points-bar tooltipped" title="<%- obj.budgetScoreDescription %>">\n                            <% if (!obj.technologiesBudgetScore) { %>\n                            <i class="zero-points"></i>\n                            <% } else { %>\n                            <%= formatters.string.repeat(\'<i class="icon-attach_money"></i>\', Math.floor(obj.technologiesBudgetScore)) %><%= formatters.string.repeat(\'<i class="icon-attach_money half-point"></i>\', obj.technologiesBudgetScore %1 === 0.5 ? 1 : 0) %>\n                            <% } %>\n                        </span>\n                    </div>\n                </li>\n                <% } %>\n            </ul>\n\n        </div>\n    </div>\n\n    <% if (obj.visitsPerCountry.length || obj.globalRank || obj.country) { %>\n    <div class="info-block traffic-highlights-block">\n        <div class="traffic-table">\n            <div class="r-col">\n              <div class="r-row r-row-rank">\n                <div class="cell-label">Global traffic rank</div>\n                <div class="cell-value"><%- obj.globalRank ? \'#\' + formatters.number.withCommas(obj.globalRank) : "N/A" %></div>\n              </div>\n            </div>\n            <div class="r-col">\n                <div class="r-row r-row-country">\n                    <div class="cell-label">Leading country</div>\n                    <div class="cell-value">\n                    <% if (obj.country) { %>\n                        <i class="flag <%- formatters.countries.getFlagOf(obj.country) %>"></i> <span class="country-name" title="<%- obj.country.name.length > 17 ? obj.country.name : "" %>"><%- obj.country.alpha2 ? (obj.country.name.length > 17 ? obj.country.alpha2 : obj.country.name) : "N/A" %></span>\n                    <% } else { %>\n                        <span class="country-name">N/A</span>\n                    <% } %>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <% } %>\n\n  <% if (obj.trafficSources && obj.trafficSources.length) { %>\n    <div class="traffic-sources-block">\n      <div class="traffic-sources-vis">\n        <div class="center-label">\n          <% if (obj.monthlyVisits) { %>\n          <div class="visits-value"><%- formatters.number.abbreviateNumber(obj.monthlyVisits) %></div><div class="visits-label">Monthly visits</div>\n          <% } %>\n        </div>\n        <div class="traffic-sparkline empty"></div>\n        <div class="traffic-sparkline-label">3M Trend</div>\n        <div class="donut-chart traffic-sources-pie"></div>\n      </div>\n      <div class="traffic-sources-legend">\n            <ul class="sources-legend">\n              <%\n                var sourceMax = Math.max.apply(null, _.map(obj.trafficSources, function (source) {\n                    return source.value;\n                  })),\n                  source,\n                  sourceKey,\n                  sourceColor,\n                  trafficSourcesLen = trafficSources.length,\n                  ti;\n                for (ti = 0; ti < trafficSourcesLen; ti++) {\n                  source = trafficSources[ti];\n                  sourceKey = source.key.toLowerCase();\n                  sourceColor = trafficSourcesColors[sourceKey];\n                %>\n              <li class="legend-item" data-key="<%- sourceKey %>" data-color="<%- sourceColor %>">\n                <div class="legend-label"><i style="color: <%- sourceColor %>;" class="legend-icon source-icon icon-<%- sourceKey %>-traffic"></i><%- source.name %></div>\n                <div class="legend-value"><%- source.value %>%</div>\n              </li>\n              <%\n                  }\n              %>\n            </ul>\n\n      </div>\n    </div>\n  <% } %>\n</div>'}),define("app/modules/dashboard/views/discoveryPane/panels/siteInfo",["underscore","jquery","backbone","marionette","radio","app/helpers/checkImageUrl","formatters","highcharts","app/helpers/trace","./base","../../../models/websiteDiscovery/siteInfo","text!../../../templates/discoveryPanel/websiteInfo.ejs"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=f.prototype.BodyView.extend({template:e.template(c),className:"panel-body-view site-panel-view",initialize:function(){this.once("tabview:expand",this.renderChart),this.once("tabview:expand",this.detectTextDirection),this.once("tabview:expand",this.tracking),this.selectLegendItem=e.bind(this.selectLegendItem,this),this.deselectLegendItem=e.bind(this.deselectLegendItem,this)},tracking:function(){i.channel("sidepanel").trigger("opened","website-information")},events:{"mouseenter ul.sources-legend > .legend-item":function(e){if(e&&e.currentTarget){var n=t(e.currentTarget),r=n.index();this.selectLegendItem(n),this.selectChartPoint(r)}},"mouseleave ul.sources-legend":function(){this.deselectLegendItem(),this.deselectChartPoint()}},ui:{titleLabel:".site-title-wrap",descriptionLabel:".site-desc-wrap"},trafficSourcesColors:{direct:"#2A91FF",search:"#FF982A",mail:"#8963FF",display:"#FF639D",social:"#FFD920",referrals:"#05E487"},selectChartPoint:function(e){if(this.trafficSourcesChart){this.deselectChartPoint();var t=this.trafficSourcesChart.series[0].points;t[e].select(!0),this.activeTrafficSourcePoint=e}},deselectChartPoint:function(){if(this.trafficSourcesChart&&this.activeTrafficSourcePoint!==undefined){var e=this.trafficSourcesChart.series[0].points;e[this.activeTrafficSourcePoint].select(!1),this.activeTrafficSourcePoint=undefined}},selectLegendItem:function(e){if(!this.$activeLegendItem||this.$activeLegendItem[0]!==e[0]){this.deselectLegendItem();var t=e.data("color");e.addClass("active").css("background-color",t).siblings().removeClass("active").css("background-color",""),this.$activeLegendItem=e}},deselectLegendItem:function(){this.$activeLegendItem&&(this.$activeLegendItem.removeClass("active").css("background-color",""),this.$activeLegendItem=null)},renderChart:function(){var n=this.model.get("trafficSources");if(n&&n.length){var r=this.trafficSourcesColors,i=this.$(".traffic-sources-block"),s=i.find(".traffic-sources-vis"),o=i.find(".traffic-sources-pie"),u=i.find("ul.sources-legend"),a=i.find(".traffic-sparkline"),f=e.bind(function(e){var t=e.target,n=u.children('[data-key="'+t.key+'"]');this.selectLegendItem(n)},this),l={chart:{backgroundColor:"transparent",plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1,margin:[1,1,1,1],style:{fontFamily:'"proxima-nova", "Helvetica Neue", Helvetica, Arial, sans-serif'}},credits:{enabled:!1},title:{text:null},tooltip:{enabled:!1},plotOptions:{pie:{slicedOffset:3,borderWidth:0,crop:!1,animation:!1,dataLabels:{enabled:!1},center:["50%","50%"]}},series:[{zIndex:3,type:"pie",allowPointSelect:!1,name:"Traffic Sources",innerSize:124,states:{hover:{enabled:!0,halo:{size:0}}},events:{mouseOut:this.deselectLegendItem},data:e.map(n,function(e){return{icon:"icon-"+e.key.toLowerCase()+"-traffic",name:e.name,key:e.key.toLowerCase(),y:e.value,color:r[e.key.toLowerCase()],events:{mouseOver:f}}})}]};this.trafficSourcesChart=o.highcharts(l).highcharts();var c=this.model.id;t.get("/api/similarweb/traffic/"+c).done(function(t){var n=(t||{}).visits;if(n&&n.length){var r=e.map(n,function(e){return[e.date,e.visits]});a.highcharts({chart:{backgroundColor:"transparent",plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,margin:[0,0,0,0],spacingTop:0,spacingBottom:0,spacingLeft:0,spacingRight:0,type:"area"},title:{text:null},tooltip:{enabled:!1},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"rgba(212, 218, 224, 0.8)"],[.55,"rgba(212, 218, 224, 0.1)"],[1,"rgba(212, 218, 224, 0)"]]},color:"#C8CED4",lineWidth:1,animation:!1,enableMouseTracking:!1,marker:{lineWidth:0,radius:0,fillColor:"#fff",enabled:!1}}},legend:{enabled:!1},xAxis:{minPadding:0,maxPadding:0,lineWidth:0,minorTickWidth:0,tickWidth:0,type:"datetime",labels:{enabled:!1}},yAxis:{minPadding:0,maxPadding:0,gridLineWidth:0,endOnTick:!0,labels:{enabled:!1}},series:[{pointPadding:0,groupPadding:0,name:"Traffic",data:r}],credits:{enabled:!1}}),setTimeout(function(){s.addClass("sparkline-ready")},20)}}).fail(function(){})}},detectTextDirection:function(){var e=this.model.get("title");e&&this.ui.titleLabel instanceof t&&o.string.isRTL(e)&&this.ui.titleLabel.addClass("rtl");var n=this.model.get("description");n&&this.ui.descriptionLabel instanceof t&&o.string.isRTL(n)&&this.ui.descriptionLabel.addClass("rtl")},templateHelpers:function(){var e=this.model.get("budgetScoreDistribution"),t="";if(e){var n=[];e[1]&&n.push(e[1]+" paid"),e["0.5"]&&n.push(e["0.5"]+" possibly-paid"),n.length&&(t="The website is using "+n.join(" and ")+" "+(n[n.length-1]===1?"technology":"technologies"))}return{budgetScoreDescription:t||"",favicon:o.html.favicon(this.model.get("site")),trafficSourcesColors:this.trafficSourcesColors}}});return f.extend({BodyView:h,Model:l})}),define("app/modules/dashboard/models/websiteDiscovery/company",["underscore","jquery","backbone"],function(e,t,n){return n.Model.extend({idAttribute:"site",urlRoot:"/api/websites/company",initialize:function(){},isEmpty:function(){var t=e.some(e.omit(this.attributes,"site"),function(e,t){return!!e});return!t}})}),define("text!app/modules/dashboard/templates/discoveryPanel/websiteCompany.ejs",[],function(){return'<% if (obj.description || obj.homepage || obj.favicon) { %>\r\n<% var truncDescription = formatters.string.truncate(obj.description || "", 250); %>\r\n\r\n<div class="info-block company-description any-text" title="<%- truncDescription.truncated ? obj.description : \'\' %>">\r\n  <div class="info-block company-header">\r\n    <a class="company-link" target="<%- obj.homepage ? \'_blank\' : \'\' %>" rel="nofollow noopener noreferrer" title="<%- obj.homepage ? \'Visit \' + obj.homepage : (obj.name || \'\') %>" href="<%- obj.homepage || "javascript:" %>">\r\n      <img class="company-logo" src="" />\r\n      <!--<div class="company-website">-->\r\n        <!--<img class="favicon" src="">-->\r\n        <!--&lt;!&ndash;<span class="title-elip"><%- obj.homepage ? obj.homepage.replace(/.*?:\\/\\//g, "") : \'\' %></span>&ndash;&gt;-->\r\n        <!--&lt;!&ndash;<i class="linkout icon-link-ext"></i> &ndash;&gt;-->\r\n      <!--</div>-->\r\n    </a>\r\n  </div>\r\n  <div class="company-name"><%= obj.name %></div>\r\n  <%- truncDescription.text %></div>\r\n<% } %>\r\n\r\n<% if (obj.yearFounded || obj.totalAmountRaised || obj.lastFundingRoundAmount || obj.employeeRange || obj.revenueRange || obj.phone) { %>\r\n<ul class="info-block info-bullets">\r\n    <% if (obj.yearFounded) { %><li class="company-foundation-time"><div class="bullet-icon-ph"><i class="icon-cake"></i></div><div class="bullet-text">Established <span class="numeric-value"><%- obj.yearFounded %></span></div></li><% } %>\r\n    <% if (obj.totalAmountRaised || obj.lastFundingRoundAmount) { %>\r\n    <li class="company-amount-raised">\r\n        <div class="bullet-icon-ph"><i class="icon-local_atm"></i></div>\r\n        <div class="bullet-text">\r\n            Raised<% if (obj.totalAmountRaised) { %> <span class="numeric-value">$<%- formatters.number.abbreviateNumber(obj.totalAmountRaised) %></span><% } %><%= obj.totalAmountRaised && obj.lastFundingRoundAmount ? "," : "" %><% if (obj.lastFundingRoundAmount) { %> <span class="numeric-value">$<%- formatters.number.abbreviateNumber(obj.lastFundingRoundAmount) %></span> on last round<% } %>\r\n        </div>\r\n    </li>\r\n    <% } %>\r\n    <% if (obj.employeeRange) { %><li class="company-employee-range"><div class="bullet-icon-ph"><i class="icon-people"></i></div><div class="bullet-text"><span class="numeric-value"><%- obj.employeeRange %></span> employees</div></li><% } %>\r\n    <% if (obj.revenueRange) { %><li class="company-revenues-range"><div class="bullet-icon-ph"><i class="icon-trending_up"></i></div><div class="bullet-text"><span class="numeric-value"><%- obj.revenueRange %></span> annual revenues</div></li><% } %>\r\n    <% if (obj.phone) { %><li class="company-revenues-range"><div class="bullet-icon-ph"><i class="icon-phone"></i></div><div class="bullet-text"><span class="numeric-value"><%- obj.phone %></span></div></li><% } %>\r\n</ul>\r\n<% } %>\r\n\r\n<% if (obj.location) { %>\r\n<div class="info-block company-location location-block">\r\n    <a target="_blank" rel="nofollow noopener noreferrer" href="https://www.google.com/maps/place/<%- encodeURI(obj.location.replace(/\\s/g, "+")) %>" class="location-label"><i class="icon-location_city"></i> <span class="location-address"><%- obj.location %></span></a>\r\n    <div class="location-map"></div>\r\n</div>\r\n<% } %>\r\n\r\n<%\r\nvar renderSocialBlock = function (networkName, className, iconName, url, label, iframeContent, iframeLabel) {\r\n    label = label || obj.getSocialHandle(url);\r\n    return !url ? \'\' : \'<li class="social-network-link \' + className + \'">\' +\r\n    \'<a class="handle social-handle" title="Visit on \' + networkName + \'" target="_blank" rel="nofollow noopener noreferrer" href="\' + url + \'"><i class="social-icon icon-\' + iconName + \'"></i><span class="handle-label">\' + _.escape(label) + \'</span></a>\' +\r\n    (iframeContent ? \'<div title="\' + (iframeLabel || "") + \'" class="social-iframe-wrapper"><div class="social-iframe-mask">\' + iframeContent + \'</div></div>\' : \'\') +\r\n    \'</li>\';\r\n};\r\n%>\r\n\r\n<% if (obj.googlePlusUrl || obj.pinterestUrl || obj.youTubeUrl || obj.linkedInUrl || obj.facebookUrl || obj.twitterUrl) { %>\r\n<ul class="info-block company-social-networks social-networks">\r\n    <%= obj.googlePlusUrl ? renderSocialBlock("Google+", "google-plus", "googleplus", obj.googlePlusUrl, obj.name || obj.getSocialHandle(obj.googlePlusUrl)) : \'\' %>\r\n    <%= renderSocialBlock("Pinterest", "pinterest", "pinterest", obj.pinterestUrl) %>\r\n    <%= renderSocialBlock("YouTube", "youtube", "youtube", obj.youTubeUrl) %>\r\n    <%= renderSocialBlock("LinkedIn", "linkedin", "linkedin", obj.linkedInUrl) %>\r\n    <%= renderSocialBlock("Facebook", "facebook with-count", "facebook", obj.facebookUrl, null, \'<iframe class="facebook-iframe" src="https://www.facebook.com/v2.4/plugins/like.php?app_id=113869198637480&href=\' + encodeURIComponent(obj.facebookUrl) + \'&layout=button_count&locale=en_US&sdk=joey&share=false&show_faces=false&width=90" style="width: 90px; height: 20px;" scrolling="no" frameborder="0" allowtransparency="true"></iframe>\', \'Live likes number\') %>\r\n    <%= obj.twitterUrl ? renderSocialBlock("Twitter", "twitter with-count", "twitter", \'https://twitter.com/\' + obj.getSocialHandle(obj.twitterUrl), null, \'<a class="twitter-follow-button" data-show-screen-name="false" href="\' + obj.twitterUrl + \'"></a>\', \'Live followers number\') : \'\' %>\r\n</ul>\r\n<% } %>'}),define("app/modules/dashboard/views/discoveryPane/panels/siteCompany",["underscore","jquery","backbone","marionette","radio","formatters","app/helpers/checkImageUrl","./base","../../../models/websiteDiscovery/company","text!../../../templates/discoveryPanel/websiteCompany.ejs"],function(e,t,n,r,i,s,o,u,a,f){window.twttr=function(e,t,n){var r,i=e.getElementsByTagName(t)[0],s=window.twttr||{};return e.getElementById(n)?s:(r=e.createElement(t),r.id=n,r.src="https://platform.twitter.com/widgets.js",i.parentNode.insertBefore(r,i),s._e=[],s.ready=function(e){s._e.push(e)},s)}(document,"script","twitter-wjs");var l=u.prototype.BodyView.extend({template:e.template(f),className:"panel-body-view company-panel-view",initialize:function(){this.once("tabview:expand",this.loadMapImage),this.once("tabview:expand",this.detectTextDirection),this.once("tabview:expand",this.tracking)},ui:{locationMap:".location-map",descriptionLabel:".company-description"},templateHelpers:function(){var e=this.model,n=e.get("name");return{getSocialHandle:function(e){var r=t.trim((e||"").split("/").pop().split("?").shift());return n&&r.toLowerCase()===n.toLowerCase()||!isNaN(Number(r))?n:r},googleMapsApiKey:"AIzaSyDTiFTK894Rj0u5nJjFh6lgFKPNhpwQx-c"}},tracking:function(){i.channel("sidepanel").trigger("opened","company-information")},onRender:function(){var e=this,t=this.model.get("logo"),n=this.model.get("homepage"),r=this.model.get("favicon"),i=n?s.html.websiteLogoUrl(n):undefined,u=t||i,a=t?i:undefined,f=s.html.favicon(n)||r,l=e.$("img.company-logo"),c=273,h=60,p=function(t,n){o(t,function(n){var r=Math.min(c/n.width,h/n.height);l.css({width:n.width*r,height:n.height*r}),l.attr("src",t),e.$(".company-header").addClass("with-logo")},function(){n&&n()})};p(u,function(){var t=function(){e.$(".company-header").addClass("no-logo")},n=function(){f?p(f,t):t()};a?p(a,n):n()}),this.model.get("twitterUrl")&&twttr.widgets&&twttr.widgets.load(this.$(".twitter-follow-button")[0])},getMapImageUrl:function(e){return"https://maps.googleapis.com/maps/api/staticmap?scale=1&size=330x138&style=element:labels|visibility:off&maptype=roadmap&key=AIzaSyBJCCPeB05bLZba-c-g971Ha_lVBjx-nRY&markers=color:red|"+encodeURI(e.replace(/\s/g,"+"))},detectTextDirection:function(){var e=this.model.get("description");e&&this.ui.descriptionLabel instanceof t&&s.string.isRTL(e)&&this.ui.descriptionLabel.addClass("rtl")},loadMapImage:function(){var n=this,r=this.ui.locationMap,i=this.model.attributes,s=this.model.get("location");if(s&&r instanceof t){var u=this.getMapImageUrl(s);o(u,function(){r.css("backgroundImage","url('"+u+"')")},function(){i.country&&(u=n.getMapImageUrl(e.filter([i.city,i.state,i.country],function(e){return!!e}).join(", ")),r.css("backgroundImage","url('"+u+"')"))})}}});return u.extend({BodyView:l,Model:a})}),define("app/modules/dashboard/views/collapsiblePanel",["underscore","jquery","backbone","marionette","radio","notifier","app/helpers/trace","app/plugins/jquery.circleLoader"],function(e,t,n,r,i,s,o){var u=n.Model.extend({defaults:{lazyRendering:!1,collapsed:!0}}),a=e.keys(u.prototype.defaults);return n.Marionette.LayoutView.extend({TitleView:n.Marionette.LayoutView.extend({className:"panel-title-view"}),BodyView:n.Marionette.LayoutView.extend({className:"panel-body-view"}),initialize:function(){o.hookInto(this,["render"],!0),this.collapsibleModel=this.collapsibleModel||new u(e.pick(this.options,a)),this.listenTo(this.collapsibleModel,"change:collapsed",this._syncFromCollapsibleModel),this.$el.one("mouseEnter.collapsible-panel",e.bind(this.refreshMaxHeight)),this.toggle=e.bind(this.toggle,this),this.on("render",function(){this._syncFromCollapsibleModel(!0),this.titleView&&this.title.show(this.titleView),this.bodyView&&(this.collapsibleModel.get("lazyRendering")?this.on("show",function(){!this.collapsibleModel.get("collapsed")&&!this.body.hasView()?this.bodyView&&this.body.show(this.bodyView):this.once("collapsible:bodyExpand:before",function(){this.body.hasView()||this.bodyView&&this.body.show(this.bodyView)}),this.on("render",function(){this.bodyView&&!this.collapsibleModel.get("collapsed")&&!this.body.hasView()&&this.body.show(this.bodyView)})}):this.body.show(this.bodyView));var t=this.getRegion("title").$el;t.on("click",e.bind(function(e){t.hasClass("collapse-toggle")&&this.toggle(e)},this)).on("click",".collapse-toggle",this.toggle),this.listenTo(this.bodyView,"render",this.refreshMaxHeight)}),this.on("destroy",function(){this.$el.off(".collapsible-panel"),this.titleView&&(this.titleView.destroy(),this.titleView=null),this.bodyView&&(this.bodyView.destroy(),this.bodyView=null)})},regions:{title:".title",body:".body"},template:e.template('<div class="title collapse-toggle" role="button"></div><div class="body" role="tabpanel"></div>'),onBeforeRender:function(){var n=(e.isFunction(this.titleViewOptions)?this.titleViewOptions.call(this):this.titleViewOptions)||{},r=(e.isFunction(this.bodyViewOptions)?this.bodyViewOptions.call(this):this.bodyViewOptions)||{};this.titleView=new this.TitleView(t.extend({model:this.model},n)),this.bodyView=new this.BodyView(t.extend({model:this.model,collection:this.collection},r))},className:"collapsible-panel",disableToggle:function(){this.collapsibleModel.set("disabled",!0)},enableToggle:function(){this.collapsibleModel.set("disabled",!1)},toggle:function(e){this.collapsibleModel.get("disabled")!==!0?(this.collapsibleModel.set("collapsed",!this.collapsibleModel.get("collapsed")),this.trigger("collapsible:toggle",e,this)):this.trigger("collapsible:toggleSuppressed",e,this)},_syncFromCollapsibleModel:function(e){var t=this.collapsibleModel.get("collapsed");this.collapsibleModel.changed.collapsed!==undefined&&(this.trigger(t?"collapsed":"expanded"),this.bodyView&&this.bodyView.trigger(t?"collapsible:collapse:before":"collapsible:expand:before",this),this.trigger(t?"collapsible:bodyCollapse:before":"collapsible:bodyExpand:before",this)),this.refreshMaxHeight();if(e||this.collapsibleModel.changed.collapsed)this.$el[t?"addClass":"removeClass"]("collapsed")[t?"removeClass":"addClass"]("expanded").onTransitionEnd(function(){this.bodyView&&this.bodyView.trigger(t?"collapsible:collapse:end":"collapsible:expand:end",this),this.trigger(t?"collapsible:bodyCollapse:end":"collapsible:bodyExpand:end",this)},this,150,!0),this.bodyView&&this.bodyView.trigger(t?"collapsible:collapse":"collapsible:expand",this),this.trigger(t?"collapsible:bodyCollapse":"collapsible:bodyExpand",this)},expand:function(){this.collapsibleModel.set("collapsed",!1)},collapse:function(){this.collapsibleModel.set("collapsed",!0)},setMaxBodyHeight:function(e){this._bodyMaxHeight=e,this.body.$el.css("max-height",e)},refreshMaxHeight:function(){if(this.options.collapseAnimation&&this.bodyView){var e=this.bodyView.$el.height()+parseInt(this.bodyView.$el.css("padding-top"))+parseInt(this.bodyView.$el.css("padding-bottom"));e&&this.getRegion("body").$el.css("max-height",e)}}})}),define("app/modules/dashboard/models/websiteDiscovery/siteTechnologies",["underscore","jquery","backbone","app/instances/collections/technologiesList","app/instances/collections/technologyCategoriesList","app/models/technology"],function(e,t,n,r,i){var s=n.Collection.extend({model:n.Model.extend({idAttribute:"sysname",defaults:{sysname:undefined,technology:undefined},parse:function(e){if(e&&e.sysname){var t=r.get(e.sysname);e.technology=t,t||console.log("WebsiteTechnologiesCollection technology not found: "+e.sysname)}return e}})});return n.Model.extend({idAttribute:"site",urlRoot:"/api/websites/technologies",getGroupsSorter:function(){return i.length?function(t){return e(t).chain().sortBy(function(e){return e.name}).sortBy(function(e){var t=i.length?i.getByName(e.name):null;return t&&t.attributes.orderIndex?t.attributes.orderIndex*-1:0}).value()}:(console.log("Unexpected: categoriesList is empty!"),function(t){return e.sortBy(t,function(e){return e.name})})},parse:function(t){var r=t.items=new s(t.items,{parse:!0}),i=this.getGroupsSorter(),o={},u=e.groupBy(r.sortBy(function(e){return e.attributes.technology.attributes.name}),function(e){var t=e.attributes.technology.attributes;return t.parentCategory||t.category});return e.each(u,function(t,n){var r=[],i={};e.each(t,function(e){var t=e.attributes.technology.attributes;if(t.parentCategory){var n=i[t.category]=i[t.category]||[];n.push(e)}else r.push(e)}),o[n]={technologies:r,subCategories:i}}),t.groupedTechnologies=new n.Collection(i(e.map(o,function(t,r){var s=e.map(t.subCategories,function(e,t){return{name:t,technologies:new n.Collection(e)}});return{name:r,technologies:new n.Collection(t.technologies),subCategories:new n.Collection(i(s))}}))),t},isEmpty:function(){var e=this.attributes;return!e.items||!e.items.length}})}),define("app/modules/dashboard/views/discoveryPane/panels/siteTechnologies",["underscore","jquery","backbone","marionette","radio","./base","../../collapsiblePanel","../../../models/websiteDiscovery/siteTechnologies"],function(e,t,n,r,i,s,o,u){var a=n.Marionette.ItemView.extend({className:"tech-item",template:e.template('<div class="tech-name" title="<%- technology.name %>"><a class="tech-link" href="<%- obj.technologyOverviewUrl %>" target="_blank"><img class="tech-favicon favicon" src="<%- formatters.html.favicon(technology.homepage, technology.logo) %>" /> <span class="name-text"><%- technology.name %></span></a></div><% if (obj.indicativePages) { %><button title="View pages" data-tech-id="<%- obj.techId %>" data-tech-name="<%- obj.techName %>" class="btn btn-pages <%- obj.pages ? \'actionable\' : \'empty\' %>"><i class="icon-pages"></i> <%- pages %></button><% } %><div class="tech-expense"><% if (technology.pricingScore){ %><span class="points-bar" title="<%- getPricingScoreLabel(technology.pricingScore) %>"><i class="icon-attach_money<%- technology.pricingScore < 1 ? " half-point": "" %>"></i></span><% } %></div>'),templateHelpers:function(){var e=this.model.get("technology");return{techId:e.attributes.id,techName:e.attributes.name,technology:e.toJSON(),technologyOverviewUrl:e.getOverviewUrl(),indicativePages:this.options.indicativePages,getPricingScoreLabel:function(e){return e<=0?"Free":e===1?"Paid":"Possibly paid"}}}}),f=n.Marionette.CollectionView.extend({className:"tech-list",childView:a,childViewOptions:function(e,t){return{indicativePages:this.options.indicativePages}}}),l=n.Marionette.CompositeView.extend({className:"category-item",initialize:function(){this.CategoriesCollectionView=c},template:function(e){return e.noTitle?"":'<div class="category-name">'+e.name+"</div>"},templateHelpers:function(){return{noTitle:this.noTitle}},childViewContainer:".category-sub",onRender:function(){if(this.model){var e=this.model.get("technologies"),t=this.model.get("subCategories");e&&e.length&&(this.technologiesView=new f({collection:e,indicativePages:this.options.indicativePages}),this.$el.append(this.technologiesView.render().$el)),t&&t.length&&(this.subCategoriesView=new this.CategoriesCollectionView({collection:t,indicativePages:this.options.indicativePages}),this.$el.append(this.subCategoriesView.render().$el))}}}),c=n.Marionette.CollectionView.extend({className:"categories-list",childView:l,childViewOptions:function(e,t){return{indicativePages:this.options.indicativePages}}}),h=o.extend({className:"collapsible-panel pane-sub-panel tech-category-collapsible",getLocalStorageKey:function(){return"dashboard.discoveryPane.technologies.categories."+this.model.get("name")},initialize:function(){var n=this.getLocalStorageKey();this.options.collapsed=!0;var r;try{r=t.parseJSON((window.localStorage||{})[n]||null),r&&r.collapsed===!1&&(this.options.initiallyCollapsed=!1,this.options.collapsed=!1)}catch(i){}this.trackCategory=e.bind(this.trackCategory,this),this.once("collapsible:toggle",this.trackCategory),this.on("collapsible:toggle",function(e){if(e&&e.type==="click"){var t=this.collapsibleModel.get("collapsed");t?r&&window.localStorage&&(localStorage.removeItem(n),r=null):(r={collapsed:!!t},(window.localStorage||{})[n]=JSON.stringify(r))}}),o.prototype.initialize.apply(this,arguments)},trackCategory:function(e){if(e&&e.type==="click"){var t=this.collapsibleModel.get("collapsed");t||i.channel("sidepanel").trigger("opened","technologies-category",{technologyName:this.model.get("name")})}},TitleView:o.prototype.TitleView.extend({className:"panel-title-view category-name",template:e.template('<span class="category-name-text" title="<%- obj.name %>"><%- obj.name %></span> <span class="category-items-count"><%- obj.technologiesCount %> <%- technologiesCount === 1 ? "Technology" : "Technologies" %></span>'),templateHelpers:function(){var e=this.model.attributes.subCategories.reduce(function(e,t){return e+t.attributes.technologies.length},this.model.attributes.technologies.length);return{technologiesCount:e}}}),BodyView:l.extend({className:"panel-body-view category-item sub-category-item",noTitle:!0}),bodyViewOptions:function(){return{indicativePages:this.options.indicativePages,name:this.model.get("name")}}}),p=n.Marionette.CompositeView.extend({className:"panel-body-view technologies-panel-view",initialize:function(){this.collection=this.model.get("groupedTechnologies"),this.options.parent.options.indicativePages===!1&&this.$el.addClass("no-indicative-pages"),this.once("collapsible:expand",this.tracking)},tracking:function(){i.channel("sidepanel").trigger("opened","technologies")},template:e.template('<div class="technologies-panel-wrapper"></div>'),childViewContainer:".technologies-panel-wrapper",childView:h,childViewOptions:function(e,t){return{indicativePages:this.options.parent.options.indicativePages!==!1}},events:{"click .tech-item button.btn-pages":"viewTechPages"},viewTechPages:function(e){if(this.options.parent.options.indicativePages===!1)return;var n=t(e.currentTarget),r=n.data("techId"),s=n.data("techName");this.trackViewPages(r,s),i.channel("dashboard").command("viewIndicativePages",{domain:this.model.get("site"),technologyId:r})},trackViewPages:function(e,t){i.channel("sidepanel").trigger("opened","technology-category-view-pages",{techId:e,techName:t})}});return s.extend({onBeforeRender:function(){s.prototype.onBeforeRender.apply(this,arguments),this.once("collapsible:bodyExpand",function(){var e=this.body.currentView;e.$el.children(".technologies-panel-wrapper").css("height",this._bodyMaxHeight-40),e.children.each(function(e){var t=e.body.currentView.$el.innerHeight();e.options.initiallyCollapsed!==!1?e.collapse():e.toggle(),e.setMaxBodyHeight(t)})}),this.initInternalBadge()},initInternalBadge:function(){var e=this.options.dataType;s.prototype.initBadge.apply(this,[e,this.model.get("items").length])},BodyView:p,Model:u})}),define("app/modules/dashboard/models/websiteDiscovery/emails",["underscore","jquery","backbone","subscription"],function(e,t,n,r){return n.Model.extend({idAttribute:"site",urlRoot:"/api/websites/emails",parse:function(e){var t=r.isPermitted(r.PERMISSIONS.technologyReport_includeContactDetails);return e.roleBasedEmails=e.roleBasedEmails||[],e.personalEmails=e.personalEmails||[],e.allEmails=(e.roleBasedEmails||[]).concat(e.personalEmails||[]),t&&e.allEmails.sort(),e},isEmpty:function(){var e=this.attributes;return(!e.roleBasedEmails||!e.roleBasedEmails.length)&&(!e.personalEmails||!e.personalEmails.length)}})}),define("app/modules/dashboard/views/discoveryPane/panels/siteEmails",["underscore","jquery","backbone","marionette","radio","subscription","./base","../../../models/websiteDiscovery/emails"],function(e,t,n,r,i,s,o,u){var a=s.isPermitted(s.PERMISSIONS.technologyReport_includeContactDetails);return o.extend({BodyView:o.prototype.BodyView.extend({initialize:function(){this.on("tabview:expand:before",this.adjustListHeight),this.once("tabview:expand",this.tracking)},className:"panel-body-view emails-panel-view",template:e.template('<textarea class="form-control emails-list" wrap="off" readonly="readonly"></textarea>'),ui:{emailsList:".emails-list"},events:{},activeListName:"allEmails",tracking:function(){i.channel("sidepanel").trigger("opened","company-emails")},templateHelpers:function(){return{cid:this.cid}},onRender:function(){this.renderEmails(this.activeListName),a||this.$el.addClass("upgrade-required").prepend(t("<a />",{"class":"upgrade-overlay upgrade-block",href:s.getPlanChooserUrl({ref:"report-discover-emails"})}).html('<span class="upgrade-btn"><i class="icon-lock_outline upgrade-icon"></i> Upgrade to unlock email addresses</span>'))},renderEmails:function(e){var t=this.model.get(e);t&&(this.activeListName=e,this.activeList=t,this.ui.emailsList.val(t.join("\n")),this.ui.emailsList.text(t.join("\n")),this.adjustListHeight(),this.initInternalBadge())},initInternalBadge:function(){var e=this._parent._parent._parent.options.dataType;o.prototype.initBadge.apply(this,[e,this.activeList.length])},adjustListHeight:function(){if(this.ui.emailsList instanceof t){var e=this.ui.emailsList[0];e.style.height="1px",e.style.height=6+e.scrollHeight+"px";if(this.activeList.length>0)var n=setInterval(function(){e.scrollHeight>0&&clearInterval(n),e.style.height="1px",e.style.height=6+e.scrollHeight+"px"})}}}),Model:u})}),define("app/plugins/jquery.loadSvg",["jquery","underscore"],function(e,t){var n={},r=function(t,r){var i=n.hasOwnProperty(t);(n[t]=n[t]||[]).push(r),i||e.get(t).then(function(e,r,i){var s=r==="success"?i.responseText:null,o=n[t],u;while(u=o.shift())u(s);try{delete n[t]}catch(a){n[t]=null}})},i=!!window.localStorage;e.fn.loadSvg=function(t){var n=e.extend({},e.fn.loadSvg.defaults,t);return this.each(function(){var t=e(this),s=n.src||t.data("src"),o=function(e,t){var n=this;n.append(t),n.addClass(e.loadedCls||n.data("loadedCls")),e.setSize&&n.children("svg").css({width:n.width(),height:n.height()}),t?e.success&&e.success.call(n,t):e.error&&e.success.call(n,t)},u="svg:\\"+s,a=!1;if(n.storageCache&&i){var f=localStorage[u];f&&(a=!0,setTimeout(function(){o.call(t,n,f,!0)},0))}a||r(s,function(e){o.call(t,n,e,!1),e&&n.storageCache&&i&&(localStorage[u]=e)})})},e.fn.loadSvg.defaults={loadedCls:"svg-loaded",setSize:!0,success:null,error:null,storageCache:!0}}),function(e){define("libs/plugins/jquery.lazyload",["jquery"],function(){return function(){(function(e,t,n,r){var i=e(t);e.fn.lazyload=function(s){function f(){var t=0;o.each(function(){var n=e(this);if(a.skip_invisible&&!n.is(":visible"))return;if(!e.abovethetop(this,a)&&!e.leftofbegin(this,a))if(!e.belowthefold(this,a)&&!e.rightoffold(this,a))n.trigger("appear"),t=0;else if(++t>a.failure_limit)return!1})}var o=this,u,a={threshold:150,failure_limit:0,event:"scroll",effect:"fadeIn",container:t,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return s&&(r!==s.failurelimit&&(s.failure_limit=s.failurelimit,delete s.failurelimit),r!==s.effectspeed&&(s.effect_speed=s.effectspeed,delete s.effectspeed),e.extend(a,s)),u=a.container===r||a.container===t?i:e(a.container),0===a.event.indexOf("scroll")&&u.bind(a.event,function(){return f()}),this.each(function(){var t=this,n=e(t);t.loaded=!1,(n.attr("src")===r||n.attr("src")===!1)&&n.is("img")&&n.attr("src",a.placeholder),n.one("appear",function(){if(!this.loaded){if(a.appear){var r=o.length;a.appear.call(t,r,a)}e("<img />").bind("load",function(){var r=n.attr("data-"+a.data_attribute);n.hide(),n.is("img")?n.attr("src",r):n.css("background-image","url('"+r+"')"),n[a.effect](a.effect_speed),t.loaded=!0;var i=e.grep(o,function(e){return!e.loaded});o=e(i);if(a.load){var s=o.length;a.load.call(t,s,a)}}).attr("src",n.attr("data-"+a.data_attribute))}}),0!==a.event.indexOf("scroll")&&n.bind(a.event,function(){t.loaded||n.trigger("appear")})}),i.bind("resize",function(){f()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&i.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&o.each(function(){e(this).trigger("appear")})}),e(n).ready(function(){f()}),this},e.belowthefold=function(n,s){var o;return s.container===r||s.container===t?o=(t.innerHeight?t.innerHeight:i.height())+i.scrollTop():o=e(s.container).offset().top+e(s.container).height(),o<=e(n).offset().top-s.threshold},e.rightoffold=function(n,s){var o;return s.container===r||s.container===t?o=i.width()+i.scrollLeft():o=e(s.container).offset().left+e(s.container).width(),o<=e(n).offset().left-s.threshold},e.abovethetop=function(n,s){var o;return s.container===r||s.container===t?o=i.scrollTop():o=e(s.container).offset().top,o>=e(n).offset().top+s.threshold+e(n).height()},e.leftofbegin=function(n,s){var o;return s.container===r||s.container===t?o=i.scrollLeft():o=e(s.container).offset().left,o>=e(n).offset().left+s.threshold+e(n).width()},e.inviewport=function(t,n){return!e.rightoffold(t,n)&&!e.leftofbegin(t,n)&&!e.belowthefold(t,n)&&!e.abovethetop(t,n)},e.extend(e.expr[":"],{"below-the-fold":function(t){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return e.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!e.rightoffold(t,{threshold:0})},"in-viewport":function(t){return e.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return e.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!e.rightoffold(t,{threshold:0})}})})(jQuery,window,document)}.apply(e,arguments)})}(this),define("app/helpers/transitionEnd",["jquery","modernizr"],function(e,t){var n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};t.transitionEnd=n[t.prefixed("transition")],e.fn.onTransitionEnd=function(n,r,i,s){return this.each(function(){var o=!1,u,a,f,l=e(this),c=(l.data("__trId")||0)+1;l.data("__trId",c);var h=function(e,i){if(o)return;o=!0,a&&(clearTimeout(a),a=null),f&&(l.off(t.transitionEnd,f),f=null);if(!s&&c<l.data("__trId"))return;n.call(r||l[0],l,{trigger:i,transitionSupported:e})};t.csstransitions?(f=function(){u||h(!0,"transitionEnd")},l.one(t.transitionEnd,f),i!==undefined&&(u=setTimeout(function(){clearTimeout(u),u=null,a=setTimeout(function(){h(!0,"timeout")},100)},i-50))):h(!1,"transitionsUnsupported")})};var r=function(e){return parseFloat(e)*(e.indexOf("ms")>-1?1:1e3)};e.fn.transitionDuration=function(){var t=this[0],n=r(e(t).css("transition-duration")||0);return isNaN(n)?0:n},e.fn.trs=function(t,n,r,i){var s,o,u;return e.isFunction(r)?s=r:r&&(u=r,s=u.callback,i=i||u.scope),u=u||{},o=u.defer===undefined?0:u.defer,this.each(function(){var r=this,u=e(r),a=(r.className||"")+t;if(!n){var f=/takes-([0-9]*)-ms/g.exec(a);n=f&&f[1]}u.addClass("animated "+t).onTransitionEnd(function(){u.removeClass("animated "+t),s&&(e.isNumeric(o)?setTimeout(function(){s.call(i||r,u)},o):s.call(i||r,u))},r,n||400)})}}),define("app/addonWebsiteDiscovery",["initialData","accountInfo","subscription","modernizr","underscore","jquery","backbone","marionette","radio","formatters","app/helpers/tracking","app/helpers/trace","app/helpers/extensionIntegration","app/instances/collections/technologyCategoriesList","app/instances/collections/technologiesList","app/modules/dashboard/views/discoveryPane/websiteDiscoveryPane","app/modules/dashboard/models/websiteDiscovery/index","app/modules/dashboard/views/discoveryPane/panels/siteInfo","app/modules/dashboard/views/discoveryPane/panels/siteCompany","app/modules/dashboard/views/discoveryPane/panels/siteTechnologies","app/modules/dashboard/views/discoveryPane/panels/siteEmails","app/plugins/jquery.loadSvg","libs/plugins/jquery.lazyload","app/helpers/transitionEnd"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){var E=new u.Application;return window.App=E,E.helpers={Formatters:f},E.start=function(t){E.on("before:start",function(){s.ajaxPrefilter(function(e,t,n){if(!n.crossDomain){var r=window.__RequestVerificationToken=window.__RequestVerificationToken||s("body>input[name=__RequestVerificationToken]").val();r&&n.setRequestHeader("X-Request-Verification-Token",r)}})}),E.on("start",function(){var t=e.discover;l.init(),h.init();var r=s("#root");s(document).on("click","a[href]:not([data-bypass])",function(e){var n=s(this),r=n.prop("href");if(e&&!e.isDefaultPrevented()&&!formatters.string.startsWith(r,"#")){e.preventDefault();if(r!==location.href){if(r.startsWith(location.origin)){var i="utm_term="+encodeURIComponent(t.website);r=~r.indexOf("?")?r.replace("?","?"+i+"&"):~r.indexOf("#")?r.replace("#","?"+i+"#"):r+"?"+i}h.sendMessage("openTab",{url:r})}}});var o=u.ItemView.extend({className:"empty-state dark text-center",template:i.template('<div class="no-data-available">No data available for this website</div>')});s.when(d.initialLoad(),p.initialLoad()).then(function(){var e=n.isPermitted(n.PERMISSIONS.technologyReport_includeContactDetails),i=new v({toggleHandle:!1,emptyView:o,subjectModel:t.website,model:new m(t.discoverData,{parse:!0}),panels:{siteInfo:{view:g,modelRoot:"info",title:"Website Information",shortTitle:"Website"},companyInfo:{view:y,modelRoot:"company",title:"Company Information",shortTitle:"Company"},siteTechnologies:{view:b,modelRoot:"technologies",viewOptions:{indicativePages:!1},title:"Technologies"},emailsInfo:e?{view:w,modelRoot:"emails",title:"Company Emails",shortTitle:"Emails"}:undefined}});r.html(i.$el),i.render(),s("body").removeClass("pre-init"),h.sendMessage("sidebarReady",{website:t.website,blocked:t.blocked,invalid:t.invalid,empty:t.empty,success:!t.invalid&&!t.blocked&&!t.empty})},function(){h.sendMessage("sidebarReady",{website:t.website,blocked:t.blocked,invalid:t.invalid,empty:t.empty,error:"Resources failed to load",success:!1})}),l.trackEvent("addon_page discover",{website:t.website,page:window.location.pathname+window.location.hash})}),u.Application.prototype.start.call(E)},E}),require(["app/addonWebsiteDiscovery"]);;
